/*!
 * adaptivecards.webchat-plugin.legacy.js v2.60.0
 * https://github.com/Cognigy/WebchatWidget/tree/v2.60.0
 * https://github.com/Cognigy/WebchatWidget/tree/v2.60.0/OSS_LICENSES.txt
 */!function(){var e={780:function(e){if(!window.__COGNIGY_WEBCHAT)throw new Error("Cognigy Webchat v2.7 or higher has to be loaded before this plugin");e.exports=window.__COGNIGY_WEBCHAT.React},635:function(e,t){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.LoginRequestResponse=t.ErrorResponse=t.SuccessResponse=t.ActivityResponse=t.ActivityRequestError=t.ActivityRequestTrigger=void 0,function(e){e.Automatic="automatic",e.Manual="manual"}(t.ActivityRequestTrigger||(t.ActivityRequestTrigger={}));var i=function(e,t){this.code=e,this.message=t};t.ActivityRequestError=i;var o=function(e){this.request=e};t.ActivityResponse=o;var s=function(e){function t(t,n){var r=e.call(this,t)||this;return r.request=t,r.rawContent=n,r}return r(t,e),t}(o);t.SuccessResponse=s;var a=function(e){function t(t,n){var r=e.call(this,t)||this;return r.request=t,r.error=n,r}return r(t,e),t}(o);t.ErrorResponse=a;var l=function(e){function t(t,n){var r=e.call(this,t)||this;r.request=t,r._auth=n;for(var i=0,o=r._auth.buttons;i<o.length;i++){var s=o[i];if("signin"===s.type&&void 0!==s.value)try{new URL(s.value),r.signinButton=s;break}catch(e){}}return r}return r(t,e),Object.defineProperty(t.prototype,"tokenExchangeResource",{get:function(){return this._auth.tokenExchangeResource},enumerable:!1,configurable:!0}),t}(o);t.LoginRequestResponse=l},40:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.AdaptiveApplet=void 0;var s=n(489),a=n(527),l=n(14),p=n(635),u=n(558),c=n(155),h=n(246);function d(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(l.GlobalSettings.applets.logEnabled)if(l.GlobalSettings.applets.onLogEvent)l.GlobalSettings.applets.onLogEvent(e,t,n);else switch(e){case s.LogLevel.Warning:console.warn(t,n);break;case s.LogLevel.Error:console.error(t,n);break;default:console.log(t,n)}}var f=function(){function e(e,t,n){this.action=e,this.trigger=t,this.consecutiveRefreshes=n,this.attemptNumber=0}return e.prototype.retryAsync=function(){return i(this,void 0,void 0,(function(){return o(this,(function(e){return this.onSend&&this.onSend(this),[2]}))}))},e}(),y=function(){function e(){this._allowAutomaticCardUpdate=!1,this.renderedElement=document.createElement("div"),this.renderedElement.className="aaf-cardHost",this.renderedElement.style.position="relative",this.renderedElement.style.display="flex",this.renderedElement.style.flexDirection="column",this._cardHostElement=document.createElement("div"),this._refreshButtonHostElement=document.createElement("div"),this._refreshButtonHostElement.className="aaf-refreshButtonHost",this._refreshButtonHostElement.style.display="none",this.renderedElement.appendChild(this._cardHostElement),this.renderedElement.appendChild(this._refreshButtonHostElement)}return e.prototype.displayCard=function(e){if(!e.renderedElement)throw new Error("displayCard: undefined card.");a.clearElementChildren(this._cardHostElement),this._refreshButtonHostElement.style.display="none",this._cardHostElement.appendChild(e.renderedElement)},e.prototype.showManualRefreshButton=function(e){var t=this;if(!this.onShowManualRefreshButton||this.onShowManualRefreshButton(this)){this._refreshButtonHostElement.style.display="none";var n=void 0;if(this.onRenderManualRefreshButton)n=this.onRenderManualRefreshButton(this);else{var r=u.Strings.runtime.refreshThisCard();if(l.GlobalSettings.applets.refresh.mode===s.RefreshMode.Automatic){var i=u.Strings.runtime.automaticRefreshPaused();" "!==i[i.length-1]&&(i+=" "),r=u.Strings.runtime.clckToRestartAutomaticRefresh()}var o={type:"AdaptiveCard",version:"1.2",body:[{type:"RichTextBlock",horizontalAlignment:"right",inlines:[{type:"TextRun",text:r,selectAction:{type:"Action.Submit",id:"refreshCard"}}]}]},d=new c.AdaptiveCard;d.parse(o,new c.SerializationContext(h.Versions.v1_2)),d.onExecuteAction=function(n){"refreshCard"===n.id&&(a.clearElementChildren(t._refreshButtonHostElement),t.internalExecuteAction(e,p.ActivityRequestTrigger.Automatic,0))},n=d.render()}n&&(a.clearElementChildren(this._refreshButtonHostElement),this._refreshButtonHostElement.appendChild(n),this._refreshButtonHostElement.style.removeProperty("display"))}},e.prototype.createActivityRequest=function(e,t,n){var r=this;if(this.card){var i=new f(e,t,n);return i.onSend=function(e){e.attemptNumber++,r.internalSendActivityRequestAsync(i)},!!this.onPrepareActivityRequest&&!this.onPrepareActivityRequest(this,i,e)?void 0:i}throw new Error("createActivityRequest: no card has been set.")},e.prototype.createMagicCodeInputCard=function(t){var n={type:"AdaptiveCard",version:"1.0",body:[{type:"TextBlock",color:"attention",text:1===t?void 0:"That didn't work... let's try again.",wrap:!0,horizontalAlignment:"center"},{type:"TextBlock",text:'Please login in the popup. You will obtain a magic code. Paste that code below and select "Submit"',wrap:!0,horizontalAlignment:"center"},{type:"Input.Text",id:"magicCode",placeholder:"Enter magic code"},{type:"ActionSet",horizontalAlignment:"center",actions:[{type:"Action.Submit",id:e._submitMagicCodeActionId,title:"Submit"},{type:"Action.Submit",id:e._cancelMagicCodeAuthActionId,title:"Cancel"}]}]},r=new c.AdaptiveCard;return r.parse(n),r},e.prototype.cancelAutomaticRefresh=function(){this._allowAutomaticCardUpdate&&d(s.LogLevel.Warning,"Automatic card refresh has been cancelled as a result of the user interacting with the card."),this._allowAutomaticCardUpdate=!1},e.prototype.createSerializationContext=function(){return this.onCreateSerializationContext?this.onCreateSerializationContext(this):new c.SerializationContext},e.prototype.internalSetCard=function(e,t){var n=this;if("object"===r(e)&&"AdaptiveCard"===e.type&&(this._cardPayload=e),this._cardPayload)try{var i=new c.AdaptiveCard;this.hostConfig&&(i.hostConfig=this.hostConfig);var o=this.createSerializationContext();if(i.parse(this._cardPayload,o),(!this.onCardChanging||this.onCardChanging(this,this._cardPayload))&&(this._card=i,this._card.authentication&&this._card.authentication.tokenExchangeResource&&this.onPrefetchSSOToken&&this.onPrefetchSSOToken(this,this._card.authentication.tokenExchangeResource),this._card.onExecuteAction=function(e){n.cancelAutomaticRefresh(),n.internalExecuteAction(e,p.ActivityRequestTrigger.Manual,0)},this._card.onInputValueChanged=function(e){n.cancelAutomaticRefresh()},this._card.render(),this._card.renderedElement&&(this.displayCard(this._card),this.onCardChanged&&this.onCardChanged(this),this._card.refresh)))if(l.GlobalSettings.applets.refresh.mode===s.RefreshMode.Automatic&&t<l.GlobalSettings.applets.refresh.maximumConsecutiveAutomaticRefreshes)if(l.GlobalSettings.applets.refresh.timeBetweenAutomaticRefreshes<=0)d(s.LogLevel.Info,"Triggering automatic card refresh number "+(t+1)),this.internalExecuteAction(this._card.refresh.action,p.ActivityRequestTrigger.Automatic,t+1);else{d(s.LogLevel.Info,"Scheduling automatic card refresh number "+(t+1)+" in "+l.GlobalSettings.applets.refresh.timeBetweenAutomaticRefreshes+"ms");var a=this._card.refresh.action;this._allowAutomaticCardUpdate=!0,window.setTimeout((function(){n._allowAutomaticCardUpdate&&n.internalExecuteAction(a,p.ActivityRequestTrigger.Automatic,t+1)}),l.GlobalSettings.applets.refresh.timeBetweenAutomaticRefreshes)}else l.GlobalSettings.applets.refresh.mode!==s.RefreshMode.Disabled&&(d(s.LogLevel.Warning,t>0?"Stopping automatic refreshes after "+t+" consecutive refreshes.":"The card has a refresh section, but automatic refreshes are disabled."),(l.GlobalSettings.applets.refresh.allowManualRefreshesAfterAutomaticRefreshes||l.GlobalSettings.applets.refresh.mode===s.RefreshMode.Manual)&&(d(s.LogLevel.Info,"Showing manual refresh button."),this.showManualRefreshButton(this._card.refresh.action)))}catch(e){d(s.LogLevel.Error,"setCard: "+e)}},e.prototype.internalExecuteAction=function(e,t,n){if(e instanceof c.ExecuteAction){if(!this.channelAdapter)throw new Error("internalExecuteAction: No channel adapter set.");var r=this.createActivityRequest(e,t,n);r&&r.retryAsync()}this.onAction&&this.onAction(this,e)},e.prototype.createProgressOverlay=function(e){if(!this._progressOverlay)if(this.onCreateProgressOverlay)this._progressOverlay=this.onCreateProgressOverlay(this,e);else{this._progressOverlay=document.createElement("div"),this._progressOverlay.className="aaf-progress-overlay";var t=document.createElement("div");t.className="aaf-spinner",t.style.width="28px",t.style.height="28px",this._progressOverlay.appendChild(t)}return this._progressOverlay},e.prototype.removeProgressOverlay=function(e){this.onRemoveProgressOverlay&&this.onRemoveProgressOverlay(this,e),void 0!==this._progressOverlay&&(this.renderedElement.removeChild(this._progressOverlay),this._progressOverlay=void 0)},e.prototype.activityRequestSucceeded=function(e,t){this.onActivityRequestSucceeded&&this.onActivityRequestSucceeded(this,e,t)},e.prototype.activityRequestFailed=function(e){return this.onActivityRequestFailed?this.onActivityRequestFailed(this,e):l.GlobalSettings.applets.defaultTimeBetweenRetryAttempts},e.prototype.showAuthCodeInputDialog=function(t){var n=this;if(!this.onShowAuthCodeInputDialog||this.onShowAuthCodeInputDialog(this,t)){var r=this.createMagicCodeInputCard(t.attemptNumber);r.render(),r.onExecuteAction=function(r){if(n.card&&r instanceof c.SubmitAction)switch(r.id){case e._submitMagicCodeActionId:var i=void 0;r.data&&"string"==typeof r.data.magicCode&&(i=r.data.magicCode),i?(n.displayCard(n.card),t.authCode=i,t.retryAsync()):alert("Please enter the magic code you received.");break;case e._cancelMagicCodeAuthActionId:d(s.LogLevel.Warning,"Authentication cancelled by user."),n.displayCard(n.card);break;default:d(s.LogLevel.Error,"Unexpected action taken from magic code input card (id = "+r.id+")"),alert(u.Strings.magicCodeInputCard.somethingWentWrong())}},this.displayCard(r)}},e.prototype.internalSendActivityRequestAsync=function(e){return i(this,void 0,void 0,(function(){var t,n,i,a;return o(this,(function(c){switch(c.label){case 0:if(!this.channelAdapter)throw new Error("internalSendActivityRequestAsync: channelAdapter is not set.");void 0!==(t=this.createProgressOverlay(e))&&this.renderedElement.appendChild(t),n=!1,i=function(){var t,i,c,h,f,y,g;return o(this,(function(o){switch(o.label){case 0:t=void 0,1===e.attemptNumber?d(s.LogLevel.Info,"Sending activity request to channel (attempt "+e.attemptNumber+")"):d(s.LogLevel.Info,"Re-sending activity request to channel (attempt "+e.attemptNumber+")"),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,a.channelAdapter.sendRequestAsync(e)];case 2:return t=o.sent(),[3,4];case 3:return i=o.sent(),d(s.LogLevel.Error,"Activity request failed: "+i),a.removeProgressOverlay(e),n=!0,[3,4];case 4:if(!t)return[3,10];if(!(t instanceof p.SuccessResponse))return[3,5];if(a.removeProgressOverlay(e),void 0===t.rawContent)throw new Error("internalSendActivityRequestAsync: Action.Execute result is undefined");c=t.rawContent;try{c=JSON.parse(t.rawContent)}catch(e){}if("string"==typeof c)d(s.LogLevel.Info,"The activity request returned a string after "+e.attemptNumber+" attempt(s)."),a.activityRequestSucceeded(t,c);else{if("object"!==r(c)||"AdaptiveCard"!==c.type)throw new Error("internalSendActivityRequestAsync: Action.Execute result is of unsupported type ("+r(t.rawContent)+")");d(s.LogLevel.Info,"The activity request returned an Adaptive Card after "+e.attemptNumber+" attempt(s)."),a.internalSetCard(c,e.consecutiveRefreshes),a.activityRequestSucceeded(t,a.card)}return n=!0,[3,10];case 5:return t instanceof p.ErrorResponse?(h=a.activityRequestFailed(t))>=0&&e.attemptNumber<l.GlobalSettings.applets.maximumRetryAttempts?(d(s.LogLevel.Warning,"Activity request failed: ".concat(t.error.message,". Retrying in ").concat(h,"ms")),e.attemptNumber++,[4,new Promise((function(e,t){window.setTimeout((function(){e()}),h)}))]):[3,7]:[3,9];case 6:return o.sent(),[3,8];case 7:d(s.LogLevel.Error,"Activity request failed: ".concat(t.error.message,". Giving up after ").concat(e.attemptNumber," attempt(s)")),a.removeProgressOverlay(e),n=!0,o.label=8;case 8:return[3,10];case 9:if(t instanceof p.LoginRequestResponse){if(d(s.LogLevel.Info,"The activity request returned a LoginRequestResponse after "+e.attemptNumber+" attempt(s)."),e.attemptNumber<=l.GlobalSettings.applets.maximumRetryAttempts){if(f=!0,t.tokenExchangeResource&&a.onSSOTokenNeeded&&(f=!a.onSSOTokenNeeded(a,e,t.tokenExchangeResource)),f){if(a.removeProgressOverlay(e),void 0===t.signinButton)throw new Error("internalSendActivityRequestAsync: the login request doesn't contain a valid signin URL.");d(s.LogLevel.Info,"Login required at "+t.signinButton.value),a.onShowSigninPrompt?a.onShowSigninPrompt(a,e,t.signinButton):(a.showAuthCodeInputDialog(e),y=window.screenX+(window.outerWidth-l.GlobalSettings.applets.authPromptWidth)/2,g=window.screenY+(window.outerHeight-l.GlobalSettings.applets.authPromptHeight)/2,window.open(t.signinButton.value,t.signinButton.title?t.signinButton.title:"Sign in","width=".concat(l.GlobalSettings.applets.authPromptWidth,",height=").concat(l.GlobalSettings.applets.authPromptHeight,",left=").concat(y,",top=").concat(g)))}}else d(s.LogLevel.Error,"Authentication failed. Giving up after "+e.attemptNumber+" attempt(s)"),alert(u.Strings.magicCodeInputCard.authenticationFailed());return[2,"break"]}throw new Error("Unhandled response type: "+JSON.stringify(t));case 10:return[2]}}))},a=this,c.label=1;case 1:return n?[3,3]:[5,i()];case 2:return"break"===c.sent()?[3,3]:[3,1];case 3:return[2]}}))}))},e.prototype.refreshCard=function(){this._card&&this._card.refresh&&this.internalExecuteAction(this._card.refresh.action,p.ActivityRequestTrigger.Manual,0)},e.prototype.setCard=function(e){this.internalSetCard(e,0)},Object.defineProperty(e.prototype,"card",{get:function(){return this._card},enumerable:!1,configurable:!0}),e._submitMagicCodeActionId="submitMagicCode",e._cancelMagicCodeAuthActionId="cancelMagicCodeAuth",e}();t.AdaptiveApplet=y},254:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(558),t),i(n(489),t),i(n(14),t),i(n(527),t),i(n(246),t),i(n(7),t),i(n(611),t),i(n(885),t),i(n(715),t),i(n(155),t),i(n(597),t),i(n(792),t),i(n(635),t),i(n(40),t)},155:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var i,o=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__decorate||function(e,t,n,i){var o,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))},l=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ContainerWithActions=t.ColumnSet=t.Column=t.Container=t.BackgroundImage=t.ContainerBase=t.StylableCardElementContainer=t.ContainerStyleProperty=t.ActionSet=t.ShowCardAction=t.HttpAction=t.HttpHeader=t.ToggleVisibilityAction=t.OpenUrlAction=t.ExecuteAction=t.SubmitAction=t.SubmitActionBase=t.Action=t.TimeInput=t.TimeProperty=t.DateInput=t.NumberInput=t.ChoiceSetInput=t.Choice=t.ToggleInput=t.TextInput=t.Input=t.Media=t.YouTubePlayer=t.DailymotionPlayer=t.VimeoPlayer=t.IFrameMediaMediaPlayer=t.CustomMediaPlayer=t.HTML5MediaPlayer=t.MediaPlayer=t.MediaSource=t.CaptionSource=t.ContentSource=t.ImageSet=t.CardElementContainer=t.Image=t.FactSet=t.Fact=t.RichTextBlock=t.TextRun=t.TextBlock=t.BaseTextBlock=t.ActionProperty=t.CardElement=t.renderSeparation=void 0,t.SerializationContext=t.AdaptiveCard=t.Authentication=t.TokenExchangeResource=t.AuthCardButton=t.RefreshDefinition=t.RefreshActionProperty=void 0;var p=n(489),u=n(14),c=n(527),h=n(611),d=n(816),f=n(715),y=n(246),g=n(885),m=n(558),v=n(512);function b(e){var t,n,r="undefined"==typeof window?"":null!==(n=null===(t=window.trustedTypes)||void 0===t?void 0:t.emptyHTML)&&void 0!==n?n:"";e.innerHTML=r}function _(e,t,n){if(t.spacing>0||t.lineThickness&&t.lineThickness>0){var r=document.createElement("div");r.className=e.makeCssClassName("ac-"+(n===p.Orientation.Horizontal?"horizontal":"vertical")+"-separator"),r.setAttribute("aria-hidden","true");var i=t.lineColor?c.stringToCssColor(t.lineColor):"";return n===p.Orientation.Horizontal?t.lineThickness?(r.style.paddingTop=t.spacing/2+"px",r.style.marginBottom=t.spacing/2+"px",r.style.borderBottom=t.lineThickness+"px solid "+i):r.style.height=t.spacing+"px":t.lineThickness?(r.style.paddingLeft=t.spacing/2+"px",r.style.marginRight=t.spacing/2+"px",r.style.borderRight=t.lineThickness+"px solid "+i):r.style.width=t.spacing+"px",r.style.overflow="hidden",r.style.flex="0 0 auto",r}}t.renderSeparation=_;var C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._truncatedDueToOverflow=!1,t}return o(t,e),Object.defineProperty(t.prototype,"lang",{get:function(){var e=this.getValue(t.langProperty);return e||(this.parent?this.parent.lang:void 0)},set:function(e){this.setValue(t.langProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isVisible",{get:function(){return this.getValue(t.isVisibleProperty)},set:function(e){u.GlobalSettings.useAdvancedCardBottomTruncation&&!e&&this.undoOverflowTruncation(),this.isVisible!==e&&(this.setValue(t.isVisibleProperty,e),this.updateRenderedElementVisibility(),this._renderedElement&&Se(this)),this._renderedElement&&this._renderedElement.setAttribute("aria-expanded",e.toString())},enumerable:!1,configurable:!0}),t.prototype.internalRenderSeparator=function(){var e=_(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.spacing),lineThickness:this.separator?this.hostConfig.separator.lineThickness:void 0,lineColor:this.separator?this.hostConfig.separator.lineColor:void 0},this.separatorOrientation);if(u.GlobalSettings.alwaysBleedSeparators&&e&&this.separatorOrientation===p.Orientation.Horizontal){var t=this.getParentContainer();if(t&&t.getEffectivePadding()){var n=this.hostConfig.paddingDefinitionToSpacingDefinition(t.getEffectivePadding());e.style.marginLeft="-"+n.left+"px",e.style.marginRight="-"+n.right+"px"}}return e},t.prototype.updateRenderedElementVisibility=function(){var e=this.isDesignMode()||this.isVisible?this._defaultRenderedElementDisplayMode:"none";this._renderedElement&&(e?this._renderedElement.style.display=e:this._renderedElement.style.removeProperty("display")),this._separatorElement&&(this.parent&&this.parent.isFirstElement(this)?this._separatorElement.style.display="none":e?this._separatorElement.style.display=e:this._separatorElement.style.removeProperty("display"))},t.prototype.hideElementDueToOverflow=function(){this._renderedElement&&this.isVisible&&(this._renderedElement.style.visibility="hidden",this.isVisible=!1,Se(this,!1))},t.prototype.showElementHiddenDueToOverflow=function(){this._renderedElement&&!this.isVisible&&(this._renderedElement.style.removeProperty("visibility"),this.isVisible=!0,Se(this,!1))},t.prototype.handleOverflow=function(e){if(this.isVisible||this.isHiddenDueToOverflow()){var t=this.truncateOverflow(e);this._truncatedDueToOverflow=t||this._truncatedDueToOverflow,t?t&&!this.isVisible&&this.showElementHiddenDueToOverflow():this.hideElementDueToOverflow()}},t.prototype.resetOverflow=function(){var e=!1;return this._truncatedDueToOverflow&&(this.undoOverflowTruncation(),this._truncatedDueToOverflow=!1,e=!0),this.isHiddenDueToOverflow()&&this.showElementHiddenDueToOverflow(),e},t.prototype.getDefaultSerializationContext=function(){return new Oe},t.prototype.createPlaceholderElement=function(){var e=this.getEffectiveStyleDefinition(),t=c.stringToCssColor(e.foregroundColors.default.subtle),n=document.createElement("div");return n.style.border="1px dashed "+t,n.style.padding="4px",n.style.minHeight="32px",n.style.fontSize="10px",t&&(n.style.color=t),n.innerText="Empty "+this.getJsonTypeName(),n},t.prototype.adjustRenderedElementSize=function(e){"auto"===this.height?e.style.flex="0 0 auto":e.style.flex="1 1 auto"},t.prototype.isDisplayed=function(){return void 0!==this._renderedElement&&this.isVisible&&this._renderedElement.offsetHeight>0},t.prototype.overrideInternalRender=function(){return this.internalRender()},t.prototype.applyPadding=function(){if(this.separatorElement&&this.separatorOrientation===p.Orientation.Horizontal)if(u.GlobalSettings.alwaysBleedSeparators&&!this.isBleeding()){var e=new u.PaddingDefinition;this.getImmediateSurroundingPadding(e);var t=this.hostConfig.paddingDefinitionToSpacingDefinition(e);this.separatorElement.style.marginLeft="-"+t.left+"px",this.separatorElement.style.marginRight="-"+t.right+"px"}else this.separatorElement.style.marginRight="0",this.separatorElement.style.marginLeft="0"},t.prototype.truncateOverflow=function(e){return!1},t.prototype.undoOverflowTruncation=function(){},t.prototype.getDefaultPadding=function(){return new u.PaddingDefinition},t.prototype.getHasBackground=function(e){return void 0===e&&(e=!1),!1},t.prototype.getHasBorder=function(){return!1},t.prototype.getPadding=function(){return this._padding},t.prototype.setPadding=function(e){this._padding=e},t.prototype.shouldSerialize=function(e){return void 0!==e.elementRegistry.findByName(this.getJsonTypeName())},Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"separatorOrientation",{get:function(){return p.Orientation.Horizontal},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultStyle",{get:function(){return p.ContainerStyle.Default},enumerable:!1,configurable:!0}),t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n||new Oe)},t.prototype.asString=function(){return""},t.prototype.isBleeding=function(){return!1},t.prototype.getEffectiveStyle=function(){return this.parent?this.parent.getEffectiveStyle():this.defaultStyle},t.prototype.getEffectiveStyleDefinition=function(){return this.hostConfig.containerStyles.getStyleByName(this.getEffectiveStyle())},t.prototype.getEffectiveTextStyleDefinition=function(){return this.parent?this.parent.getEffectiveTextStyleDefinition():this.hostConfig.textStyles.default},t.prototype.getForbiddenActionTypes=function(){return[]},t.prototype.getImmediateSurroundingPadding=function(e,t,n,r,i){if(void 0===t&&(t=!0),void 0===n&&(n=!0),void 0===r&&(r=!0),void 0===i&&(i=!0),this.parent){var o=t&&this.parent.isTopElement(this),s=n&&this.parent.isRightMostElement(this),a=r&&this.parent.isBottomElement(this),l=i&&this.parent.isLeftMostElement(this),u=this.parent.getEffectivePadding();u&&(o&&u.top!==p.Spacing.None&&(e.top=u.top,o=!1),s&&u.right!==p.Spacing.None&&(e.right=u.right,s=!1),a&&u.bottom!==p.Spacing.None&&(e.bottom=u.bottom,a=!1),l&&u.left!==p.Spacing.None&&(e.left=u.left,l=!1)),(o||s||a||l)&&this.parent.getImmediateSurroundingPadding(e,o,s,a,l)}},t.prototype.getActionCount=function(){return 0},t.prototype.getActionAt=function(e){throw new Error(m.Strings.errors.indexOutOfRange(e))},t.prototype.indexOfAction=function(e){for(var t=0;t<this.getActionCount();t++)if(this.getActionAt(t)===e)return t;return-1},t.prototype.remove=function(){return!!(this.parent&&this.parent instanceof O)&&this.parent.removeItem(this)},t.prototype.render=function(){return this._renderedElement=this.overrideInternalRender(),this._separatorElement=this.internalRenderSeparator(),this._renderedElement?(this.id&&(this._renderedElement.id=this.id),this.customCssSelector&&this._renderedElement.classList.add(this.customCssSelector),this._renderedElement.style.boxSizing="border-box",this._defaultRenderedElementDisplayMode=this._renderedElement.style.display?this._renderedElement.style.display:void 0,this.adjustRenderedElementSize(this._renderedElement),this.updateLayout(!1)):this.isDesignMode()&&(this._renderedElement=this.createPlaceholderElement()),this.getRootElement().updateActionsEnabledState(),this._renderedElement},t.prototype.updateLayout=function(e){void 0===e&&(e=!0),this.updateRenderedElementVisibility(),this.applyPadding()},t.prototype.updateActionsEnabledState=function(){for(var e=0,t=this.getRootElement().getAllActions();e<t.length;e++){t[e].updateEnabledState()}},t.prototype.indexOf=function(e){return-1},t.prototype.isDesignMode=function(){var e=this.getRootElement();return e instanceof Ie&&e.designMode},t.prototype.isFirstElement=function(e){return!0},t.prototype.isLastElement=function(e){return!0},t.prototype.isAtTheVeryLeft=function(){return!this.parent||this.parent.isLeftMostElement(this)&&this.parent.isAtTheVeryLeft()},t.prototype.isAtTheVeryRight=function(){return!this.parent||this.parent.isRightMostElement(this)&&this.parent.isAtTheVeryRight()},t.prototype.isAtTheVeryTop=function(){return!this.parent||this.parent.isFirstElement(this)&&this.parent.isAtTheVeryTop()},t.prototype.isAtTheVeryBottom=function(){return!this.parent||this.parent.isLastElement(this)&&this.parent.isAtTheVeryBottom()},t.prototype.isBleedingAtTop=function(){return!1},t.prototype.isBleedingAtBottom=function(){return!1},t.prototype.isLeftMostElement=function(e){return!0},t.prototype.isRightMostElement=function(e){return!0},t.prototype.isTopElement=function(e){return this.isFirstElement(e)},t.prototype.isBottomElement=function(e){return this.isLastElement(e)},t.prototype.isHiddenDueToOverflow=function(){return void 0!==this._renderedElement&&"hidden"===this._renderedElement.style.visibility},t.prototype.getRootElement=function(){return this.getRootObject()},t.prototype.getParentContainer=function(){for(var e=this.parent;e;){if(e instanceof ge)return e;e=e.parent}},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),[]},t.prototype.getAllActions=function(){for(var e=[],t=0;t<this.getActionCount();t++){var n=this.getActionAt(t);n&&e.push(n)}return e},t.prototype.getResourceInformation=function(){return[]},t.prototype.getElementById=function(e){return this.id===e?this:void 0},t.prototype.getActionById=function(e){},t.prototype.getEffectivePadding=function(){var e=this.getPadding();return e||this.getDefaultPadding()},t.prototype.getEffectiveHorizontalAlignment=function(){return void 0!==this.horizontalAlignment?this.horizontalAlignment:this.parent?this.parent.getEffectiveHorizontalAlignment():p.HorizontalAlignment.Left},Object.defineProperty(t.prototype,"hostConfig",{get:function(){return this._hostConfig?this._hostConfig:this.parent?this.parent.hostConfig:h.defaultHostConfig},set:function(e){this._hostConfig=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:function(){return this.parent?this.parent.indexOf(this):0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInteractive",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInline",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!(!this.parent||!this.separatorElement)&&(!this.parent.isFirstElement(this)&&(this.isVisible||this.isDesignMode()))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"separatorElement",{get:function(){return this._separatorElement},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),t.prototype.getElementSingletonBehavior=function(){return g.ElementSingletonBehavior.NotAllowed},t.langProperty=new y.StringProperty(y.Versions.v1_1,"lang",!0,/^[a-z]{2,3}$/gi),t.isVisibleProperty=new y.BoolProperty(y.Versions.v1_2,"isVisible",!0),t.separatorProperty=new y.BoolProperty(y.Versions.v1_0,"separator",!1),t.heightProperty=new y.ValueSetProperty(y.Versions.v1_1,"height",[{value:"auto"},{value:"stretch"}],"auto"),t.horizontalAlignmentProperty=new y.EnumProperty(y.Versions.v1_0,"horizontalAlignment",p.HorizontalAlignment),t.spacingProperty=new y.EnumProperty(y.Versions.v1_0,"spacing",p.Spacing,p.Spacing.Default),s([(0,y.property)(t.horizontalAlignmentProperty)],t.prototype,"horizontalAlignment",void 0),s([(0,y.property)(t.spacingProperty)],t.prototype,"spacing",void 0),s([(0,y.property)(t.separatorProperty)],t.prototype,"separator",void 0),s([(0,y.property)(t.heightProperty)],t.prototype,"height",void 0),s([(0,y.property)(t.langProperty)],t.prototype,"lang",null),s([(0,y.property)(t.isVisibleProperty)],t.prototype,"isVisible",null),t}(f.CardObject);t.CardElement=C;var S=function(e){function t(t,n,r){void 0===r&&(r=[]);var i=e.call(this,t,n,void 0)||this;return i.targetVersion=t,i.name=n,i.forbiddenActionTypes=r,i}return o(t,e),t.prototype.parse=function(e,t,n){var r=e;return n.parseAction(r,t[this.name],this.forbiddenActionTypes,r.isDesignMode())},t.prototype.toJSON=function(e,t,n,r){r.serializeValue(t,this.name,n?n.toJSON(r):void 0,void 0,!0)},t}(y.PropertyDefinition);t.ActionProperty=S;var A=function(e){function t(t){var n=e.call(this)||this;return n.ariaHidden=!1,t&&(n.text=t),n}return o(t,e),t.prototype.populateSchema=function(n){e.prototype.populateSchema.call(this,n),n.remove(t.selectActionProperty)},Object.defineProperty(t.prototype,"text",{get:function(){return this.getValue(t.textProperty)},set:function(e){this.setText(e)},enumerable:!1,configurable:!0}),t.prototype.getFontSize=function(e){switch(this.effectiveSize){case p.TextSize.Small:return e.fontSizes.small;case p.TextSize.Medium:return e.fontSizes.medium;case p.TextSize.Large:return e.fontSizes.large;case p.TextSize.ExtraLarge:return e.fontSizes.extraLarge;default:return e.fontSizes.default}},t.prototype.getColorDefinition=function(e,t){switch(t){case p.TextColor.Accent:return e.accent;case p.TextColor.Dark:return e.dark;case p.TextColor.Light:return e.light;case p.TextColor.Good:return e.good;case p.TextColor.Warning:return e.warning;case p.TextColor.Attention:return e.attention;default:return e.default}},t.prototype.setText=function(e){this.setValue(t.textProperty,e)},t.prototype.init=function(e){this.size=e.size,this.weight=e.weight,this.color=e.color,this.isSubtle=e.isSubtle},t.prototype.asString=function(){return this.text},t.prototype.applyStylesTo=function(e){var t,n=this.hostConfig.getFontTypeDefinition(this.effectiveFontType);switch(n.fontFamily&&(e.style.fontFamily=n.fontFamily),this.effectiveSize){case p.TextSize.Small:t=n.fontSizes.small;break;case p.TextSize.Medium:t=n.fontSizes.medium;break;case p.TextSize.Large:t=n.fontSizes.large;break;case p.TextSize.ExtraLarge:t=n.fontSizes.extraLarge;break;default:t=n.fontSizes.default}e.style.fontSize=t+"px";var r,i=this.getColorDefinition(this.getEffectiveStyleDefinition().foregroundColors,this.effectiveColor),o=c.stringToCssColor(this.effectiveIsSubtle?i.subtle:i.default);switch(o&&(e.style.color=o),this.effectiveWeight){case p.TextWeight.Lighter:r=n.fontWeights.lighter;break;case p.TextWeight.Bolder:r=n.fontWeights.bolder;break;default:r=n.fontWeights.default}e.style.fontWeight=r.toString(),this.ariaHidden&&e.setAttribute("aria-hidden","true")},t.prototype.getAllActions=function(){var t=e.prototype.getAllActions.call(this);return this.selectAction&&t.push(this.selectAction),t},Object.defineProperty(t.prototype,"effectiveColor",{get:function(){return void 0!==this.color?this.color:this.getEffectiveTextStyleDefinition().color},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"effectiveFontType",{get:function(){return void 0!==this.fontType?this.fontType:this.getEffectiveTextStyleDefinition().fontType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"effectiveIsSubtle",{get:function(){return void 0!==this.isSubtle?this.isSubtle:this.getEffectiveTextStyleDefinition().isSubtle},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"effectiveSize",{get:function(){return void 0!==this.size?this.size:this.getEffectiveTextStyleDefinition().size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"effectiveWeight",{get:function(){return void 0!==this.weight?this.weight:this.getEffectiveTextStyleDefinition().weight},enumerable:!1,configurable:!0}),t.textProperty=new y.StringProperty(y.Versions.v1_0,"text",!0),t.sizeProperty=new y.EnumProperty(y.Versions.v1_0,"size",p.TextSize),t.weightProperty=new y.EnumProperty(y.Versions.v1_0,"weight",p.TextWeight),t.colorProperty=new y.EnumProperty(y.Versions.v1_0,"color",p.TextColor),t.isSubtleProperty=new y.BoolProperty(y.Versions.v1_0,"isSubtle"),t.fontTypeProperty=new y.EnumProperty(y.Versions.v1_2,"fontType",p.FontType),t.selectActionProperty=new S(y.Versions.v1_1,"selectAction",["Action.ShowCard"]),s([(0,y.property)(t.sizeProperty)],t.prototype,"size",void 0),s([(0,y.property)(t.weightProperty)],t.prototype,"weight",void 0),s([(0,y.property)(t.colorProperty)],t.prototype,"color",void 0),s([(0,y.property)(t.fontTypeProperty)],t.prototype,"fontType",void 0),s([(0,y.property)(t.isSubtleProperty)],t.prototype,"isSubtle",void 0),s([(0,y.property)(t.textProperty)],t.prototype,"text",null),s([(0,y.property)(t.selectActionProperty)],t.prototype,"selectAction",void 0),t}(C);t.BaseTextBlock=A;var w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.wrap=!1,t._treatAsPlainText=!0,t.useMarkdown=!0,t}var n,r;return o(t,e),t.prototype.restoreOriginalContent=function(){var e,n;if(void 0!==this.renderedElement){this.maxLines&&this.maxLines>0&&(this.renderedElement.style.maxHeight=this._computedLineHeight*this.maxLines+"px");var r=null!==(n=null===(e=t._ttRoundtripPolicy)||void 0===e?void 0:e.createHTML(this._originalInnerHtml))&&void 0!==n?n:this._originalInnerHtml;this.renderedElement.innerHTML=r}},t.prototype.truncateIfSupported=function(e){if(void 0!==this.renderedElement){var t=this.renderedElement.children,n=!t.length;if(n||1===t.length&&"p"===t[0].tagName.toLowerCase()&&!t[0].children.length){var r=n?this.renderedElement:t[0];return c.truncateText(r,e,this._computedLineHeight),!0}}return!1},t.prototype.setText=function(t){e.prototype.setText.call(this,t),this._processedText=void 0},t.prototype.internalRender=function(){var e,n,r=this;if(this._processedText=void 0,this.text){var i=this.preProcessPropertyValue(A.textProperty),o=this.hostConfig,s=void 0;if(this.forElementId){var a=document.createElement("label");a.htmlFor=this.forElementId,s=a}else s=document.createElement("div");if(s.classList.add(o.makeCssClassName("ac-textBlock")),s.style.overflow="hidden",this.applyStylesTo(s),"heading"===this.style){s.setAttribute("role","heading");var l=this.hostConfig.textBlock.headingLevel;void 0!==l&&l>0&&s.setAttribute("aria-level",l.toString())}if(this.selectAction&&o.supportsInteractivity&&(s.onclick=function(e){r.selectAction&&r.selectAction.isEffectivelyEnabled()&&(e.preventDefault(),e.cancelBubble=!0,r.selectAction.execute())},this.selectAction.setupElementForAccessibility(s),this.selectAction.isEffectivelyEnabled()&&s.classList.add(o.makeCssClassName("ac-selectable"))),!this._processedText){this._treatAsPlainText=!0;var p=d.formatText(this.lang,i);if(this.useMarkdown&&p){u.GlobalSettings.allowMarkForTextHighlighting&&(p=p.replace(/<mark>/g,"===").replace(/<\/mark>/g,"/==/"));var h=Ie.applyMarkdown(p);if(h.didProcess&&h.outputHtml){if(this._processedText=h.outputHtml,this._treatAsPlainText=!1,u.GlobalSettings.allowMarkForTextHighlighting&&this._processedText){var f="",y=this.getEffectiveStyleDefinition();y.highlightBackgroundColor&&(f+="background-color: "+y.highlightBackgroundColor+";"),y.highlightForegroundColor&&(f+="color: "+y.highlightForegroundColor+";"),f&&(f='style="'+f+'"'),this._processedText=this._processedText.replace(/===/g,"<mark "+f+">").replace(/\/==\//g,"</mark>")}}else this._processedText=p,this._treatAsPlainText=!0}else this._processedText=p,this._treatAsPlainText=!0}if(this._processedText||(this._processedText=""),this._treatAsPlainText)s.innerText=this._processedText;else{var g=null!==(n=null===(e=t._ttMarkdownPolicy)||void 0===e?void 0:e.createHTML(this._processedText))&&void 0!==n?n:this._processedText;s.innerHTML=g}if(s.firstElementChild instanceof HTMLElement){var m=s.firstElementChild;m.style.marginTop="0px",m.style.width="100%",this.wrap||(m.style.overflow="hidden",m.style.textOverflow="ellipsis")}s.lastElementChild instanceof HTMLElement&&(s.lastElementChild.style.marginBottom="0px");for(var v=s.getElementsByTagName("a"),b=function(e){e.classList.add(o.makeCssClassName("ac-anchor")),e.target="_blank",e.onclick=function(t){_e(r,e,t)&&(t.preventDefault(),t.cancelBubble=!0)},e.oncontextmenu=function(t){return!_e(r,e,t)||(t.preventDefault(),t.cancelBubble=!0,!1)}},_=0,C=Array.from(v);_<C.length;_++){b(C[_])}return this.wrap?(s.style.wordWrap="break-word",this.maxLines&&this.maxLines>0&&(s.style.overflow="hidden",c.isInternetExplorer()||!u.GlobalSettings.useWebkitLineClamp?s.style.maxHeight=this._computedLineHeight*this.maxLines+"px":(s.style.removeProperty("line-height"),s.style.display="-webkit-box",s.style.webkitBoxOrient="vertical",s.style.webkitLineClamp=this.maxLines.toString()))):(s.style.whiteSpace="nowrap",s.style.textOverflow="ellipsis"),(u.GlobalSettings.useAdvancedTextBlockTruncation||u.GlobalSettings.useAdvancedCardBottomTruncation)&&(this._originalInnerHtml=s.innerHTML),s}},t.prototype.truncateOverflow=function(e){return e>=this._computedLineHeight&&this.truncateIfSupported(e)},t.prototype.undoOverflowTruncation=function(){if(this.restoreOriginalContent(),u.GlobalSettings.useAdvancedTextBlockTruncation&&this.maxLines){var e=this._computedLineHeight*this.maxLines;this.truncateIfSupported(e)}},t.prototype.applyStylesTo=function(t){switch(e.prototype.applyStylesTo.call(this,t),this.getEffectiveHorizontalAlignment()){case p.HorizontalAlignment.Center:t.style.textAlign="center";break;case p.HorizontalAlignment.Right:t.style.textAlign="end";break;default:t.style.textAlign="start"}var n=this.hostConfig.lineHeights;if(n)switch(this.effectiveSize){case p.TextSize.Small:this._computedLineHeight=n.small;break;case p.TextSize.Medium:this._computedLineHeight=n.medium;break;case p.TextSize.Large:this._computedLineHeight=n.large;break;case p.TextSize.ExtraLarge:this._computedLineHeight=n.extraLarge;break;default:this._computedLineHeight=n.default}else this._computedLineHeight=1.33*this.getFontSize(this.hostConfig.getFontTypeDefinition(this.effectiveFontType));t.style.lineHeight=this._computedLineHeight+"px"},t.prototype.getJsonTypeName=function(){return"TextBlock"},t.prototype.getEffectiveTextStyleDefinition=function(){return this.style?this.hostConfig.textStyles.getStyleByName(this.style):e.prototype.getEffectiveTextStyleDefinition.call(this)},t.prototype.updateLayout=function(t){void 0===t&&(t=!1),e.prototype.updateLayout.call(this,t),u.GlobalSettings.useAdvancedTextBlockTruncation&&this.maxLines&&this.isDisplayed()&&(this.restoreOriginalContent(),this.truncateIfSupported(this._computedLineHeight*this.maxLines))},t.wrapProperty=new y.BoolProperty(y.Versions.v1_0,"wrap",!1),t.maxLinesProperty=new y.NumProperty(y.Versions.v1_0,"maxLines"),t.styleProperty=new y.ValueSetProperty(y.Versions.v1_5,"style",[{value:"default"},{value:"columnHeader"},{value:"heading"}]),t._ttMarkdownPolicy="undefined"==typeof window||null===(n=window.trustedTypes)||void 0===n?void 0:n.createPolicy("adaptivecards#markdownPassthroughPolicy",{createHTML:function(e){return e}}),t._ttRoundtripPolicy="undefined"==typeof window||null===(r=window.trustedTypes)||void 0===r?void 0:r.createPolicy("adaptivecards#restoreContentsPolicy",{createHTML:function(e){return e}}),s([(0,y.property)(t.wrapProperty)],t.prototype,"wrap",void 0),s([(0,y.property)(t.maxLinesProperty)],t.prototype,"maxLines",void 0),s([(0,y.property)(t.styleProperty)],t.prototype,"style",void 0),t}(A);t.TextBlock=w;var E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.italic=!1,t.strikethrough=!1,t.highlight=!1,t.underline=!1,t}return o(t,e),t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.add(A.selectActionProperty)},t.prototype.internalRender=function(){var e=this;if(this.text){var t=this.preProcessPropertyValue(A.textProperty),n=this.hostConfig,r=d.formatText(this.lang,t);r||(r="");var i=document.createElement("span");if(i.classList.add(n.makeCssClassName("ac-textRun")),this.applyStylesTo(i),this.selectAction&&n.supportsInteractivity){var o=document.createElement("a");o.classList.add(n.makeCssClassName("ac-anchor"));var s=this.selectAction.getHref();o.href=s||"",o.target="_blank",o.onclick=function(t){e.selectAction&&e.selectAction.isEffectivelyEnabled()&&(t.preventDefault(),t.cancelBubble=!0,e.selectAction.execute())},this.selectAction.setupElementForAccessibility(o),o.innerText=r,i.appendChild(o)}else i.innerText=r;return i}},t.prototype.applyStylesTo=function(t){if(e.prototype.applyStylesTo.call(this,t),this.italic&&(t.style.fontStyle="italic"),this.strikethrough&&(t.style.textDecoration="line-through"),this.highlight){var n=this.getColorDefinition(this.getEffectiveStyleDefinition().foregroundColors,this.effectiveColor),r=c.stringToCssColor(this.effectiveIsSubtle?n.highlightColors.subtle:n.highlightColors.default);r&&(t.style.backgroundColor=r)}this.underline&&(t.style.textDecoration="underline")},t.prototype.getJsonTypeName=function(){return"TextRun"},Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInline",{get:function(){return!0},enumerable:!1,configurable:!0}),t.italicProperty=new y.BoolProperty(y.Versions.v1_2,"italic",!1),t.strikethroughProperty=new y.BoolProperty(y.Versions.v1_2,"strikethrough",!1),t.highlightProperty=new y.BoolProperty(y.Versions.v1_2,"highlight",!1),t.underlineProperty=new y.BoolProperty(y.Versions.v1_3,"underline",!1),s([(0,y.property)(t.italicProperty)],t.prototype,"italic",void 0),s([(0,y.property)(t.strikethroughProperty)],t.prototype,"strikethrough",void 0),s([(0,y.property)(t.highlightProperty)],t.prototype,"highlight",void 0),s([(0,y.property)(t.underlineProperty)],t.prototype,"underline",void 0),t}(A);t.TextRun=E;var P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._inlines=[],t}return o(t,e),t.prototype.internalAddInline=function(e,t){if(void 0===t&&(t=!1),!e.isInline)throw new Error(m.Strings.errors.elementCannotBeUsedAsInline());if(!(void 0===e.parent||t)&&e.parent!==this)throw new Error(m.Strings.errors.inlineAlreadyParented());e.setParent(this),this._inlines.push(e)},t.prototype.internalParse=function(t,n){if(e.prototype.internalParse.call(this,t,n),this._inlines=[],Array.isArray(t.inlines))for(var r=0,i=t.inlines;r<i.length;r++){var o=i[r],s=void 0;if("string"==typeof o){var a=new E;a.text=o,s=a}else s=n.parseElement(this,o,[],!1);s&&this.internalAddInline(s,!0)}},t.prototype.internalToJSON=function(t,n){if(e.prototype.internalToJSON.call(this,t,n),this._inlines.length>0){for(var r=[],i=0,o=this._inlines;i<o.length;i++){var s=o[i];r.push(s.toJSON(n))}n.serializeValue(t,"inlines",r)}},t.prototype.internalRender=function(){if(this._inlines.length>0){var e=void 0;if(this.forElementId){var t=document.createElement("label");t.htmlFor=this.forElementId,e=t}else e=document.createElement("div");switch(e.className=this.hostConfig.makeCssClassName("ac-richTextBlock"),this.getEffectiveHorizontalAlignment()){case p.HorizontalAlignment.Center:e.style.textAlign="center";break;case p.HorizontalAlignment.Right:e.style.textAlign="end";break;default:e.style.textAlign="start"}for(var n=0,r=0,i=this._inlines;r<i.length;r++){var o=i[r].render();o&&(e.appendChild(o),n++)}if(n>0)return e}},t.prototype.asString=function(){for(var e="",t=0,n=this._inlines;t<n.length;t++){e+=n[t].asString()}return e},t.prototype.getJsonTypeName=function(){return"RichTextBlock"},t.prototype.getInlineCount=function(){return this._inlines.length},t.prototype.getInlineAt=function(e){if(e>=0&&e<this._inlines.length)return this._inlines[e];throw new Error(m.Strings.errors.indexOutOfRange(e))},t.prototype.addInline=function(e){"string"==typeof e?this.internalAddInline(new E(e)):this.internalAddInline(e)},t.prototype.removeInline=function(e){var t=this._inlines.indexOf(e);return t>=0&&(this._inlines[t].setParent(void 0),this._inlines.splice(t,1),!0)},t}(C);t.RichTextBlock=P;var x=function(e){function t(t,n){var r=e.call(this)||this;return r.name=t,r.value=n,r}return o(t,e),t.prototype.getSchemaKey=function(){return"Fact"},t.titleProperty=new y.StringProperty(y.Versions.v1_0,"title"),t.valueProperty=new y.StringProperty(y.Versions.v1_0,"value"),s([(0,y.property)(t.titleProperty)],t.prototype,"name",void 0),s([(0,y.property)(t.valueProperty)],t.prototype,"value",void 0),t}(y.SerializableObject);t.Fact=x;var k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.internalRender=function(){var e=void 0,t=this.hostConfig;if(this.facts.length>0){(e=document.createElement("table")).style.borderWidth="0px",e.style.borderSpacing="0px",e.style.borderStyle="none",e.style.borderCollapse="collapse",e.style.display="block",e.style.overflow="hidden",e.classList.add(t.makeCssClassName("ac-factset")),e.setAttribute("role","presentation");for(var n=0;n<this.facts.length;n++){var r=document.createElement("tr");n>0&&(r.style.marginTop=t.factSet.spacing+"px");var i=document.createElement("td");i.style.padding="0",i.classList.add(t.makeCssClassName("ac-fact-title")),t.factSet.title.maxWidth&&(i.style.maxWidth=t.factSet.title.maxWidth+"px"),i.style.verticalAlign="top";var o=new w;o.setParent(this),o.text=!this.facts[n].name&&this.isDesignMode()?"Title":this.facts[n].name,o.size=t.factSet.title.size,o.color=t.factSet.title.color,o.isSubtle=t.factSet.title.isSubtle,o.weight=t.factSet.title.weight,o.wrap=t.factSet.title.wrap,o.spacing=p.Spacing.None,c.appendChild(i,o.render()),c.appendChild(r,i),(i=document.createElement("td")).style.width="10px",c.appendChild(r,i),(i=document.createElement("td")).style.padding="0",i.style.verticalAlign="top",i.classList.add(t.makeCssClassName("ac-fact-value")),(o=new w).setParent(this),o.text=this.facts[n].value,o.size=t.factSet.value.size,o.color=t.factSet.value.color,o.isSubtle=t.factSet.value.isSubtle,o.weight=t.factSet.value.weight,o.wrap=t.factSet.value.wrap,o.spacing=p.Spacing.None,c.appendChild(i,o.render()),c.appendChild(r,i),c.appendChild(e,r)}}return e},t.prototype.getJsonTypeName=function(){return"FactSet"},t.factsProperty=new y.SerializableObjectCollectionProperty(y.Versions.v1_0,"facts",x),s([(0,y.property)(t.factsProperty)],t.prototype,"facts",void 0),t}(C);t.FactSet=k;var I=function(e){function t(t,n,r,i){var o=e.call(this,t,n)||this;return o.targetVersion=t,o.name=n,o.internalName=r,o.fallbackProperty=i,o}return o(t,e),t.prototype.getInternalName=function(){return this.internalName},t.prototype.parse=function(e,t,n){var r=void 0,i=t[this.name];if(void 0===i)return this.defaultValue;var o=!1;if("string"==typeof i){try{var s=u.SizeAndUnit.parse(i,!0);s.unit===p.SizeUnit.Pixel&&(r=s.physicalSize,o=!0)}catch(e){}!o&&this.fallbackProperty&&(o=this.fallbackProperty.isValidValue(i,n))}return o||n.logParseEvent(e,p.ValidationEvent.InvalidPropertyValue,m.Strings.errors.invalidPropertyValue(i,this.name)),r},t.prototype.toJSON=function(e,t,n,r){r.serializeValue(t,this.name,"number"!=typeof n||isNaN(n)?void 0:n+"px")},t}(y.PropertyDefinition),T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.size=p.Size.Auto,t.style=p.ImageStyle.Default,t}return o(t,e),t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.remove(C.heightProperty)},t.prototype.applySize=function(e){if(this.pixelWidth||this.pixelHeight)this.pixelWidth&&(e.style.width=this.pixelWidth+"px"),this.pixelHeight&&(e.style.height=this.pixelHeight+"px");else if(this.maxHeight){switch(this.size){case p.Size.Small:e.style.height=this.hostConfig.imageSizes.small+"px";break;case p.Size.Large:e.style.height=this.hostConfig.imageSizes.large+"px";break;default:e.style.height=this.hostConfig.imageSizes.medium+"px"}e.style.maxHeight=this.maxHeight+"px"}else{switch(this.size){case p.Size.Stretch:e.style.width="100%";break;case p.Size.Auto:e.style.maxWidth="100%";break;case p.Size.Small:e.style.width=this.hostConfig.imageSizes.small+"px";break;case p.Size.Large:e.style.width=this.hostConfig.imageSizes.large+"px";break;case p.Size.Medium:e.style.width=this.hostConfig.imageSizes.medium+"px"}e.style.maxHeight="100%"}},Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.internalRender=function(){var e=this,n=void 0;if(this.url){(n=document.createElement("div")).style.display="flex",n.style.alignItems="flex-start";var r=this.hostConfig;switch(this.getEffectiveHorizontalAlignment()){case p.HorizontalAlignment.Center:n.style.justifyContent="center";break;case p.HorizontalAlignment.Right:n.style.justifyContent="flex-end";break;default:n.style.justifyContent="flex-start"}var i=document.createElement("img");i.onload=function(t){be(e)},i.onerror=function(t){if(e.renderedElement){var n=e.getRootElement();if(e.renderedElement,n&&n.designMode){var r=document.createElement("div");r.style.display="flex",r.style.alignItems="center",r.style.justifyContent="center",r.style.backgroundColor="#EEEEEE",r.style.color="black",r.innerText=":-(",r.style.padding="10px",e.applySize(r),e.renderedElement.appendChild(r)}}be(e)},i.style.minWidth="0",i.classList.add(r.makeCssClassName("ac-image")),this.selectAction&&r.supportsInteractivity&&(i.onkeypress=function(t){e.selectAction&&e.selectAction.isEffectivelyEnabled()&&("Enter"===t.code||"Space"===t.code)&&(t.preventDefault(),t.cancelBubble=!0,e.selectAction.execute())},i.onclick=function(t){e.selectAction&&e.selectAction.isEffectivelyEnabled()&&(t.preventDefault(),t.cancelBubble=!0,e.selectAction.execute())},this.selectAction.setupElementForAccessibility(i),this.selectAction.isEffectivelyEnabled()&&i.classList.add(r.makeCssClassName("ac-selectable"))),this.applySize(i),this.style===p.ImageStyle.Person&&(i.style.borderRadius="50%",i.style.backgroundPosition="50% 50%",i.style.backgroundRepeat="no-repeat");var o=c.stringToCssColor(this.backgroundColor);o&&(i.style.backgroundColor=o),i.src=this.preProcessPropertyValue(t.urlProperty);var s=this.preProcessPropertyValue(t.altTextProperty);s&&(i.alt=s),n.appendChild(i)}return n},t.prototype.getJsonTypeName=function(){return"Image"},t.prototype.getAllActions=function(){var t=e.prototype.getAllActions.call(this);return this.selectAction&&t.push(this.selectAction),t},t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);return!n&&this.selectAction&&(n=this.selectAction.getActionById(t)),n},t.prototype.getResourceInformation=function(){return this.url?[{url:this.url,mimeType:"image"}]:[]},t.urlProperty=new y.StringProperty(y.Versions.v1_0,"url"),t.altTextProperty=new y.StringProperty(y.Versions.v1_0,"altText"),t.backgroundColorProperty=new y.StringProperty(y.Versions.v1_1,"backgroundColor"),t.styleProperty=new y.EnumProperty(y.Versions.v1_0,"style",p.ImageStyle,p.ImageStyle.Default),t.sizeProperty=new y.EnumProperty(y.Versions.v1_0,"size",p.Size,p.Size.Auto),t.pixelWidthProperty=new I(y.Versions.v1_1,"width","pixelWidth"),t.pixelHeightProperty=new I(y.Versions.v1_1,"height","pixelHeight",C.heightProperty),t.selectActionProperty=new S(y.Versions.v1_1,"selectAction",["Action.ShowCard"]),s([(0,y.property)(t.urlProperty)],t.prototype,"url",void 0),s([(0,y.property)(t.altTextProperty)],t.prototype,"altText",void 0),s([(0,y.property)(t.backgroundColorProperty)],t.prototype,"backgroundColor",void 0),s([(0,y.property)(t.sizeProperty)],t.prototype,"size",void 0),s([(0,y.property)(t.styleProperty)],t.prototype,"style",void 0),s([(0,y.property)(t.pixelWidthProperty)],t.prototype,"pixelWidth",void 0),s([(0,y.property)(t.pixelHeightProperty)],t.prototype,"pixelHeight",void 0),s([(0,y.property)(t.selectActionProperty)],t.prototype,"selectAction",void 0),t}(C);t.Image=T;var O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allowVerticalOverflow=!1,t}return o(t,e),t.prototype.populateSchema=function(n){e.prototype.populateSchema.call(this,n),this.isSelectable||n.remove(t.selectActionProperty)},t.prototype.isElementAllowed=function(e){return this.hostConfig.supportsInteractivity||!e.isInteractive},t.prototype.applyPadding=function(){if(e.prototype.applyPadding.call(this),this.renderedElement){var t=new u.SpacingDefinition;this.getEffectivePadding()&&(t=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())),this.renderedElement.style.paddingTop=t.top+"px",this.renderedElement.style.paddingRight=t.right+"px",this.renderedElement.style.paddingBottom=t.bottom+"px",this.renderedElement.style.paddingLeft=t.left+"px",this.renderedElement.style.marginRight="0",this.renderedElement.style.marginLeft="0"}},Object.defineProperty(t.prototype,"isSelectable",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.forbiddenChildElements=function(){return[]},t.prototype.releaseDOMResources=function(){e.prototype.releaseDOMResources.call(this);for(var t=0;t<this.getItemCount();t++)this.getItemAt(t).releaseDOMResources()},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);for(var n=0;n<this.getItemCount();n++){var r=this.getItemAt(n);!this.hostConfig.supportsInteractivity&&r.isInteractive&&t.addFailure(this,p.ValidationEvent.InteractivityNotAllowed,m.Strings.errors.interactivityNotAllowed()),this.isElementAllowed(r)||t.addFailure(this,p.ValidationEvent.InteractivityNotAllowed,m.Strings.errors.elementTypeNotAllowed(r.getJsonTypeName())),r.internalValidateProperties(t)}this._selectAction&&this._selectAction.internalValidateProperties(t)},t.prototype.render=function(){var t=this,n=e.prototype.render.call(this);if(n){var r=this.hostConfig;this.allowVerticalOverflow&&(n.style.overflowX="hidden",n.style.overflowY="auto"),n&&this.isSelectable&&this._selectAction&&r.supportsInteractivity&&(n.onclick=function(e){t._selectAction&&t._selectAction.isEffectivelyEnabled()&&(e.preventDefault(),e.cancelBubble=!0,t._selectAction.execute())},n.onkeypress=function(e){t._selectAction&&t._selectAction.isEffectivelyEnabled()&&("Enter"===e.code||"Space"===e.code)&&(e.preventDefault(),e.cancelBubble=!0,t._selectAction.execute())},this._selectAction.setupElementForAccessibility(n),this._selectAction.isEffectivelyEnabled()&&n.classList.add(r.makeCssClassName("ac-selectable")))}return n},t.prototype.updateLayout=function(t){if(void 0===t&&(t=!0),e.prototype.updateLayout.call(this,t),t)for(var n=0;n<this.getItemCount();n++)this.getItemAt(n).updateLayout()},t.prototype.getAllInputs=function(e){void 0===e&&(e=!0);for(var t=[],n=0;n<this.getItemCount();n++)t.push.apply(t,this.getItemAt(n).getAllInputs(e));return t},t.prototype.getAllActions=function(){for(var t=e.prototype.getAllActions.call(this),n=0;n<this.getItemCount();n++)t.push.apply(t,this.getItemAt(n).getAllActions());return this._selectAction&&t.push(this._selectAction),t},t.prototype.getResourceInformation=function(){for(var e=[],t=0;t<this.getItemCount();t++)e.push.apply(e,this.getItemAt(t).getResourceInformation());return e},t.prototype.getElementById=function(t){var n=e.prototype.getElementById.call(this,t);if(!n)for(var r=0;r<this.getItemCount()&&!(n=this.getItemAt(r).getElementById(t));r++);return n},t.prototype.findDOMNodeOwner=function(t){for(var n,r=void 0,i=0;i<this.getItemCount();i++)if(r=this.getItemAt(i).findDOMNodeOwner(t))return r;for(i=0;i<this.getActionCount();i++)if(r=null===(n=this.getActionAt(i))||void 0===n?void 0:n.findDOMNodeOwner(t))return r;return e.prototype.findDOMNodeOwner.call(this,t)},t.selectActionProperty=new S(y.Versions.v1_1,"selectAction",["Action.ShowCard"]),s([(0,y.property)(t.selectActionProperty)],t.prototype,"_selectAction",void 0),t}(C);t.CardElementContainer=O;var V=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._images=[],t.imageSize=p.ImageSize.Medium,t}return o(t,e),t.prototype.internalRender=function(){var e=void 0;if(this._images.length>0){(e=document.createElement("div")).style.display="flex",e.style.flexWrap="wrap";for(var t=0,n=this._images;t<n.length;t++){var r=n[t];switch(this.imageSize){case p.ImageSize.Small:r.size=p.Size.Small;break;case p.ImageSize.Large:r.size=p.Size.Large;break;default:r.size=p.Size.Medium}r.maxHeight=this.hostConfig.imageSet.maxImageHeight;var i=r.render();i&&(i.style.display="inline-flex",i.style.margin="0px",i.style.marginRight="10px",c.appendChild(e,i))}}return e},t.prototype.getItemCount=function(){return this._images.length},t.prototype.getItemAt=function(e){return this._images[e]},t.prototype.getFirstVisibleRenderedItem=function(){return this._images&&this._images.length>0?this._images[0]:void 0},t.prototype.getLastVisibleRenderedItem=function(){return this._images&&this._images.length>0?this._images[this._images.length-1]:void 0},t.prototype.removeItem=function(e){if(e instanceof T){var t=this._images.indexOf(e);if(t>=0)return this._images.splice(t,1),e.setParent(void 0),this.updateLayout(),!0}return!1},t.prototype.getJsonTypeName=function(){return"ImageSet"},t.prototype.addImage=function(e){if(e.parent)throw new Error("This image already belongs to another ImageSet");this._images.push(e),e.setParent(this)},t.prototype.indexOf=function(e){return e instanceof T?this._images.indexOf(e):-1},t.imagesProperty=new y.SerializableObjectCollectionProperty(y.Versions.v1_0,"images",T,(function(e,t){t.setParent(e)})),t.imageSizeProperty=new y.EnumProperty(y.Versions.v1_0,"imageSize",p.ImageSize,p.ImageSize.Medium),s([(0,y.property)(t.imagesProperty)],t.prototype,"_images",void 0),s([(0,y.property)(t.imageSizeProperty)],t.prototype,"imageSize",void 0),t}(O);t.ImageSet=V;var M=function(e){function t(t,n){var r=e.call(this)||this;return r.url=t,r.mimeType=n,r}return o(t,e),t.prototype.isValid=function(){return!(!this.mimeType||!this.url)},t.mimeTypeProperty=new y.StringProperty(y.Versions.v1_1,"mimeType"),t.urlProperty=new y.StringProperty(y.Versions.v1_1,"url"),s([(0,y.property)(t.mimeTypeProperty)],t.prototype,"mimeType",void 0),s([(0,y.property)(t.urlProperty)],t.prototype,"url",void 0),t}(y.SerializableObject);t.ContentSource=M;var N=function(e){function t(t,n,r){var i=e.call(this,t,n)||this;return i.label=r,i}return o(t,e),t.prototype.getSchemaKey=function(){return"CaptionSource"},t.prototype.render=function(){var e=void 0;return this.isValid()&&((e=document.createElement("track")).src=this.url,e.kind="captions",e.label=this.label),e},t.labelProperty=new y.StringProperty(y.Versions.v1_6,"label"),s([(0,y.property)(t.labelProperty)],t.prototype,"label",void 0),t}(M);t.CaptionSource=N;var R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getSchemaKey=function(){return"MediaSource"},t.prototype.render=function(){var e=void 0;return this.isValid()&&((e=document.createElement("source")).src=this.url,e.type=this.mimeType),e},t}(M);t.MediaSource=R;var z=function(){function e(){}return e.prototype.play=function(){},Object.defineProperty(e.prototype,"posterUrl",{get:function(){return this._posterUrl},set:function(e){this._posterUrl=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectedMediaType",{get:function(){},enumerable:!1,configurable:!0}),e}();t.MediaPlayer=z;var L=function(e){function t(t){var n=e.call(this)||this;return n.owner=t,n._selectedSources=[],n._captionSources=[],n.processSources(),n}return o(t,e),t.prototype.processSources=function(){var e;this._selectedSources=[],this._captionSources=[],this._selectedMediaType=void 0;for(var n=0,r=this.owner.sources;n<r.length;n++){var i=r[n],o=i.mimeType?i.mimeType.split("/"):[];if(2===o.length){if(!this._selectedMediaType){var s=t.supportedMediaTypes.indexOf(o[0]);s>=0&&(this._selectedMediaType=t.supportedMediaTypes[s])}o[0]===this._selectedMediaType&&this._selectedSources.push(i)}}(e=this._captionSources).push.apply(e,this.owner.captionSources)},t.prototype.canPlay=function(){return this._selectedSources.length>0},t.prototype.fetchVideoDetails=function(){return a(this,void 0,void 0,(function(){return l(this,(function(e){return[2]}))}))},t.prototype.render=function(){"video"===this._selectedMediaType?this._mediaElement=document.createElement("video"):this._mediaElement=document.createElement("audio"),this._mediaElement.setAttribute("aria-label",this.owner.altText?this.owner.altText:m.Strings.defaults.mediaPlayerAriaLabel()),this._mediaElement.setAttribute("webkit-playsinline",""),this._mediaElement.setAttribute("playsinline",""),this._mediaElement.setAttribute("crossorigin",""),this._mediaElement.autoplay=!0,this._mediaElement.controls=!0,c.isMobileOS()&&(this._mediaElement.muted=!0),this._mediaElement.preload="none",this._mediaElement.style.width="100%";for(var e=0,t=this.owner.sources;e<t.length;e++){var n=t[e].render();c.appendChild(this._mediaElement,n)}for(var r=0,i=this.owner.captionSources;r<i.length;r++){var o=i[r];if("vtt"==o.mimeType){var s=o.render();c.appendChild(this._mediaElement,s)}}return this._mediaElement},t.prototype.play=function(){this._mediaElement&&this._mediaElement.play()},Object.defineProperty(t.prototype,"selectedMediaType",{get:function(){return this._selectedMediaType},enumerable:!1,configurable:!0}),t.supportedMediaTypes=["audio","video"],t}(z);t.HTML5MediaPlayer=L;var D=function(e){function t(t){return e.call(this)||this}return o(t,e),t}(z);t.CustomMediaPlayer=D;var B=function(e){function t(t,n){var r=e.call(this,t)||this;return r.iFrameTitle=n,t.length>=2&&(r._videoId=t[1]),r}return o(t,e),t.prototype.canPlay=function(){return void 0!==this._videoId},t.prototype.render=function(){var e=document.createElement("div");e.style.position="relative",e.style.width="100%",e.style.height="0",e.style.paddingBottom="56.25%";var t=document.createElement("iframe");return t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.src=this.getEmbedVideoUrl(),t.frameBorder="0",this.iFrameTitle&&(t.title=this.iFrameTitle),t.allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",t.allowFullscreen=!0,e.appendChild(t),e},Object.defineProperty(t.prototype,"videoId",{get:function(){return this._videoId},enumerable:!1,configurable:!0}),t}(D);t.IFrameMediaMediaPlayer=B;var j=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.fetchVideoDetails=function(){return a(this,void 0,void 0,(function(){var e,t,n;return l(this,(function(r){switch(r.label){case 0:return e="https://vimeo.com/api/oembed.json?url=".concat(this.getEmbedVideoUrl()),[4,fetch(e)];case 1:return(t=r.sent()).ok?[4,t.json()]:[3,3];case 2:n=r.sent(),this.posterUrl=n.thumbnail_url,r.label=3;case 3:return[2]}}))}))},t.prototype.getEmbedVideoUrl=function(){return"https://player.vimeo.com/video/".concat(this.videoId,"?autoplay=1")},t}(B);t.VimeoPlayer=j;var F=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.fetchVideoDetails=function(){return a(this,void 0,void 0,(function(){var e,t,n;return l(this,(function(r){switch(r.label){case 0:return e="https://api.dailymotion.com/video/".concat(this.videoId,"?fields=thumbnail_720_url"),[4,fetch(e)];case 1:return(t=r.sent()).ok?[4,t.json()]:[3,3];case 2:n=r.sent(),this.posterUrl=n.thumbnail_720_url,r.label=3;case 3:return[2]}}))}))},t.prototype.getEmbedVideoUrl=function(){return"https://www.dailymotion.com/embed/video/".concat(this.videoId,"?autoplay=1")},t}(B);t.DailymotionPlayer=F;var H=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.iFrameTitle=n,t.length>=3&&void 0!==t[2]&&(r._startTimeIndex=parseInt(t[2])),r}return o(t,e),t.prototype.fetchVideoDetails=function(){return a(this,void 0,void 0,(function(){return l(this,(function(e){return this.posterUrl=this.videoId?"https://img.youtube.com/vi/".concat(this.videoId,"/maxresdefault.jpg"):void 0,[2]}))}))},t.prototype.getEmbedVideoUrl=function(){var e="https://www.youtube.com/embed/".concat(this.videoId,"?autoplay=1");return void 0!==this._startTimeIndex&&(e+="&start=".concat(this._startTimeIndex)),e},t}(B);t.YouTubePlayer=H;var U=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sources=[],t.captionSources=[],t}return o(t,e),t.prototype.createMediaPlayer=function(){for(var e=0,n=t.customMediaPlayers;e<n.length;e++)for(var r=n[e],i=0,o=this.sources;i<o.length;i++){var s=o[i];if(s.url)for(var a=0,l=r.urlPatterns;a<l.length;a++){var p=l[a].exec(s.url);if(null!==p)return r.createMediaPlayer(p)}}return new L(this)},t.prototype.handlePlayButtonInvoke=function(e){if(this.hostConfig.media.allowInlinePlayback){if(e.preventDefault(),e.cancelBubble=!0,this.renderedElement){var n=this._mediaPlayer.render();b(this.renderedElement),this.renderedElement.appendChild(n),this._mediaPlayer.play(),n.focus()}}else t.onPlay&&(e.preventDefault(),e.cancelBubble=!0,t.onPlay(this))},t.prototype.displayPoster=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,i,o,s=this;return l(this,(function(a){return this.renderedElement&&(12,15,(e=document.createElement("div")).className=this.hostConfig.makeCssClassName("ac-media-poster"),e.setAttribute("role","contentinfo"),e.setAttribute("aria-label",this.altText?this.altText:m.Strings.defaults.mediaPlayerAriaLabel()),e.style.position="relative",e.style.display="flex",(t=this.poster?this.poster:this._mediaPlayer.posterUrl)||(t=this.hostConfig.media.defaultPoster),t?((n=document.createElement("img")).style.width="100%",n.style.height="100%",n.setAttribute("role","presentation"),n.onerror=function(t){n.parentNode&&n.parentNode.removeChild(n),e.classList.add("empty"),e.style.minHeight="150px"},n.src=t,e.appendChild(n)):(e.classList.add("empty"),e.style.minHeight="150px"),this.hostConfig.supportsInteractivity&&this._mediaPlayer.canPlay()&&((r=document.createElement("div")).tabIndex=0,r.setAttribute("role","button"),r.setAttribute("aria-label",m.Strings.defaults.mediaPlayerPlayMedia()),r.className=this.hostConfig.makeCssClassName("ac-media-playButton"),r.style.display="flex",r.style.alignItems="center",r.style.justifyContent="center",r.onclick=function(e){s.handlePlayButtonInvoke(e)},r.onkeypress=function(e){"Enter"!==e.code&&"Space"!==e.code||s.handlePlayButtonInvoke(e)},(i=document.createElement("div")).className=this.hostConfig.makeCssClassName("ac-media-playButton-arrow"),i.style.width="12px",i.style.height="15px",i.style.borderTopWidth="7.5px",i.style.borderBottomWidth="7.5px",i.style.borderLeftWidth="12px",i.style.borderRightWidth="0",i.style.borderStyle="solid",i.style.borderTopColor="transparent",i.style.borderRightColor="transparent",i.style.borderBottomColor="transparent",i.style.transform="translate(1.2px,0px)",r.appendChild(i),(o=document.createElement("div")).style.position="absolute",o.style.left="0",o.style.top="0",o.style.width="100%",o.style.height="100%",o.style.display="flex",o.style.justifyContent="center",o.style.alignItems="center",o.appendChild(r),e.appendChild(o)),b(this.renderedElement),this.renderedElement.appendChild(e)),[2]}))}))},t.prototype.internalRender=function(){var e=document.createElement("div");return e.className=this.hostConfig.makeCssClassName("ac-media"),e},t.prototype.render=function(){var t=this,n=e.prototype.render.call(this);return n&&(this._mediaPlayer=this.createMediaPlayer(),this._mediaPlayer.fetchVideoDetails().then((function(){return t.displayPoster()}))),n},t.prototype.releaseDOMResources=function(){e.prototype.releaseDOMResources.call(this),this.displayPoster()},t.prototype.getJsonTypeName=function(){return"Media"},t.prototype.getResourceInformation=function(){var e=[];if(this._mediaPlayer){var t=this.poster?this.poster:this.hostConfig.media.defaultPoster;t&&e.push({url:t,mimeType:"image"})}for(var n=0,r=this.sources;n<r.length;n++){var i=r[n];i.isValid()&&e.push({url:i.url,mimeType:i.mimeType})}for(var o=0,s=this.captionSources;o<s.length;o++){var a=s[o];a.isValid()&&e.push({url:a.url,mimeType:a.mimeType})}return e},Object.defineProperty(t.prototype,"selectedMediaType",{get:function(){return this._mediaPlayer.selectedMediaType},enumerable:!1,configurable:!0}),t.customMediaPlayers=[{urlPatterns:[/^(?:https?:\/\/)?(?:www.)?youtube.com\/watch\?(?=.*v=([\w\d-_]+))(?=(?:.*t=(\d+))?).*/gi,/^(?:https?:\/\/)?youtu.be\/([\w\d-_]+)(?:\?t=(\d+))?/gi],createMediaPlayer:function(e){return new H(e,m.Strings.defaults.youTubeVideoPlayer())}},{urlPatterns:[/^(?:https?:\/\/)?vimeo.com\/([\w\d-_]+).*/gi],createMediaPlayer:function(e){return new j(e,m.Strings.defaults.vimeoVideoPlayer())}},{urlPatterns:[/^(?:https?:\/\/)?(?:www.)?dailymotion.com\/video\/([\w\d-_]+).*/gi],createMediaPlayer:function(e){return new F(e,m.Strings.defaults.dailymotionVideoPlayer())}}],t.sourcesProperty=new y.SerializableObjectCollectionProperty(y.Versions.v1_1,"sources",R),t.captionSourcesProperty=new y.SerializableObjectCollectionProperty(y.Versions.v1_6,"captionSources",N),t.posterProperty=new y.StringProperty(y.Versions.v1_1,"poster"),t.altTextProperty=new y.StringProperty(y.Versions.v1_1,"altText"),s([(0,y.property)(t.sourcesProperty)],t.prototype,"sources",void 0),s([(0,y.property)(t.captionSourcesProperty)],t.prototype,"captionSources",void 0),s([(0,y.property)(t.posterProperty)],t.prototype,"poster",void 0),s([(0,y.property)(t.altTextProperty)],t.prototype,"altText",void 0),t}(C);t.Media=U;var W=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getAllLabelIds=function(){var e=[];return this.labelledBy&&e.push(this.labelledBy),this._renderedLabelElement&&e.push(this._renderedLabelElement.id),this._renderedErrorMessageElement&&e.push(this._renderedErrorMessageElement.id),e},t.prototype.updateInputControlAriaLabelledBy=function(){if(this._renderedInputControlElement){var e=this.getAllLabelIds();e.length>0?this._renderedInputControlElement.setAttribute("aria-labelledby",e.join(" ")):this._renderedInputControlElement.removeAttribute("aria-labelledby")}},Object.defineProperty(t.prototype,"isNullable",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedInputControlElement",{get:function(){return this._renderedInputControlElement},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inputControlContainerElement",{get:function(){return this._inputControlContainerElement},enumerable:!1,configurable:!0}),t.prototype.overrideInternalRender=function(){var e=this.hostConfig;this._outerContainerElement=document.createElement("div"),this._outerContainerElement.style.display="flex",this._outerContainerElement.style.flexDirection="column";var t=c.generateUniqueId();if(this.label){var n=new P;n.setParent(this),n.forElementId=t;var r=new E(this.label);if(n.addInline(r),this.isRequired){r.init(e.inputs.label.requiredInputs);var i=new E(e.inputs.label.requiredInputs.suffix);i.color=e.inputs.label.requiredInputs.suffixColor,i.ariaHidden=!0,n.addInline(i)}else r.init(e.inputs.label.optionalInputs);this._renderedLabelElement=n.render(),this._renderedLabelElement&&(this._renderedLabelElement.id=c.generateUniqueId(),this._renderedLabelElement.style.marginBottom=e.getEffectiveSpacing(e.inputs.label.inputSpacing)+"px",this._outerContainerElement.appendChild(this._renderedLabelElement))}if(this._inputControlContainerElement=document.createElement("div"),this._inputControlContainerElement.className=e.makeCssClassName("ac-input-container"),this._inputControlContainerElement.style.display="flex","stretch"===this.height&&(this._inputControlContainerElement.style.alignItems="stretch",this._inputControlContainerElement.style.flex="1 1 auto"),this._renderedInputControlElement=this.internalRender(),this._renderedInputControlElement)return this._renderedInputControlElement.id=t,this._renderedInputControlElement.style.minWidth="0px",this.isNullable&&this.isRequired&&(this._renderedInputControlElement.setAttribute("aria-required","true"),this._renderedInputControlElement.classList.add(e.makeCssClassName("ac-input-required"))),this._inputControlContainerElement.appendChild(this._renderedInputControlElement),this._outerContainerElement.appendChild(this._inputControlContainerElement),this.updateInputControlAriaLabelledBy(),this._outerContainerElement;this.resetDirtyState()},t.prototype.valueChanged=function(){var e,t,n;this.getRootElement().updateActionsEnabledState(),this.isValid()&&this.resetValidationFailureCue(),this.onValueChanged&&this.onValueChanged(this),t=(e=this).getRootElement(),(n=t&&t.onInputValueChanged?t.onInputValueChanged:Ie.onInputValueChanged)&&n(e)},t.prototype.resetValidationFailureCue=function(){this.renderedInputControlElement&&(this.renderedInputControlElement.classList.remove(this.hostConfig.makeCssClassName("ac-input-validation-failed")),this.updateInputControlAriaLabelledBy(),this._renderedErrorMessageElement&&(this._outerContainerElement.removeChild(this._renderedErrorMessageElement),this._renderedErrorMessageElement=void 0))},t.prototype.showValidationErrorMessage=function(){if(this.renderedElement&&this.errorMessage&&u.GlobalSettings.displayInputValidationErrors){var e=new w;e.setParent(this),e.text=this.errorMessage,e.wrap=!0,e.init(this.hostConfig.inputs.errorMessage),this._renderedErrorMessageElement=e.render(),this._renderedErrorMessageElement&&(this._renderedErrorMessageElement.id=c.generateUniqueId(),this._outerContainerElement.appendChild(this._renderedErrorMessageElement),this.updateInputControlAriaLabelledBy())}},t.prototype.focus=function(){this._renderedInputControlElement&&this._renderedInputControlElement.focus()},t.prototype.isValid=function(){return!0},t.prototype.isDirty=function(){return this.value!==this._oldValue},t.prototype.resetDirtyState=function(){this._oldValue=this.value},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this.id||t.addFailure(this,p.ValidationEvent.PropertyCantBeNull,m.Strings.errors.inputsMustHaveUniqueId()),this.isRequired&&(this.label||t.addFailure(this,p.ValidationEvent.RequiredInputsShouldHaveLabel,"Required inputs should have a label"),this.errorMessage||t.addFailure(this,p.ValidationEvent.RequiredInputsShouldHaveErrorMessage,"Required inputs should have an error message"))},t.prototype.validateValue=function(){this.resetValidationFailureCue();var e=this.isRequired?this.isSet()&&this.isValid():this.isValid();return!e&&this.renderedInputControlElement&&(this.renderedInputControlElement.classList.add(this.hostConfig.makeCssClassName("ac-input-validation-failed")),this.showValidationErrorMessage()),e},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),[this]},t.prototype.render=function(){var t=e.prototype.render.call(this);return this.resetDirtyState(),t},Object.defineProperty(t.prototype,"isInteractive",{get:function(){return!0},enumerable:!1,configurable:!0}),t.labelProperty=new y.StringProperty(y.Versions.v1_3,"label",!0),t.isRequiredProperty=new y.BoolProperty(y.Versions.v1_3,"isRequired",!1),t.errorMessageProperty=new y.StringProperty(y.Versions.v1_3,"errorMessage",!0),s([(0,y.property)(t.labelProperty)],t.prototype,"label",void 0),s([(0,y.property)(t.isRequiredProperty)],t.prototype,"isRequired",void 0),s([(0,y.property)(t.errorMessageProperty)],t.prototype,"errorMessage",void 0),t}(C);t.Input=W;var q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isMultiline=!1,t.style=p.InputTextStyle.Text,t}return o(t,e),t.prototype.setupInput=function(e){var t=this;e.style.flex="1 1 auto",e.tabIndex=this.isDesignMode()?-1:0,this.placeholder&&(e.placeholder=this.placeholder,e.setAttribute("aria-label",this.placeholder)),this.defaultValue&&(e.value=this.defaultValue),this.maxLength&&this.maxLength>0&&(e.maxLength=this.maxLength),e.oninput=function(){t.valueChanged()},e.onkeypress=function(e){e.ctrlKey&&"Enter"===e.code&&t.inlineAction&&t.inlineAction.isEffectivelyEnabled()&&t.inlineAction.execute()}},t.prototype.internalRender=function(){var e;return this.isMultiline&&this.style!==p.InputTextStyle.Password?((e=document.createElement("textarea")).className=this.hostConfig.makeCssClassName("ac-input","ac-textInput","ac-multiline"),"stretch"===this.height&&(e.style.height="initial")):((e=document.createElement("input")).className=this.hostConfig.makeCssClassName("ac-input","ac-textInput"),e.type=p.InputTextStyle[this.style].toLowerCase()),this.setupInput(e),e},t.prototype.overrideInternalRender=function(){var t=this,n=e.prototype.overrideInternalRender.call(this);if(this.inlineAction){var r=document.createElement("button");if(r.className=this.hostConfig.makeCssClassName(this.inlineAction.isEffectivelyEnabled()?"ac-inlineActionButton":"ac-inlineActionButton-disabled"),r.onclick=function(e){t.inlineAction&&t.inlineAction.isEffectivelyEnabled()&&(e.preventDefault(),e.cancelBubble=!0,t.inlineAction.execute())},this.inlineAction.iconUrl){r.classList.add("iconOnly");var i=document.createElement("img");i.style.height="100%",i.setAttribute("role","presentation"),i.style.display="none",i.onload=function(){i.style.removeProperty("display")},i.onerror=function(){r.removeChild(i),r.classList.remove("iconOnly"),r.classList.add("textOnly"),r.textContent=t.inlineAction&&t.inlineAction.title?t.inlineAction.title:m.Strings.defaults.inlineActionTitle()},i.src=this.inlineAction.iconUrl,r.appendChild(i),r.title=this.inlineAction.title?this.inlineAction.title:m.Strings.defaults.inlineActionTitle()}else r.classList.add("textOnly"),r.textContent=this.inlineAction.title?this.inlineAction.title:m.Strings.defaults.inlineActionTitle();this.inlineAction.setupElementForAccessibility(r,!0),r.style.marginLeft="8px",this.inputControlContainerElement.appendChild(r)}return n},t.prototype.getJsonTypeName=function(){return"Input.Text"},t.prototype.getAllActions=function(){var t=e.prototype.getAllActions.call(this);return this.inlineAction&&t.push(this.inlineAction),t},t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);return!n&&this.inlineAction&&(n=this.inlineAction.getActionById(t)),n},t.prototype.isSet=function(){return!!this.value},t.prototype.isValid=function(){return!this.value||(!this.regex||new RegExp(this.regex,"g").test(this.value))},Object.defineProperty(t.prototype,"value",{get:function(){return this.renderedInputControlElement?(this.isMultiline,this.renderedInputControlElement.value):void 0},enumerable:!1,configurable:!0}),t.valueProperty=new y.StringProperty(y.Versions.v1_0,"value"),t.maxLengthProperty=new y.NumProperty(y.Versions.v1_0,"maxLength"),t.isMultilineProperty=new y.BoolProperty(y.Versions.v1_0,"isMultiline",!1),t.placeholderProperty=new y.StringProperty(y.Versions.v1_0,"placeholder"),t.styleProperty=new y.EnumProperty(y.Versions.v1_0,"style",p.InputTextStyle,p.InputTextStyle.Text,[{value:p.InputTextStyle.Text},{value:p.InputTextStyle.Tel},{value:p.InputTextStyle.Url},{value:p.InputTextStyle.Email},{value:p.InputTextStyle.Password,targetVersion:y.Versions.v1_5}]),t.inlineActionProperty=new S(y.Versions.v1_0,"inlineAction",["Action.ShowCard"]),t.regexProperty=new y.StringProperty(y.Versions.v1_3,"regex",!0),s([(0,y.property)(t.valueProperty)],t.prototype,"defaultValue",void 0),s([(0,y.property)(t.maxLengthProperty)],t.prototype,"maxLength",void 0),s([(0,y.property)(t.isMultilineProperty)],t.prototype,"isMultiline",void 0),s([(0,y.property)(t.placeholderProperty)],t.prototype,"placeholder",void 0),s([(0,y.property)(t.styleProperty)],t.prototype,"style",void 0),s([(0,y.property)(t.inlineActionProperty)],t.prototype,"inlineAction",void 0),s([(0,y.property)(t.regexProperty)],t.prototype,"regex",void 0),t}(W);t.TextInput=q;var G=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.valueOn="true",t.valueOff="false",t.wrap=!1,t}return o(t,e),t.prototype.updateInputControlAriaLabelledBy=function(){if(this._checkboxInputElement){var e=this.getAllLabelIds().join(" ");this._checkboxInputLabelElement&&this._checkboxInputLabelElement.id&&(e+=" "+this._checkboxInputLabelElement.id),e?this._checkboxInputElement.setAttribute("aria-labelledby",e):this._checkboxInputElement.removeAttribute("aria-labelledby")}},t.prototype.internalRender=function(){var e=this,t=document.createElement("div");if(t.className=this.hostConfig.makeCssClassName("ac-input","ac-toggleInput"),t.style.width="100%",t.style.display="flex",t.style.alignItems="center",this._checkboxInputElement=document.createElement("input"),this._checkboxInputElement.id=c.generateUniqueId(),this._checkboxInputElement.type="checkbox",this._checkboxInputElement.style.display="inline-block",this._checkboxInputElement.style.verticalAlign="middle",this._checkboxInputElement.style.margin="0",this._checkboxInputElement.style.flex="0 0 auto",this.title&&this._checkboxInputElement.setAttribute("aria-label",this.title),this.isRequired&&this._checkboxInputElement.setAttribute("aria-required","true"),this._checkboxInputElement.tabIndex=this.isDesignMode()?-1:0,this.defaultValue===this.valueOn&&(this._checkboxInputElement.checked=!0),this._oldCheckboxValue=this._checkboxInputElement.checked,this._checkboxInputElement.onchange=function(){e.valueChanged()},c.appendChild(t,this._checkboxInputElement),this.title||this.isDesignMode()){var n=new w;if(n.setParent(this),n.forElementId=this._checkboxInputElement.id,n.hostConfig=this.hostConfig,n.text=this.title?this.title:this.getJsonTypeName(),n.useMarkdown=u.GlobalSettings.useMarkdownInRadioButtonAndCheckbox,n.wrap=this.wrap,this._checkboxInputLabelElement=n.render(),this._checkboxInputLabelElement){this._checkboxInputLabelElement.id=c.generateUniqueId(),this._checkboxInputLabelElement.style.display="inline-block",this._checkboxInputLabelElement.style.flex="1 1 auto",this._checkboxInputLabelElement.style.marginLeft="6px",this._checkboxInputLabelElement.style.verticalAlign="middle";var r=document.createElement("div");r.style.width="6px",c.appendChild(t,r),c.appendChild(t,this._checkboxInputLabelElement)}}return t},Object.defineProperty(t.prototype,"isNullable",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return"Input.Toggle"},t.prototype.focus=function(){this._checkboxInputElement&&this._checkboxInputElement.focus()},t.prototype.isSet=function(){return this.isRequired?this.value===this.valueOn:!!this.value},t.prototype.isDirty=function(){return!!this._checkboxInputElement&&this._checkboxInputElement.checked!==this._oldCheckboxValue},Object.defineProperty(t.prototype,"value",{get:function(){return this._checkboxInputElement?this._checkboxInputElement.checked?this.valueOn:this.valueOff:void 0},enumerable:!1,configurable:!0}),t.valueProperty=new y.StringProperty(y.Versions.v1_0,"value"),t.titleProperty=new y.StringProperty(y.Versions.v1_0,"title"),t.valueOnProperty=new y.StringProperty(y.Versions.v1_0,"valueOn",!0,void 0,"true",(function(e){return"true"})),t.valueOffProperty=new y.StringProperty(y.Versions.v1_0,"valueOff",!0,void 0,"false",(function(e){return"false"})),t.wrapProperty=new y.BoolProperty(y.Versions.v1_2,"wrap",!1),s([(0,y.property)(t.valueProperty)],t.prototype,"defaultValue",void 0),s([(0,y.property)(t.titleProperty)],t.prototype,"title",void 0),s([(0,y.property)(t.valueOnProperty)],t.prototype,"valueOn",void 0),s([(0,y.property)(t.valueOffProperty)],t.prototype,"valueOff",void 0),s([(0,y.property)(t.wrapProperty)],t.prototype,"wrap",void 0),t}(W);t.ToggleInput=G;var J=function(e){function t(t,n){var r=e.call(this)||this;return r.title=t,r.value=n,r}return o(t,e),t.prototype.getSchemaKey=function(){return"Choice"},t.titleProperty=new y.StringProperty(y.Versions.v1_0,"title"),t.valueProperty=new y.StringProperty(y.Versions.v1_0,"value"),s([(0,y.property)(t.titleProperty)],t.prototype,"title",void 0),s([(0,y.property)(t.valueProperty)],t.prototype,"value",void 0),t}(y.SerializableObject);t.Choice=J;var $=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isMultiSelect=!1,t.wrap=!1,t.choices=[],t}return o(t,e),Object.defineProperty(t.prototype,"isCompact",{get:function(){return!this.style||"compact"===this.style},set:function(e){this.style=e?void 0:"expanded"},enumerable:!1,configurable:!0}),t.getUniqueCategoryName=function(){var e="__ac-category"+t._uniqueCategoryCounter;return t._uniqueCategoryCounter++,e},t.prototype.internalApplyAriaCurrent=function(){if(this._selectElement){var e=this._selectElement.options;if(e)for(var t=0,n=Array.from(e);t<n.length;t++){var r=n[t];r.selected?r.setAttribute("aria-current","true"):r.removeAttribute("aria-current")}}},t.prototype.renderCompoundInput=function(e,t,n){var r=this,i=document.createElement("div");i.className=this.hostConfig.makeCssClassName("ac-input",e),i.style.width="100%",i.tabIndex=this.isDesignMode()?-1:0,this._toggleInputs=[],this._labels=[];for(var o=0,s=this.choices;o<s.length;o++){var a=s[o],l=document.createElement("input");l.id=c.generateUniqueId(),l.type=t,l.style.margin="0",l.style.display="inline-block",l.style.verticalAlign="middle",l.style.flex="0 0 auto",l.name=this.id?this.id:this._uniqueCategoryName,this.isRequired&&l.setAttribute("aria-required","true"),l.tabIndex=this.isDesignMode()?-1:0,a.value&&(l.value=a.value),a.title&&l.setAttribute("aria-label",a.title),n&&a.value&&n.indexOf(a.value)>=0&&(l.checked=!0),l.onchange=function(){r.valueChanged()},this._toggleInputs.push(l);var p=document.createElement("div");p.style.display="flex",p.style.alignItems="center",c.appendChild(p,l);var h=new w;h.setParent(this),h.forElementId=l.id,h.hostConfig=this.hostConfig,h.text=a.title?a.title:"Choice "+this._toggleInputs.length,h.useMarkdown=u.GlobalSettings.useMarkdownInRadioButtonAndCheckbox,h.wrap=this.wrap;var d=h.render();if(this._labels.push(d),d){d.id=c.generateUniqueId(),d.style.display="inline-block",d.style.flex="1 1 auto",d.style.marginLeft="6px",d.style.verticalAlign="middle";var f=document.createElement("div");f.style.width="6px",c.appendChild(p,f),c.appendChild(p,d)}c.appendChild(i,p)}return i},t.prototype.updateInputControlAriaLabelledBy=function(){if((this.isMultiSelect||"expanded"===this.style)&&this._toggleInputs&&this._labels)for(var t=this.getAllLabelIds(),n=0;n<this._toggleInputs.length;n++){var r=t.join(" "),i=this._labels[n];i&&i.id&&(r+=" "+i.id),r?this._toggleInputs[n].setAttribute("aria-labelledby",r):this._toggleInputs[n].removeAttribute("aria-labelledby")}else e.prototype.updateInputControlAriaLabelledBy.call(this)},t.prototype.internalRender=function(){var e=this;if(this._uniqueCategoryName=t.getUniqueCategoryName(),this.isMultiSelect)return this.renderCompoundInput("ac-choiceSetInput-multiSelect","checkbox",this.defaultValue?this.defaultValue.split(this.hostConfig.choiceSetInputValueSeparator):void 0);if("expanded"===this.style)return this.renderCompoundInput("ac-choiceSetInput-expanded","radio",this.defaultValue?[this.defaultValue]:void 0);if("filtered"===this.style){var n=document.createElement("div");n.style.width="100%",this._textInput=document.createElement("input"),this._textInput.className=this.hostConfig.makeCssClassName("ac-input","ac-multichoiceInput","ac-choiceSetInput-filtered"),this._textInput.type="text",this._textInput.style.width="100%",this._textInput.oninput=function(){e.valueChanged(),e._textInput&&(e.value?(e._textInput.removeAttribute("placeholder"),e._textInput.removeAttribute("aria-label")):e.placeholder&&(e._textInput.placeholder=e.placeholder,e._textInput.setAttribute("aria-label",e.placeholder)))},this.defaultValue&&(this._textInput.value=this.defaultValue),this.placeholder&&!this._textInput.value&&(this._textInput.placeholder=this.placeholder,this._textInput.setAttribute("aria-label",this.placeholder)),this._textInput.tabIndex=this.isDesignMode()?-1:0;var r=document.createElement("datalist");r.id=c.generateUniqueId();for(var i=0,o=this.choices;i<o.length;i++){var s=o[i],a=document.createElement("option");s.title&&(a.value=s.title,a.setAttribute("aria-label",s.title)),a.tabIndex=this.isDesignMode()?-1:0,r.appendChild(a)}return this._textInput.setAttribute("list",r.id),n.append(this._textInput,r),n}this._selectElement=document.createElement("select"),this._selectElement.className=this.hostConfig.makeCssClassName("ac-input","ac-multichoiceInput","ac-choiceSetInput-compact"),this._selectElement.style.width="100%",this._selectElement.tabIndex=this.isDesignMode()?-1:0;var l=document.createElement("option");l.selected=!0,l.disabled=!0,l.hidden=!0,l.value="",this.placeholder&&(l.text=this.placeholder),c.appendChild(this._selectElement,l);for(var p=0,u=this.choices;p<u.length;p++){s=u[p];(a=document.createElement("option")).value=s.value,s.title&&(a.text=s.title,a.setAttribute("aria-label",s.title)),a.tabIndex=this.isDesignMode()?-1:0,s.value===this.defaultValue&&(a.selected=!0),c.appendChild(this._selectElement,a)}return this._selectElement.onchange=function(){e.internalApplyAriaCurrent(),e.valueChanged()},this.internalApplyAriaCurrent(),this._selectElement},t.prototype.getJsonTypeName=function(){return"Input.ChoiceSet"},t.prototype.focus=function(){this._toggleInputs&&(this.isMultiSelect||"expanded"===this.style)?this._toggleInputs.length>0&&this._toggleInputs[0].focus():this._textInput?this._textInput.focus():e.prototype.focus.call(this)},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),0===this.choices.length&&t.addFailure(this,p.ValidationEvent.CollectionCantBeEmpty,m.Strings.errors.choiceSetMustHaveAtLeastOneChoice());for(var n=0,r=this.choices;n<r.length;n++){var i=r[n];i.title&&i.value||t.addFailure(this,p.ValidationEvent.PropertyCantBeNull,m.Strings.errors.choiceSetChoicesMustHaveTitleAndValue())}},t.prototype.isSet=function(){return!!this.value},t.prototype.isValid=function(){if(this._textInput){if(""===this.value||this.value===this.placeholder)return!0;for(var t=0,n=this.choices;t<n.length;t++){var r=n[t];if(this.value===r.value)return!0}return!1}return e.prototype.isValid.call(this)},Object.defineProperty(t.prototype,"value",{get:function(){if(this.isMultiSelect){if(!this._toggleInputs||0===this._toggleInputs.length)return;for(var e="",t=0,n=this._toggleInputs;t<n.length;t++){(l=n[t]).checked&&(""!==e&&(e+=this.hostConfig.choiceSetInputValueSeparator),e+=l.value)}return e||void 0}if(this._selectElement)return this._selectElement.selectedIndex>0?this._selectElement.value:void 0;if(this._textInput){for(var r=0,i=this.choices;r<i.length;r++){var o=i[r];if(o.title&&this._textInput.value===o.title)return o.value}return this._textInput.value}if(this._toggleInputs&&this._toggleInputs.length>0)for(var s=0,a=this._toggleInputs;s<a.length;s++){var l;if((l=a[s]).checked)return l.value}},enumerable:!1,configurable:!0}),t.valueProperty=new y.StringProperty(y.Versions.v1_0,"value"),t.choicesProperty=new y.SerializableObjectCollectionProperty(y.Versions.v1_0,"choices",J),t.styleProperty=new y.ValueSetProperty(y.Versions.v1_0,"style",[{value:"compact"},{value:"expanded"},{value:"filtered",targetVersion:y.Versions.v1_5}],"compact"),t.isMultiSelectProperty=new y.BoolProperty(y.Versions.v1_0,"isMultiSelect",!1),t.placeholderProperty=new y.StringProperty(y.Versions.v1_0,"placeholder"),t.wrapProperty=new y.BoolProperty(y.Versions.v1_2,"wrap",!1),t._uniqueCategoryCounter=0,s([(0,y.property)(t.valueProperty)],t.prototype,"defaultValue",void 0),s([(0,y.property)(t.styleProperty)],t.prototype,"style",void 0),s([(0,y.property)(t.isMultiSelectProperty)],t.prototype,"isMultiSelect",void 0),s([(0,y.property)(t.placeholderProperty)],t.prototype,"placeholder",void 0),s([(0,y.property)(t.wrapProperty)],t.prototype,"wrap",void 0),s([(0,y.property)(t.choicesProperty)],t.prototype,"choices",void 0),t}(W);t.ChoiceSetInput=$;var Y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.internalRender=function(){var e=this;return this._numberInputElement=document.createElement("input"),this._numberInputElement.setAttribute("type","number"),void 0!==this.min&&this._numberInputElement.setAttribute("min",this.min.toString()),void 0!==this.max&&this._numberInputElement.setAttribute("max",this.max.toString()),this._numberInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-numberInput"),this._numberInputElement.style.width="100%",this._numberInputElement.tabIndex=this.isDesignMode()?-1:0,void 0!==this.defaultValue&&(this._numberInputElement.valueAsNumber=this.defaultValue),this.placeholder&&(this._numberInputElement.placeholder=this.placeholder,this._numberInputElement.setAttribute("aria-label",this.placeholder)),this._numberInputElement.oninput=function(){e.valueChanged()},this._numberInputElement},t.prototype.getJsonTypeName=function(){return"Input.Number"},t.prototype.isSet=function(){return void 0!==this.value&&!isNaN(this.value)},t.prototype.isValid=function(){if(void 0===this.value)return!this.isRequired;var e=!0;return void 0!==this.min&&(e=e&&this.value>=this.min),void 0!==this.max&&(e=e&&this.value<=this.max),e},Object.defineProperty(t.prototype,"value",{get:function(){return this._numberInputElement?this._numberInputElement.valueAsNumber:void 0},set:function(e){e&&this._numberInputElement&&(this._numberInputElement.value=e.toString())},enumerable:!1,configurable:!0}),t.valueProperty=new y.NumProperty(y.Versions.v1_0,"value"),t.placeholderProperty=new y.StringProperty(y.Versions.v1_0,"placeholder"),t.minProperty=new y.NumProperty(y.Versions.v1_0,"min"),t.maxProperty=new y.NumProperty(y.Versions.v1_0,"max"),s([(0,y.property)(t.valueProperty)],t.prototype,"defaultValue",void 0),s([(0,y.property)(t.minProperty)],t.prototype,"min",void 0),s([(0,y.property)(t.maxProperty)],t.prototype,"max",void 0),s([(0,y.property)(t.placeholderProperty)],t.prototype,"placeholder",void 0),t}(W);t.NumberInput=Y;var Z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.internalRender=function(){var e=this;return this._dateInputElement=document.createElement("input"),this._dateInputElement.setAttribute("type","date"),this.min&&this._dateInputElement.setAttribute("min",this.min),this.max&&this._dateInputElement.setAttribute("max",this.max),this.placeholder&&(this._dateInputElement.placeholder=this.placeholder,this._dateInputElement.setAttribute("aria-label",this.placeholder)),this._dateInputElement.tabIndex=this.isDesignMode()?-1:0,this._dateInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-dateInput"),this._dateInputElement.style.width="100%",this._dateInputElement.oninput=function(){e.valueChanged()},this.defaultValue&&(this._dateInputElement.value=this.defaultValue),this._dateInputElement},t.prototype.getJsonTypeName=function(){return"Input.Date"},t.prototype.isSet=function(){return!!this.value},t.prototype.isValid=function(){if(!this.value)return!this.isRequired;var e=new Date(this.value),t=!0;if(this.min){var n=new Date(this.min);t=t&&e>=n}if(this.max){var r=new Date(this.max);t=t&&e<=r}return t},Object.defineProperty(t.prototype,"value",{get:function(){return this._dateInputElement?this._dateInputElement.value:void 0},enumerable:!1,configurable:!0}),t.valueProperty=new y.StringProperty(y.Versions.v1_0,"value"),t.placeholderProperty=new y.StringProperty(y.Versions.v1_0,"placeholder"),t.minProperty=new y.StringProperty(y.Versions.v1_0,"min"),t.maxProperty=new y.StringProperty(y.Versions.v1_0,"max"),s([(0,y.property)(t.valueProperty)],t.prototype,"defaultValue",void 0),s([(0,y.property)(t.minProperty)],t.prototype,"min",void 0),s([(0,y.property)(t.maxProperty)],t.prototype,"max",void 0),s([(0,y.property)(t.placeholderProperty)],t.prototype,"placeholder",void 0),t}(W);t.DateInput=Z;var K=function(e){function t(t,n){var r=e.call(this,t,n,(function(e,t,n,r){var i=n[t.name];if("string"==typeof i&&i&&/^[0-9]{2}:[0-9]{2}$/.test(i))return i}),(function(e,t,n,r,i){i.serializeValue(n,t.name,r)}))||this;return r.targetVersion=t,r.name=n,r}return o(t,e),t}(y.CustomProperty);t.TimeProperty=K;var X=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.convertTimeStringToDate=function(e){return new Date("1973-09-04T"+e+":00Z")},t.prototype.internalRender=function(){var e=this;return this._timeInputElement=document.createElement("input"),this._timeInputElement.setAttribute("type","time"),this.min&&this._timeInputElement.setAttribute("min",this.min),this.max&&this._timeInputElement.setAttribute("max",this.max),this._timeInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-timeInput"),this._timeInputElement.style.width="100%",this._timeInputElement.oninput=function(){e.valueChanged()},this.placeholder&&(this._timeInputElement.placeholder=this.placeholder,this._timeInputElement.setAttribute("aria-label",this.placeholder)),this._timeInputElement.tabIndex=this.isDesignMode()?-1:0,this.defaultValue&&(this._timeInputElement.value=this.defaultValue),this._timeInputElement},t.prototype.getJsonTypeName=function(){return"Input.Time"},t.prototype.isSet=function(){return!!this.value},t.prototype.isValid=function(){if(!this.value)return!this.isRequired;var e=t.convertTimeStringToDate(this.value),n=!0;if(this.min){var r=t.convertTimeStringToDate(this.min);n=n&&e>=r}if(this.max){var i=t.convertTimeStringToDate(this.max);n=n&&e<=i}return n},Object.defineProperty(t.prototype,"value",{get:function(){return this._timeInputElement?this._timeInputElement.value:void 0},enumerable:!1,configurable:!0}),t.valueProperty=new K(y.Versions.v1_0,"value"),t.placeholderProperty=new y.StringProperty(y.Versions.v1_0,"placeholder"),t.minProperty=new K(y.Versions.v1_0,"min"),t.maxProperty=new K(y.Versions.v1_0,"max"),s([(0,y.property)(t.valueProperty)],t.prototype,"defaultValue",void 0),s([(0,y.property)(t.minProperty)],t.prototype,"min",void 0),s([(0,y.property)(t.maxProperty)],t.prototype,"max",void 0),s([(0,y.property)(t.placeholderProperty)],t.prototype,"placeholder",void 0),t}(W);t.TimeInput=X;var Q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.style=p.ActionStyle.Default,t.mode=p.ActionMode.Primary,t._state=0,t._isFocusable=!0,t}return o(t,e),t.prototype.renderButtonContent=function(){if(this.renderedElement){var e=this.hostConfig,t=document.createElement("div");if(t.style.overflow="hidden",t.style.textOverflow="ellipsis",e.actions.iconPlacement===p.ActionIconPlacement.AboveTitle||e.actions.allowTitleToWrap||(t.style.whiteSpace="nowrap"),this.title&&(t.innerText=this.title),this.iconUrl){var n=document.createElement("img");n.src=this.iconUrl,n.style.width=e.actions.iconSize+"px",n.style.height=e.actions.iconSize+"px",n.style.flex="0 0 auto",e.actions.iconPlacement===p.ActionIconPlacement.AboveTitle?(this.renderedElement.classList.add("iconAbove"),this.renderedElement.style.flexDirection="column",this.title&&(n.style.marginBottom="6px")):(this.renderedElement.classList.add("iconLeft"),n.style.maxHeight="100%",this.title&&(n.style.marginRight="6px")),this.renderedElement.appendChild(n),this.renderedElement.appendChild(t)}else this.renderedElement.classList.add("noIcon"),this.renderedElement.appendChild(t)}},t.prototype.getParentContainer=function(){return this.parent instanceof ge?this.parent:this.parent?this.parent.getParentContainer():void 0},t.prototype.isDesignMode=function(){var e=this.getRootObject();return e instanceof C&&e.isDesignMode()},t.prototype.updateCssClasses=function(){var e,t;if(this.parent&&this.renderedElement){var n=this.parent.hostConfig;this.renderedElement.className=n.makeCssClassName(this.isEffectivelyEnabled()?"ac-pushButton":"ac-pushButton-disabled");var r=this.getParentContainer();if(r){var i=r.getEffectiveStyle();i&&this.renderedElement.classList.add("style-"+i)}switch(this.renderedElement.tabIndex=!this.isDesignMode()&&this.isFocusable?0:-1,this._state){case 0:break;case 1:this.renderedElement.classList.add(n.makeCssClassName("expanded"));break;case 2:this.renderedElement.classList.add(n.makeCssClassName("subdued"))}this.style&&this.isEffectivelyEnabled()&&(this.style===p.ActionStyle.Positive?(e=this.renderedElement.classList).add.apply(e,n.makeCssClassNames("primary","style-positive")):(t=this.renderedElement.classList).add.apply(t,n.makeCssClassNames("style-"+this.style.toLowerCase())))}},t.prototype.getDefaultSerializationContext=function(){return new Oe},t.prototype.internalGetReferencedInputs=function(){return{}},t.prototype.internalPrepareForExecution=function(e){},t.prototype.internalValidateInputs=function(e){var t=[];if(e)for(var n=0,r=Object.keys(e);n<r.length;n++){var i=e[r[n]];i.validateValue()||t.push(i)}return t},t.prototype.shouldSerialize=function(e){return void 0!==e.actionRegistry.findByName(this.getJsonTypeName())},t.prototype.raiseExecuteActionEvent=function(){var e,t,n;this.onExecute&&this.onExecute(this),t=(e=this).parent?e.parent.getRootElement():void 0,n=t&&t.onExecuteAction?t.onExecuteAction:Ie.onExecuteAction,e.prepareForExecution()&&n&&n(e)},t.prototype.internalAfterExecute=function(){var e=this.getRootObject();e instanceof C&&e.updateActionsEnabledState()},t.prototype.getHref=function(){return""},t.prototype.getAriaRole=function(){return"button"},t.prototype.setupElementForAccessibility=function(e,t){if(void 0===t&&(t=!1),e.tabIndex=this.isEffectivelyEnabled()&&!this.isDesignMode()?0:-1,e.setAttribute("role",this.getAriaRole()),e instanceof HTMLButtonElement&&(e.disabled=!this.isEffectivelyEnabled()),this.isEffectivelyEnabled()?(e.removeAttribute("aria-disabled"),e.classList.add(this.hostConfig.makeCssClassName("ac-selectable"))):e.setAttribute("aria-disabled","true"),this.title?(e.setAttribute("aria-label",this.title),e.title=this.title):(e.removeAttribute("aria-label"),e.removeAttribute("title")),this.tooltip){var n=t?this.title?"aria-description":"aria-label":"aria-description";e.setAttribute(n,this.tooltip),e.title=this.tooltip}},t.prototype.parse=function(t,n){return e.prototype.parse.call(this,t,n||new Oe)},t.prototype.render=function(){var e=this,t=document.createElement("button");t.type="button",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center",t.onclick=function(t){e.isEffectivelyEnabled()&&(t.preventDefault(),t.cancelBubble=!0,e.execute())},this._renderedElement=t,this.renderButtonContent(),this.updateCssClasses(),this.setupElementForAccessibility(t)},t.prototype.execute=function(){this._actionCollection&&this._actionCollection.actionExecuted(this),this.raiseExecuteActionEvent(),this.internalAfterExecute()},t.prototype.prepareForExecution=function(){var e=this.getReferencedInputs(),t=this.internalValidateInputs(e);return t.length>0?(t[0].focus(),!1):(this.internalPrepareForExecution(e),!0)},t.prototype.remove=function(){return!!this._actionCollection&&this._actionCollection.removeAction(this)},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),[]},t.prototype.getAllActions=function(){return[this]},t.prototype.getResourceInformation=function(){return this.iconUrl?[{url:this.iconUrl,mimeType:"image"}]:[]},t.prototype.getActionById=function(e){return this.id===e?this:void 0},t.prototype.getReferencedInputs=function(){return this.internalGetReferencedInputs()},t.prototype.validateInputs=function(){return this.internalValidateInputs(this.getReferencedInputs())},t.prototype.updateEnabledState=function(){},t.prototype.isEffectivelyEnabled=function(){return this.isEnabled},Object.defineProperty(t.prototype,"isPrimary",{get:function(){return this.style===p.ActionStyle.Positive},set:function(e){e?this.style=p.ActionStyle.Positive:this.style===p.ActionStyle.Positive&&(this.style=p.ActionStyle.Default)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hostConfig",{get:function(){return this.parent?this.parent.hostConfig:h.defaultHostConfig},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},set:function(e){this._state!==e&&(this._state=e,this.updateCssClasses())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFocusable",{get:function(){return this._isFocusable},set:function(e){this._isFocusable!==e&&(this._isFocusable=e,this.updateCssClasses())},enumerable:!1,configurable:!0}),t.titleProperty=new y.StringProperty(y.Versions.v1_0,"title"),t.iconUrlProperty=new y.StringProperty(y.Versions.v1_1,"iconUrl"),t.styleProperty=new y.ValueSetProperty(y.Versions.v1_2,"style",[{value:p.ActionStyle.Default},{value:p.ActionStyle.Positive},{value:p.ActionStyle.Destructive}],p.ActionStyle.Default),t.modeProperty=new y.ValueSetProperty(y.Versions.v1_5,"mode",[{value:p.ActionMode.Primary},{value:p.ActionMode.Secondary}],p.ActionMode.Primary),t.tooltipProperty=new y.StringProperty(y.Versions.v1_5,"tooltip"),t.isEnabledProperty=new y.BoolProperty(y.Versions.v1_5,"isEnabled",!0),s([(0,y.property)(t.titleProperty)],t.prototype,"title",void 0),s([(0,y.property)(t.iconUrlProperty)],t.prototype,"iconUrl",void 0),s([(0,y.property)(t.styleProperty)],t.prototype,"style",void 0),s([(0,y.property)(t.modeProperty)],t.prototype,"mode",void 0),s([(0,y.property)(t.tooltipProperty)],t.prototype,"tooltip",void 0),s([(0,y.property)(t.isEnabledProperty)],t.prototype,"isEnabled",void 0),t}(f.CardObject);t.Action=Q;var ee=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.disabledUnlessAssociatedInputsChange=!1,t._isPrepared=!1,t._areReferencedInputsDirty=!1,t}return o(t,e),t.prototype.internalGetReferencedInputs=function(){var e={};if("none"!==this.associatedInputs){for(var t=this.parent,n=[];t;)n.push.apply(n,t.getAllInputs(!1)),t=t.parent;for(var r=0,i=n;r<i.length;r++){var o=i[r];o.id&&(e[o.id]=o)}}return e},t.prototype.internalPrepareForExecution=function(e){if(this._originalData?this._processedData=JSON.parse(JSON.stringify(this._originalData)):this._processedData={},this._processedData&&e)for(var t=0,n=Object.keys(e);t<n.length;t++){var r=e[n[t]];r.id&&r.isSet()&&(this._processedData[r.id]="string"==typeof r.value?r.value:r.value.toString())}this._isPrepared=!0},t.prototype.internalAfterExecute=function(){u.GlobalSettings.resetInputsDirtyStateAfterActionExecution&&this.resetReferencedInputsDirtyState()},t.prototype.resetReferencedInputsDirtyState=function(){var e=this.getReferencedInputs();if(this._areReferencedInputsDirty=!1,e)for(var t=0,n=Object.keys(e);t<n.length;t++){e[n[t]].resetDirtyState()}},t.prototype.updateEnabledState=function(){this._areReferencedInputsDirty=!1;var e=this.getReferencedInputs();if(e)for(var t=0,n=Object.keys(e);t<n.length;t++){if(e[n[t]].isDirty()){this._areReferencedInputsDirty=!0;break}}this.updateCssClasses(),this._renderedElement&&this.setupElementForAccessibility(this._renderedElement)},t.prototype.isEffectivelyEnabled=function(){var t=e.prototype.isEffectivelyEnabled.call(this);return this.disabledUnlessAssociatedInputsChange?t&&this._areReferencedInputsDirty:t},Object.defineProperty(t.prototype,"data",{get:function(){return this._isPrepared?this._processedData:this._originalData},set:function(e){this._originalData=e,this._isPrepared=!1},enumerable:!1,configurable:!0}),t.dataProperty=new y.PropertyDefinition(y.Versions.v1_0,"data"),t.associatedInputsProperty=new y.CustomProperty(y.Versions.v1_3,"associatedInputs",(function(e,t,n,r){var i=n[t.name];if(void 0!==i&&"string"==typeof i)return"none"===i.toLowerCase()?"none":"auto"}),(function(e,t,n,r,i){i.serializeValue(n,t.name,r)})),t.disabledUnlessAssociatedInputsChangeProperty=new y.BoolProperty(y.Versions.v1_6,"disabledUnlessAssociatedInputsChange",!1),s([(0,y.property)(t.dataProperty)],t.prototype,"_originalData",void 0),s([(0,y.property)(t.associatedInputsProperty)],t.prototype,"associatedInputs",void 0),s([(0,y.property)(t.disabledUnlessAssociatedInputsChangeProperty)],t.prototype,"disabledUnlessAssociatedInputsChange",void 0),t}(Q);t.SubmitActionBase=ee;var te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.JsonTypeName="Action.Submit",t}(ee);t.SubmitAction=te;var ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.JsonTypeName="Action.Execute",t.verbProperty=new y.StringProperty(y.Versions.v1_4,"verb"),s([(0,y.property)(t.verbProperty)],t.prototype,"verb",void 0),t}(ee);t.ExecuteAction=ne;var re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.getAriaRole=function(){return"link"},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this.url||t.addFailure(this,p.ValidationEvent.PropertyCantBeNull,m.Strings.errors.propertyMustBeSet("url"))},t.prototype.getHref=function(){return this.url},t.urlProperty=new y.StringProperty(y.Versions.v1_0,"url"),t.JsonTypeName="Action.OpenUrl",s([(0,y.property)(t.urlProperty)],t.prototype,"url",void 0),t}(Q);t.OpenUrlAction=re;var ie=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.targetElements={},t}return o(t,e),t.prototype.updateAriaControlsAttribute=function(){if(this.targetElements){var e=Object.keys(this.targetElements);this._renderedElement&&(e.length>0?this._renderedElement.setAttribute("aria-controls",e.join(" ")):this._renderedElement.removeAttribute("aria-controls"))}},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this.targetElements||t.addFailure(this,p.ValidationEvent.PropertyCantBeNull,m.Strings.errors.propertyMustBeSet("targetElements"))},t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.render=function(){e.prototype.render.call(this),this.updateAriaControlsAttribute()},t.prototype.execute=function(){if(e.prototype.execute.call(this),this.parent)for(var t=0,n=Object.keys(this.targetElements);t<n.length;t++){var r=n[t],i=this.parent.getRootElement().getElementById(r);i&&("boolean"==typeof this.targetElements[r]?i.isVisible=this.targetElements[r]:i.isVisible=!i.isVisible)}},t.prototype.addTargetElement=function(e,t){void 0===t&&(t=void 0),this.targetElements[e]=t,this.updateAriaControlsAttribute()},t.prototype.removeTargetElement=function(e){delete this.targetElements[e],this.updateAriaControlsAttribute()},t.targetElementsProperty=new y.CustomProperty(y.Versions.v1_2,"targetElements",(function(e,t,n,i){var o={};if(Array.isArray(n[t.name]))for(var s=0,a=n[t.name];s<a.length;s++){var l=a[s];if("string"==typeof l)o[l]=void 0;else if("object"===r(l)){var p=l.elementId;"string"==typeof p&&(o[p]=c.parseBool(l.isVisible))}}return o}),(function(e,t,n,r,i){for(var o=[],s=0,a=Object.keys(r);s<a.length;s++){var l=a[s];"boolean"==typeof r[l]?o.push({elementId:l,isVisible:r[l]}):o.push(l)}i.serializeArray(n,t.name,o)}),{},(function(e){return{}})),t.JsonTypeName="Action.ToggleVisibility",s([(0,y.property)(t.targetElementsProperty)],t.prototype,"targetElements",void 0),t}(Q);t.ToggleVisibilityAction=ie;var oe=function(e){function t(t,n){var r=e.call(this,t,n,void 0,(function(){return new u.StringWithSubstitutions}))||this;return r.targetVersion=t,r.name=n,r}return o(t,e),t.prototype.parse=function(e,t,n){var r=new u.StringWithSubstitutions;return r.set(c.parseString(t[this.name])),r},t.prototype.toJSON=function(e,t,n,r){r.serializeValue(t,this.name,n.getOriginal())},t}(y.PropertyDefinition),se=function(e){function t(t,n){void 0===t&&(t=""),void 0===n&&(n="");var r=e.call(this)||this;return r.name=t,r.value=n,r}return o(t,e),t.prototype.getSchemaKey=function(){return"HttpHeader"},t.prototype.getReferencedInputs=function(e,t){this._value.getReferencedInputs(e,t)},t.prototype.prepareForExecution=function(e){this._value.substituteInputValues(e,u.ContentTypes.applicationXWwwFormUrlencoded)},Object.defineProperty(t.prototype,"value",{get:function(){return this._value.get()},set:function(e){this._value.set(e)},enumerable:!1,configurable:!0}),t.nameProperty=new y.StringProperty(y.Versions.v1_0,"name"),t.valueProperty=new oe(y.Versions.v1_0,"value"),s([(0,y.property)(t.nameProperty)],t.prototype,"name",void 0),s([(0,y.property)(t.valueProperty)],t.prototype,"_value",void 0),t}(y.SerializableObject);t.HttpHeader=se;var ae=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._ignoreInputValidation=!1,t}return o(t,e),t.prototype.internalGetReferencedInputs=function(){var e=this.parent?this.parent.getRootElement().getAllInputs():[],t={};this._url.getReferencedInputs(e,t);for(var n=0,r=this.headers;n<r.length;n++){r[n].getReferencedInputs(e,t)}return this._body.getReferencedInputs(e,t),t},t.prototype.internalPrepareForExecution=function(e){if(e){this._url.substituteInputValues(e,u.ContentTypes.applicationXWwwFormUrlencoded);for(var t=u.ContentTypes.applicationJson,n=0,r=this.headers;n<r.length;n++){var i=r[n];i.prepareForExecution(e),i.name&&"content-type"===i.name.toLowerCase()&&(t=i.value)}this._body.substituteInputValues(e,t)}},t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.internalValidateProperties=function(t){if(e.prototype.internalValidateProperties.call(this,t),this.url||t.addFailure(this,p.ValidationEvent.PropertyCantBeNull,m.Strings.errors.propertyMustBeSet("url")),this.headers.length>0)for(var n=0,r=this.headers;n<r.length;n++){r[n].name||t.addFailure(this,p.ValidationEvent.PropertyCantBeNull,m.Strings.errors.actionHttpHeadersMustHaveNameAndValue())}},Object.defineProperty(t.prototype,"ignoreInputValidation",{get:function(){return this._ignoreInputValidation},set:function(e){this._ignoreInputValidation=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"url",{get:function(){return this._url.get()},set:function(e){this._url.set(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"body",{get:function(){return this._body.get()},set:function(e){this._body.set(e)},enumerable:!1,configurable:!0}),t.urlProperty=new oe(y.Versions.v1_0,"url"),t.bodyProperty=new oe(y.Versions.v1_0,"body"),t.methodProperty=new y.StringProperty(y.Versions.v1_0,"method"),t.headersProperty=new y.SerializableObjectCollectionProperty(y.Versions.v1_0,"headers",se),t.ignoreInputValidationProperty=new y.BoolProperty(y.Versions.v1_3,"ignoreInputValidation",!1),t.JsonTypeName="Action.Http",s([(0,y.property)(t.urlProperty)],t.prototype,"_url",void 0),s([(0,y.property)(t.bodyProperty)],t.prototype,"_body",void 0),s([(0,y.property)(t.methodProperty)],t.prototype,"method",void 0),s([(0,y.property)(t.headersProperty)],t.prototype,"headers",void 0),s([(0,y.property)(t.ignoreInputValidationProperty)],t.prototype,"_ignoreInputValidation",void 0),t}(Q);t.HttpAction=ae;var le=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.card=new Te,t}return o(t,e),t.prototype.updateCssClasses=function(){if(e.prototype.updateCssClasses.call(this),this.renderedElement){var t=this.parent?this.parent.hostConfig:h.defaultHostConfig;this.renderedElement.classList.add(t.makeCssClassName("expandable")),this.renderedElement.setAttribute("aria-expanded",(1===this.state).toString())}},t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n);var r=t.card;r?this.card.parse(r,n):n.logParseEvent(this,p.ValidationEvent.PropertyCantBeNull,m.Strings.errors.showCardMustHaveCard())},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),this.card&&n.serializeValue(t,"card",this.card.toJSON(n))},t.prototype.raiseExecuteActionEvent=function(){this.hostConfig.actions.showCard.actionMode===p.ShowCardActionMode.Popup&&e.prototype.raiseExecuteActionEvent.call(this)},t.prototype.releaseDOMResources=function(){e.prototype.releaseDOMResources.call(this),this.card.releaseDOMResources()},t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this.card.internalValidateProperties(t)},t.prototype.setParent=function(t){e.prototype.setParent.call(this,t),this.card.setParent(t)},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),this.card.getAllInputs(e)},t.prototype.getAllActions=function(){var t=e.prototype.getAllActions.call(this);return t.push.apply(t,this.card.getAllActions()),t},t.prototype.getResourceInformation=function(){var t=e.prototype.getResourceInformation.call(this);return t.push.apply(t,this.card.getResourceInformation()),t},t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);return n||(n=this.card.getActionById(t)),n},t.JsonTypeName="Action.ShowCard",t}(Q);t.ShowCardAction=le;var pe=function(e){function t(t){var n=e.call(this)||this;return n._actions=t,n.title=m.Strings.defaults.overflowButtonText(),n}return o(t,e),t.prototype.getActions=function(){return this._actions},t.prototype.getAllActions=function(){var t=e.prototype.getAllActions.call(this);return t.push.apply(t,this._actions),t},t.prototype.getJsonTypeName=function(){return le.JsonTypeName},t.prototype.execute=function(){var e,t,n,r,i,o=this;if((t=this,n=this.renderedElement,r=t.parent?t.parent.getRootElement():void 0,!(void 0!==(i=r&&r.onDisplayOverflowActionMenu?r.onDisplayOverflowActionMenu:Ie.onDisplayOverflowActionMenu)&&i(t.getActions(),n)))&&this.renderedElement){var s=new v.PopupMenu;s.hostConfig=this.hostConfig;for(var a=function(t){var n=new v.MenuItem(t.toString(),null!==(e=l._actions[t].title)&&void 0!==e?e:"");n.isEnabled=l._actions[t].isEnabled,n.onClick=function(){var e=o._actions[t];s.closePopup(!1),e.isEnabled&&e.execute()},s.items.add(n)},l=this,p=0;p<this._actions.length;p++)a(p);s.popup(this.renderedElement)}},t.JsonTypeName="Action.Overflow",t}(Q),ue=function(){function e(e){this._items=[],this._renderedActions=[],this._owner=e}return e.prototype.isActionAllowed=function(e){var t=this._owner.getForbiddenActionTypes();if(t)for(var n=0,r=t;n<r.length;n++){var i=r[n];if(e.constructor===i)return!1}return!0},e.prototype.refreshContainer=function(){if(b(this._actionCardContainer),this._actionCard){this._actionCardContainer.style.marginTop=this.renderedActionCount>0?this._owner.hostConfig.actions.showCard.inlineTopMargin+"px":"0px";var e=this._owner.getEffectivePadding();this._owner.getImmediateSurroundingPadding(e);var t=this._owner.hostConfig.paddingDefinitionToSpacingDefinition(e);this._actionCard&&(this._actionCard.style.paddingLeft=t.left+"px",this._actionCard.style.paddingRight=t.right+"px",this._actionCard.style.marginLeft="-"+t.left+"px",this._actionCard.style.marginRight="-"+t.right+"px",0===t.bottom||this._owner.isDesignMode()||(this._actionCard.style.paddingBottom=t.bottom+"px",this._actionCard.style.marginBottom="-"+t.bottom+"px"),c.appendChild(this._actionCardContainer,this._actionCard))}else this._actionCardContainer.style.marginTop="0px"},e.prototype.layoutChanged=function(){this._owner.getRootElement().updateLayout()},e.prototype.showActionCard=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!0),e.card.suppressStyle=t;var r=e.card.renderedElement&&!this._owner.isDesignMode()?e.card.renderedElement:e.card.render();this._actionCard=r,this._expandedAction=e,this.refreshContainer(),n&&(this.layoutChanged(),Ce(e,!0))},e.prototype.collapseExpandedAction=function(){for(var e=0,t=this._renderedActions;e<t.length;e++){t[e].state=0}var n=this._expandedAction;this._expandedAction=void 0,this._actionCard=void 0,this.refreshContainer(),n&&(this.layoutChanged(),Ce(n,!1))},e.prototype.expandShowCardAction=function(e,t){for(var n=this,r=!1,i=0,o=this._renderedActions;i<o.length;i++){var s=o[i];this._owner.hostConfig.actions.actionsOrientation==p.Orientation.Horizontal&&r&&(s.isFocusable=!1),s!==e?s.state=2:(s.state=1,r=!0,s.renderedElement&&(s.renderedElement.onblur=function(e){for(var t=0,r=n._renderedActions;t<r.length;t++){r[t].isFocusable=!0}}))}this.showActionCard(e,!(this._owner.isAtTheVeryLeft()&&this._owner.isAtTheVeryRight()),t)},e.prototype.releaseDOMResources=function(){for(var e=0,t=this._renderedActions;e<t.length;e++){t[e].releaseDOMResources()}},e.prototype.actionExecuted=function(e){e instanceof le?e===this._expandedAction?this.collapseExpandedAction():this._owner.hostConfig.actions.showCard.actionMode===p.ShowCardActionMode.Inline&&this.expandShowCardAction(e,!0):this.collapseExpandedAction()},e.prototype.parse=function(e,t){if(this.clear(),Array.isArray(e))for(var n=0,r=e;n<r.length;n++){var i=r[n],o=[];this._owner instanceof Ae&&(o=this._owner.getForbiddenActionNames());var s=t.parseAction(this._owner,i,o,!this._owner.isDesignMode());s&&this.addAction(s)}},e.prototype.toJSON=function(e,t,n){n.serializeArray(e,t,this._items)},e.prototype.getActionAt=function(e){return this._items[e]},e.prototype.getActionCount=function(){return this._items.length},e.prototype.getActionById=function(e){for(var t=void 0,n=0,r=this._items;n<r.length;n++){if(t=r[n].getActionById(e))break}return t},e.prototype.validateProperties=function(e){this._owner.hostConfig.actions.maxActions&&this._items.length>this._owner.hostConfig.actions.maxActions&&e.addFailure(this._owner,p.ValidationEvent.TooManyActions,m.Strings.errors.tooManyActions(this._owner.hostConfig.actions.maxActions)),this._items.length>0&&!this._owner.hostConfig.supportsInteractivity&&e.addFailure(this._owner,p.ValidationEvent.InteractivityNotAllowed,m.Strings.errors.interactivityNotAllowed());for(var t=0,n=this._items;t<n.length;t++){var r=n[t];this.isActionAllowed(r)||e.addFailure(this._owner,p.ValidationEvent.ActionTypeNotAllowed,m.Strings.errors.actionTypeNotAllowed(r.getJsonTypeName())),r.internalValidateProperties(e)}},e.prototype.render=function(e){var t=this._owner.hostConfig;if(t.supportsInteractivity){var n=document.createElement("div"),r=t.actions.maxActions?Math.min(t.actions.maxActions,this._items.length):this._items.length;if(this._actionCardContainer=document.createElement("div"),this._renderedActions=[],t.actions.preExpandSingleShowCardAction&&1===r&&this._items[0]instanceof le&&this.isActionAllowed(this._items[0]))this.showActionCard(this._items[0],!0),this._renderedActions.push(this._items[0]);else{var i=document.createElement("div");if(i.className=t.makeCssClassName("ac-actionSet"),i.style.display="flex",e===p.Orientation.Horizontal)if(i.style.flexDirection="row",this._owner.horizontalAlignment&&t.actions.actionAlignment!==p.ActionAlignment.Stretch)switch(this._owner.horizontalAlignment){case p.HorizontalAlignment.Center:i.style.justifyContent="center";break;case p.HorizontalAlignment.Right:i.style.justifyContent="flex-end";break;default:i.style.justifyContent="flex-start"}else switch(t.actions.actionAlignment){case p.ActionAlignment.Center:i.style.justifyContent="center";break;case p.ActionAlignment.Right:i.style.justifyContent="flex-end";break;default:i.style.justifyContent="flex-start"}else if(i.style.flexDirection="column",this._owner.horizontalAlignment&&t.actions.actionAlignment!==p.ActionAlignment.Stretch)switch(this._owner.horizontalAlignment){case p.HorizontalAlignment.Center:i.style.alignItems="center";break;case p.HorizontalAlignment.Right:i.style.alignItems="flex-end";break;default:i.style.alignItems="flex-start"}else switch(t.actions.actionAlignment){case p.ActionAlignment.Center:i.style.alignItems="center";break;case p.ActionAlignment.Right:i.style.alignItems="flex-end";break;case p.ActionAlignment.Stretch:i.style.alignItems="stretch";break;default:i.style.alignItems="flex-start"}var o=this._items.filter(this.isActionAllowed.bind(this)),s=[],a=[];if(this._owner.isDesignMode())s=o;else{o.forEach((function(e){return e.mode===p.ActionMode.Secondary?a.push(e):s.push(e)}));var l=s.splice(t.actions.maxActions);u.GlobalSettings.allowMoreThanMaxActionsInOverflowMenu&&a.push.apply(a,l);var h=!0;if(a.length>0){this._overflowAction||(this._overflowAction=new pe(a),this._overflowAction.setParent(this._owner),this._overflowAction._actionCollection=this);var d=this._owner instanceof Ie&&!this._owner.parent;h=!function(e,t){var n=e.parent?e.parent.getRootElement():void 0,r=n&&n.onRenderOverflowActions?n.onRenderOverflowActions:Ie.onRenderOverflowActions;return void 0!==r&&r(e.getActions(),t)}(this._overflowAction,d)}this._overflowAction&&h&&s.push(this._overflowAction)}for(var f=0;f<s.length;f++){var y=s[f];if(y.render(),y.renderedElement&&(t.actions.actionsOrientation===p.Orientation.Horizontal&&t.actions.actionAlignment===p.ActionAlignment.Stretch?y.renderedElement.style.flex="0 1 100%":y.renderedElement.style.flex="0 1 auto",i.appendChild(y.renderedElement),this._renderedActions.push(y),f<s.length-1&&t.actions.buttonSpacing>0)){var g=document.createElement("div");e===p.Orientation.Horizontal?(g.style.flex="0 0 auto",g.style.width=t.actions.buttonSpacing+"px"):g.style.height=t.actions.buttonSpacing+"px",c.appendChild(i,g)}}var m=document.createElement("div");m.style.overflow="hidden",m.appendChild(i),c.appendChild(n,m)}c.appendChild(n,this._actionCardContainer);for(var v=0,b=this._renderedActions;v<b.length;v++){var _=b[v];if(1===_.state){this.expandShowCardAction(_,!1);break}}return this._renderedActions.length>0?n:void 0}},e.prototype.addAction=function(e){if(!e)throw new Error("The action parameter cannot be null.");if(e.parent&&e.parent!==this._owner||!(this._items.indexOf(e)<0))throw new Error(m.Strings.errors.actionAlreadyParented());this._items.push(e),e.parent||e.setParent(this._owner),e._actionCollection=this},e.prototype.removeAction=function(e){this.expandedAction&&this._expandedAction===e&&this.collapseExpandedAction();var t=this._items.indexOf(e);if(t>=0){this._items.splice(t,1),e.setParent(void 0),e._actionCollection=void 0;for(var n=0;n<this._renderedActions.length;n++)if(this._renderedActions[n]===e){this._renderedActions.splice(n,1);break}return!0}return!1},e.prototype.clear=function(){this._items=[],this._renderedActions=[],this._expandedAction=void 0},e.prototype.getAllInputs=function(e){void 0===e&&(e=!0);var t=[];if(e)for(var n=0,r=this._items;n<r.length;n++){var i=r[n];t.push.apply(t,i.getAllInputs())}return t},e.prototype.getResourceInformation=function(){for(var e=[],t=0,n=this._items;t<n.length;t++){var r=n[t];e.push.apply(e,r.getResourceInformation())}return e},Object.defineProperty(e.prototype,"renderedActionCount",{get:function(){return this._renderedActions.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"expandedAction",{get:function(){return this._expandedAction},enumerable:!1,configurable:!0}),e}(),ce=function(e){function t(){var t=e.call(this)||this;return t._actionCollection=new ue(t),t}return o(t,e),t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this._actionCollection.parse(t.actions,n)},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),this._actionCollection.toJSON(t,"actions",n)},t.prototype.internalRender=function(){return this._actionCollection.render(void 0!==this.orientation?this.orientation:this.hostConfig.actions.actionsOrientation)},t.prototype.releaseDOMResources=function(){e.prototype.releaseDOMResources.call(this),this._actionCollection.releaseDOMResources()},t.prototype.isBleedingAtBottom=function(){return 0===this._actionCollection.renderedActionCount?e.prototype.isBleedingAtBottom.call(this):1===this._actionCollection.getActionCount()?void 0!==this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:void 0!==this._actionCollection.expandedAction},t.prototype.getJsonTypeName=function(){return"ActionSet"},t.prototype.getActionCount=function(){return this._actionCollection.getActionCount()},t.prototype.getActionAt=function(t){return t>=0&&t<this.getActionCount()?this._actionCollection.getActionAt(t):e.prototype.getActionAt.call(this,t)},t.prototype.getActionById=function(t){var n=this._actionCollection.getActionById(t);return n||e.prototype.getActionById.call(this,t)},t.prototype.getAllActions=function(){for(var t=e.prototype.getAllActions.call(this),n=0;n<this.getActionCount();n++){var r=this.getActionAt(n);r&&t.push(r)}return t},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this._actionCollection.validateProperties(t)},t.prototype.addAction=function(e){this._actionCollection.addAction(e)},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),e?this._actionCollection.getAllInputs():[]},t.prototype.getResourceInformation=function(){return this._actionCollection.getResourceInformation()},t.prototype.findDOMNodeOwner=function(t){for(var n=void 0,r=0;r<this.getActionCount();r++){var i=this.getActionAt(r);if(i&&(n=i.findDOMNodeOwner(t)))return n}return e.prototype.findDOMNodeOwner.call(this,t)},Object.defineProperty(t.prototype,"isInteractive",{get:function(){return!0},enumerable:!1,configurable:!0}),t.orientationProperty=new y.EnumProperty(y.Versions.v1_1,"orientation",p.Orientation),s([(0,y.property)(t.orientationProperty)],t.prototype,"orientation",void 0),t}(C);t.ActionSet=ce;var he=function(e){function t(t,n,r,i){var o=e.call(this,t,n,[{value:p.ContainerStyle.Default},{value:p.ContainerStyle.Emphasis},{targetVersion:y.Versions.v1_2,value:p.ContainerStyle.Accent},{targetVersion:y.Versions.v1_2,value:p.ContainerStyle.Good},{targetVersion:y.Versions.v1_2,value:p.ContainerStyle.Attention},{targetVersion:y.Versions.v1_2,value:p.ContainerStyle.Warning}],r,i)||this;return o.targetVersion=t,o.name=n,o.defaultValue=r,o.onGetInitialValue=i,o}return o(t,e),t}(y.ValueSetProperty);t.ContainerStyleProperty=he;var de=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),Object.defineProperty(t.prototype,"style",{get:function(){if(this.allowCustomStyle){var e=this.getValue(t.styleProperty);if(e&&this.hostConfig.containerStyles.getStyleByName(e))return e}},set:function(e){this.setValue(t.styleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowCustomStyle",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasExplicitStyle",{get:function(){return void 0!==this.getValue(t.styleProperty)},enumerable:!1,configurable:!0}),t.prototype.applyBorder=function(){},t.prototype.applyBackground=function(){if(this.renderedElement){var e=this.hostConfig.containerStyles.getStyleByName(this.style,this.hostConfig.containerStyles.getStyleByName(this.defaultStyle));if(e.backgroundColor){var t=c.stringToCssColor(e.backgroundColor);t&&(this.renderedElement.style.backgroundColor=t)}}},t.prototype.applyPadding=function(){if(e.prototype.applyPadding.call(this),this.renderedElement){var t=new u.SpacingDefinition;if(this.getEffectivePadding()&&(t=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())),this.renderedElement.style.paddingTop=t.top+"px",this.renderedElement.style.paddingRight=t.right+"px",this.renderedElement.style.paddingBottom=t.bottom+"px",this.renderedElement.style.paddingLeft=t.left+"px",this.isBleeding()){var n=new u.PaddingDefinition;this.getImmediateSurroundingPadding(n);var r=this.hostConfig.paddingDefinitionToSpacingDefinition(n);this.renderedElement.style.marginRight="-"+r.right+"px",this.renderedElement.style.marginLeft="-"+r.left+"px",this.isDesignMode()||(this.renderedElement.style.marginTop="-"+r.top+"px",this.renderedElement.style.marginBottom="-"+r.bottom+"px"),this.separatorElement&&this.separatorOrientation===p.Orientation.Horizontal&&(this.separatorElement.style.marginLeft="-"+r.left+"px",this.separatorElement.style.marginRight="-"+r.right+"px")}else this.renderedElement.style.marginRight="0",this.renderedElement.style.marginLeft="0",this.renderedElement.style.marginTop="0",this.renderedElement.style.marginBottom="0",this.separatorElement&&this.separatorOrientation===p.Orientation.Horizontal&&(this.separatorElement.style.marginRight="0",this.separatorElement.style.marginLeft="0")}},t.prototype.getHasBackground=function(e){void 0===e&&(e=!1);for(var n=this.parent;n;){var r=!1;if(r=!e&&(n instanceof ge&&n.backgroundImage.isValid()),n instanceof t&&this.hasExplicitStyle&&(n.getEffectiveStyle()!==this.getEffectiveStyle()||r))return!0;n=n.parent}return!1},t.prototype.getDefaultPadding=function(){return this.getHasBackground()||this.getHasBorder()?new u.PaddingDefinition(p.Spacing.Padding,p.Spacing.Padding,p.Spacing.Padding,p.Spacing.Padding):e.prototype.getDefaultPadding.call(this)},t.prototype.internalValidateProperties=function(n){e.prototype.internalValidateProperties.call(this,n);var r=this.getValue(t.styleProperty);void 0!==r&&(this.hostConfig.containerStyles.getStyleByName(r)||n.addFailure(this,p.ValidationEvent.InvalidPropertyValue,m.Strings.errors.invalidPropertyValue(r,"style")))},t.prototype.render=function(){var t=e.prototype.render.call(this);return t&&this.getHasBackground()&&this.applyBackground(),this.applyBorder(),t},t.prototype.getEffectiveStyle=function(){var t=this.style;return t||e.prototype.getEffectiveStyle.call(this)},t.styleProperty=new he(y.Versions.v1_0,"style"),s([(0,y.property)(t.styleProperty)],t.prototype,"style",null),t}(O);t.StylableCardElementContainer=de;var fe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._bleed=!1,t}return o(t,e),t.prototype.adjustRenderedElementSize=function(t){e.prototype.adjustRenderedElementSize.call(this,t),this.minPixelHeight&&(t.style.minHeight=this.minPixelHeight+"px")},t.prototype.getHasExpandedAction=function(){return!1},t.prototype.getBleed=function(){return this._bleed},t.prototype.setBleed=function(e){this._bleed=e},Object.defineProperty(t.prototype,"renderedActionCount",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.isBleeding=function(){return(this.getHasBackground()||this.hostConfig.alwaysAllowBleed)&&this.getBleed()},t.bleedProperty=new y.BoolProperty(y.Versions.v1_2,"bleed",!1),t.minHeightProperty=new y.PixelSizeProperty(y.Versions.v1_2,"minHeight"),s([(0,y.property)(t.bleedProperty)],t.prototype,"_bleed",void 0),s([(0,y.property)(t.minHeightProperty)],t.prototype,"minPixelHeight",void 0),t}(de);t.ContainerBase=fe;var ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getSchemaKey=function(){return"BackgroundImage"},t.prototype.internalParse=function(t,n){if("string"!=typeof t)return e.prototype.internalParse.call(this,t,n);this.resetDefaultValues(),this.url=t},t.prototype.apply=function(e){if(this.url&&e.renderedElement){switch(e.renderedElement.style.backgroundImage="url('"+e.preProcessPropertyValue(t.urlProperty,this.url)+"')",this.fillMode){case p.FillMode.Repeat:e.renderedElement.style.backgroundRepeat="repeat";break;case p.FillMode.RepeatHorizontally:e.renderedElement.style.backgroundRepeat="repeat-x";break;case p.FillMode.RepeatVertically:e.renderedElement.style.backgroundRepeat="repeat-y";break;case p.FillMode.Cover:default:e.renderedElement.style.backgroundRepeat="no-repeat",e.renderedElement.style.backgroundSize="cover"}switch(this.horizontalAlignment){case p.HorizontalAlignment.Left:break;case p.HorizontalAlignment.Center:e.renderedElement.style.backgroundPositionX="center";break;case p.HorizontalAlignment.Right:e.renderedElement.style.backgroundPositionX="right"}switch(this.verticalAlignment){case p.VerticalAlignment.Top:break;case p.VerticalAlignment.Center:e.renderedElement.style.backgroundPositionY="center";break;case p.VerticalAlignment.Bottom:e.renderedElement.style.backgroundPositionY="bottom"}}},t.prototype.isValid=function(){return!!this.url},t.urlProperty=new y.StringProperty(y.Versions.v1_0,"url"),t.fillModeProperty=new y.EnumProperty(y.Versions.v1_2,"fillMode",p.FillMode,p.FillMode.Cover),t.horizontalAlignmentProperty=new y.EnumProperty(y.Versions.v1_2,"horizontalAlignment",p.HorizontalAlignment,p.HorizontalAlignment.Left),t.verticalAlignmentProperty=new y.EnumProperty(y.Versions.v1_2,"verticalAlignment",p.VerticalAlignment,p.VerticalAlignment.Top),s([(0,y.property)(t.urlProperty)],t.prototype,"url",void 0),s([(0,y.property)(t.fillModeProperty)],t.prototype,"fillMode",void 0),s([(0,y.property)(t.horizontalAlignmentProperty)],t.prototype,"horizontalAlignment",void 0),s([(0,y.property)(t.verticalAlignmentProperty)],t.prototype,"verticalAlignment",void 0),t}(y.SerializableObject);t.BackgroundImage=ye;var ge=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._items=[],t._renderedItems=[],t}return o(t,e),Object.defineProperty(t.prototype,"backgroundImage",{get:function(){return this.getValue(t.backgroundImageProperty)},enumerable:!1,configurable:!0}),t.prototype.insertItemAt=function(e,t,n){if(e.parent&&!n)throw new Error(m.Strings.errors.elementAlreadyParented());if(!e.isStandalone)throw new Error(m.Strings.errors.elementTypeNotStandalone(e.getJsonTypeName()));t<0||t>=this._items.length?this._items.push(e):this._items.splice(t,0,e),e.setParent(this)},t.prototype.getItemsCollectionPropertyName=function(){return"items"},t.prototype.applyBackground=function(){this.backgroundImage.isValid()&&this.renderedElement&&this.backgroundImage.apply(this),e.prototype.applyBackground.call(this)},t.prototype.applyRTL=function(e){void 0!==this.rtl&&(e.dir=this.rtl?"rtl":"ltr")},t.prototype.internalRender=function(){this._renderedItems=[];var e=this.hostConfig,t=document.createElement("div");switch(this.applyRTL(t),t.classList.add(e.makeCssClassName("ac-container")),t.style.display="flex",t.style.flexDirection="column",u.GlobalSettings.useAdvancedCardBottomTruncation&&(t.style.minHeight="-webkit-min-content"),this.getEffectiveVerticalContentAlignment()){case p.VerticalAlignment.Center:t.style.justifyContent="center";break;case p.VerticalAlignment.Bottom:t.style.justifyContent="flex-end";break;default:t.style.justifyContent="flex-start"}if(this._items.length>0)for(var n=0,r=this._items;n<r.length;n++){var i=r[n],o=this.isElementAllowed(i)?i.render():void 0;o&&(this._renderedItems.length>0&&i.separatorElement&&(i.separatorElement.style.flex="0 0 auto",c.appendChild(t,i.separatorElement)),c.appendChild(t,o),this._renderedItems.push(i))}else if(this.isDesignMode()){var s=this.createPlaceholderElement();s.style.width="100%",s.style.height="100%",t.appendChild(s)}return t},t.prototype.truncateOverflow=function(e){if(this.renderedElement){for(var t=this.renderedElement.offsetTop+e+1,n=function e(n){var r=n.renderedElement;if(r)switch(c.getFitStatus(r,t)){case p.ContainerFitStatus.FullyInContainer:n.resetOverflow()&&e(n);break;case p.ContainerFitStatus.Overflowing:var i=t-r.offsetTop;n.handleOverflow(i);break;case p.ContainerFitStatus.FullyOutOfContainer:n.handleOverflow(0)}},r=0,i=this._items;r<i.length;r++){n(i[r])}return!0}return!1},t.prototype.undoOverflowTruncation=function(){for(var e=0,t=this._items;e<t.length;e++){t[e].resetOverflow()}},t.prototype.getHasBackground=function(t){return void 0===t&&(t=!1),!t&&this.backgroundImage.isValid()||e.prototype.getHasBackground.call(this,t)},t.prototype.canHostSingletons=function(){return!1},t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this.clear(),this.setShouldFallback(!1);var i=t[this.getItemsCollectionPropertyName()];if(!Array.isArray(i)&&"object"===r(i)&&this.canHostSingletons()){var o=c.parseString(i.type);if(o){var s=n.elementRegistry.findByName(o);if((null==s?void 0:s.singletonBehavior)!==g.ElementSingletonBehavior.NotAllowed)(p=n.parseElement(this,i,[],!this.isDesignMode(),!0))&&this.insertItemAt(p,-1,!0)}}else if(Array.isArray(i))for(var a=0,l=i;a<l.length;a++){var p,u=l[a];(p=n.parseElement(this,u,this.forbiddenChildElements(),!this.isDesignMode()))&&this.insertItemAt(p,-1,!0)}},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n);var r=this.getItemsCollectionPropertyName();1===this._items.length&&this._items[0].getElementSingletonBehavior()===g.ElementSingletonBehavior.Only?n.serializeValue(t,r,this._items[0].toJSON(n)):n.serializeArray(t,r,this._items)},Object.defineProperty(t.prototype,"isSelectable",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.getEffectivePadding=function(){return u.GlobalSettings.removePaddingFromContainersWithBackgroundImage&&!this.getHasBackground(!0)?new u.PaddingDefinition:e.prototype.getEffectivePadding.call(this)},t.prototype.getEffectiveVerticalContentAlignment=function(){if(void 0!==this.verticalContentAlignment)return this.verticalContentAlignment;var e=this.getParentContainer();return e?e.getEffectiveVerticalContentAlignment():p.VerticalAlignment.Top},t.prototype.getItemCount=function(){return this._items.length},t.prototype.getItemAt=function(e){return this._items[e]},t.prototype.getFirstVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedItems&&this._renderedItems.length>0)for(var e=0,t=this._renderedItems;e<t.length;e++){var n=t[e];if(n.isVisible)return n}},t.prototype.getLastVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedItems&&this._renderedItems.length>0)for(var e=this._renderedItems.length-1;e>=0;e--)if(this._renderedItems[e].isVisible)return this._renderedItems[e]},t.prototype.getJsonTypeName=function(){return"Container"},t.prototype.isFirstElement=function(e){for(var t=this.isDesignMode(),n=0,r=this._items;n<r.length;n++){var i=r[n];if(i.isVisible||t)return i===e}return!1},t.prototype.isLastElement=function(e){for(var t=this.isDesignMode(),n=this._items.length-1;n>=0;n--)if(this._items[n].isVisible||t)return this._items[n]===e;return!1},t.prototype.isRtl=function(){if(void 0!==this.rtl)return this.rtl;var e=this.getParentContainer();return!!e&&e.isRtl()},t.prototype.isBleedingAtTop=function(){var e=this.getFirstVisibleRenderedItem();return this.isBleeding()||!!e&&e.isBleedingAtTop()},t.prototype.isBleedingAtBottom=function(){var e=this.getLastVisibleRenderedItem();return this.isBleeding()||!!e&&(e.isBleedingAtBottom()&&e.getEffectiveStyle()===this.getEffectiveStyle())},t.prototype.indexOf=function(e){return this._items.indexOf(e)},t.prototype.addItem=function(e){this.insertItemAt(e,-1,!1)},t.prototype.insertItemBefore=function(e,t){this.insertItemAt(e,this._items.indexOf(t),!1)},t.prototype.insertItemAfter=function(e,t){this.insertItemAt(e,this._items.indexOf(t)+1,!1)},t.prototype.removeItem=function(e){var t=this._items.indexOf(e);return t>=0&&(this._items.splice(t,1),e.setParent(void 0),this.updateLayout(),!0)},t.prototype.clear=function(){this._items=[],this._renderedItems=[]},t.prototype.getResourceInformation=function(){var t=e.prototype.getResourceInformation.call(this);return this.backgroundImage.isValid()&&t.push({url:this.backgroundImage.url,mimeType:"image"}),t},t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);if(!n&&(this.selectAction&&(n=this.selectAction.getActionById(t)),!n))for(var r=0,i=this._items;r<i.length;r++){if(n=i[r].getActionById(t))break}return n},Object.defineProperty(t.prototype,"padding",{get:function(){return this.getPadding()},set:function(e){this.setPadding(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectAction",{get:function(){return this._selectAction},set:function(e){this._selectAction=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bleed",{get:function(){return this.getBleed()},set:function(e){this.setBleed(e)},enumerable:!1,configurable:!0}),t.backgroundImageProperty=new y.SerializableObjectProperty(y.Versions.v1_0,"backgroundImage",ye),t.verticalContentAlignmentProperty=new y.EnumProperty(y.Versions.v1_1,"verticalContentAlignment",p.VerticalAlignment),t.rtlProperty=new y.BoolProperty(y.Versions.v1_0,"rtl"),s([(0,y.property)(t.backgroundImageProperty)],t.prototype,"backgroundImage",null),s([(0,y.property)(t.verticalContentAlignmentProperty)],t.prototype,"verticalContentAlignment",void 0),s([(0,y.property)(t.rtlProperty)],t.prototype,"rtl",void 0),t}(fe);t.Container=ge;var me=function(e){function t(t){void 0===t&&(t="stretch");var n=e.call(this)||this;return n.width="stretch",n._computedWeight=0,n.width=t,n}return o(t,e),t.prototype.adjustRenderedElementSize=function(e){this.isDesignMode()?(e.style.minWidth="20px",e.style.minHeight=(this.minPixelHeight?Math.max(this.minPixelHeight,20):20)+"px"):(e.style.minWidth="0",this.minPixelHeight&&(e.style.minHeight=this.minPixelHeight+"px")),"auto"===this.width?e.style.flex="0 1 auto":"stretch"===this.width?e.style.flex="1 1 50px":this.width instanceof u.SizeAndUnit&&(this.width.unit===p.SizeUnit.Pixel?(e.style.flex="0 0 auto",e.style.width=this.width.physicalSize+"px"):e.style.flex="1 1 "+(this._computedWeight>0?this._computedWeight:this.width.physicalSize)+"%")},t.prototype.shouldSerialize=function(e){return!0},Object.defineProperty(t.prototype,"separatorOrientation",{get:function(){return p.Orientation.Vertical},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return"Column"},Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!!(this.parent&&this.parent instanceof ve)&&(void 0!==this.separatorElement&&!this.parent.isLeftMostElement(this))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),t.widthProperty=new y.CustomProperty(y.Versions.v1_0,"width",(function(e,t,n,r){var i=t.defaultValue,o=n[t.name],s=!1;if("number"!=typeof o||isNaN(o))if("auto"===o||"stretch"===o)i=o;else if("string"==typeof o)try{(i=u.SizeAndUnit.parse(o)).unit===p.SizeUnit.Pixel&&t.targetVersion.compareTo(r.targetVersion)>0&&(s=!0)}catch(e){s=!0}else s=!0;else i=new u.SizeAndUnit(o,p.SizeUnit.Weight);return s&&(r.logParseEvent(e,p.ValidationEvent.InvalidPropertyValue,m.Strings.errors.invalidColumnWidth(o)),i="auto"),i}),(function(e,t,n,r,i){r instanceof u.SizeAndUnit?r.unit===p.SizeUnit.Pixel?i.serializeValue(n,"width",r.physicalSize+"px"):i.serializeNumber(n,"width",r.physicalSize):i.serializeValue(n,"width",r)}),"stretch"),s([(0,y.property)(t.widthProperty)],t.prototype,"width",void 0),t}(ge);t.Column=me;var ve=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._columns=[],t}return o(t,e),t.prototype.createColumnInstance=function(e,t){return t.parseCardObject(this,e,[],!this.isDesignMode(),(function(e){return e&&"Column"!==e?void 0:new me}),(function(e,n){t.logParseEvent(void 0,p.ValidationEvent.ElementTypeNotAllowed,m.Strings.errors.elementTypeNotAllowed(e))}))},t.prototype.internalRender=function(){if(this._renderedColumns=[],this._columns.length>0){var e=this.hostConfig,t=document.createElement("div");switch(t.className=e.makeCssClassName("ac-columnSet"),t.style.display="flex",u.GlobalSettings.useAdvancedCardBottomTruncation&&(t.style.minHeight="-webkit-min-content"),this.getEffectiveHorizontalAlignment()){case p.HorizontalAlignment.Center:t.style.justifyContent="center";break;case p.HorizontalAlignment.Right:t.style.justifyContent="flex-end";break;default:t.style.justifyContent="flex-start"}for(var n=0,r=0,i=this._columns;r<i.length;r++){(a=i[r]).width instanceof u.SizeAndUnit&&a.width.unit===p.SizeUnit.Weight&&(n+=a.width.physicalSize)}for(var o=0,s=this._columns;o<s.length;o++){var a;if((a=s[o]).width instanceof u.SizeAndUnit&&a.width.unit===p.SizeUnit.Weight&&n>0){var l=100/n*a.width.physicalSize;a._computedWeight=l}var h=a.render();h&&(this._renderedColumns.length>0&&a.separatorElement&&(a.separatorElement.style.flex="0 0 auto",c.appendChild(t,a.separatorElement)),c.appendChild(t,h),this._renderedColumns.push(a))}return this._renderedColumns.length>0?t:void 0}},t.prototype.truncateOverflow=function(e){for(var t=0,n=this._columns;t<n.length;t++){n[t].handleOverflow(e)}return!0},t.prototype.undoOverflowTruncation=function(){for(var e=0,t=this._columns;e<t.length;e++){t[e].resetOverflow()}},Object.defineProperty(t.prototype,"isSelectable",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this._columns=[],this._renderedColumns=[];var r=t.columns;if(Array.isArray(r))for(var i=0,o=r;i<o.length;i++){var s=o[i],a=this.createColumnInstance(s,n);a&&this._columns.push(a)}},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),n.serializeArray(t,"columns",this._columns)},t.prototype.isFirstElement=function(e){for(var t=0,n=this._columns;t<n.length;t++){var r=n[t];if(r.isVisible)return r===e}return!1},t.prototype.isBleedingAtTop=function(){if(this.isBleeding())return!0;if(this._renderedColumns&&this._renderedColumns.length>0)for(var e=0,t=this._columns;e<t.length;e++){if(t[e].isBleedingAtTop())return!0}return!1},t.prototype.isBleedingAtBottom=function(){if(this.isBleeding())return!0;if(this._renderedColumns&&this._renderedColumns.length>0)for(var e=0,t=this._columns;e<t.length;e++){if(t[e].isBleedingAtBottom())return!0}return!1},t.prototype.getItemCount=function(){return this._columns.length},t.prototype.getFirstVisibleRenderedItem=function(){return this.renderedElement&&this._renderedColumns&&this._renderedColumns.length>0?this._renderedColumns[0]:void 0},t.prototype.getLastVisibleRenderedItem=function(){return this.renderedElement&&this._renderedColumns&&this._renderedColumns.length>0?this._renderedColumns[this._renderedColumns.length-1]:void 0},t.prototype.getColumnAt=function(e){return this._columns[e]},t.prototype.getItemAt=function(e){return this.getColumnAt(e)},t.prototype.getJsonTypeName=function(){return"ColumnSet"},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);for(var n=0,r=0,i=0,o=this._columns;i<o.length;i++){var s=o[i];"number"==typeof s.width?n++:"stretch"===s.width&&r++}n>0&&r>0&&t.addFailure(this,p.ValidationEvent.Hint,m.Strings.hints.dontUseWeightedAndStrecthedColumnsInSameSet())},t.prototype.addColumn=function(e){if(e.parent)throw new Error(m.Strings.errors.columnAlreadyBelongsToAnotherSet());this._columns.push(e),e.setParent(this)},t.prototype.removeItem=function(e){if(e instanceof me){var t=this._columns.indexOf(e);if(t>=0)return this._columns.splice(t,1),e.setParent(void 0),this.updateLayout(),!0}return!1},t.prototype.indexOf=function(e){return e instanceof me?this._columns.indexOf(e):-1},t.prototype.isLeftMostElement=function(e){return 0===this._columns.indexOf(e)},t.prototype.isRightMostElement=function(e){return this._columns.indexOf(e)===this._columns.length-1},t.prototype.isTopElement=function(e){return this._columns.indexOf(e)>=0},t.prototype.isBottomElement=function(e){return this._columns.indexOf(e)>=0},t.prototype.getActionById=function(e){for(var t=void 0,n=0,r=this._columns;n<r.length;n++){if(t=r[n].getActionById(e))break}return t},Object.defineProperty(t.prototype,"bleed",{get:function(){return this.getBleed()},set:function(e){this.setBleed(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return this.getPadding()},set:function(e){this.setPadding(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectAction",{get:function(){return this._selectAction},set:function(e){this._selectAction=e},enumerable:!1,configurable:!0}),t}(fe);function be(e){var t=e.getRootElement(),n=t&&t.onImageLoaded?t.onImageLoaded:Ie.onImageLoaded;n&&n(e)}function _e(e,t,n){var r=e.getRootElement(),i=r&&r.onAnchorClicked?r.onAnchorClicked:Ie.onAnchorClicked;return void 0!==i&&i(e,t,n)}function Ce(e,t){var n=e.parent?e.parent.getRootElement():void 0,r=n&&n.onInlineCardExpanded?n.onInlineCardExpanded:Ie.onInlineCardExpanded;r&&r(e,t)}function Se(e,t){void 0===t&&(t=!0);var n=e.getRootElement();t&&n.updateLayout();var r=n,i=r&&r.onElementVisibilityChanged?r.onElementVisibilityChanged:Ie.onElementVisibilityChanged;void 0!==i&&i(e)}t.ColumnSet=ve;var Ae=function(e){function t(){var t=e.call(this)||this;return t._actionCollection=new ue(t),t}return o(t,e),t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this.parseActions(t,n)},t.prototype.parseActions=function(e,t){this._actionCollection.parse(e.actions,t)},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),this._actionCollection.toJSON(t,"actions",n)},t.prototype.internalRender=function(){var t=e.prototype.internalRender.call(this);if(t){var n=this._actionCollection.render(this.hostConfig.actions.actionsOrientation);return n&&(c.appendChild(t,_(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.hostConfig.actions.spacing)},p.Orientation.Horizontal)),c.appendChild(t,n)),this.renderIfEmpty||t.children.length>0?t:void 0}},t.prototype.getHasExpandedAction=function(){return 0!==this.renderedActionCount&&(1===this.renderedActionCount?void 0!==this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:void 0!==this._actionCollection.expandedAction)},Object.defineProperty(t.prototype,"renderedActionCount",{get:function(){return this._actionCollection.renderedActionCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderIfEmpty",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.releaseDOMResources=function(){e.prototype.releaseDOMResources.call(this),this._actionCollection.releaseDOMResources()},t.prototype.getActionCount=function(){return this._actionCollection.getActionCount()},t.prototype.getActionAt=function(t){return t>=0&&t<this.getActionCount()?this._actionCollection.getActionAt(t):e.prototype.getActionAt.call(this,t)},t.prototype.getActionById=function(t){var n=this._actionCollection.getActionById(t);return n||e.prototype.getActionById.call(this,t)},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this._actionCollection&&this._actionCollection.validateProperties(t)},t.prototype.isLastElement=function(t){return e.prototype.isLastElement.call(this,t)&&0===this._actionCollection.getActionCount()},t.prototype.addAction=function(e){this._actionCollection.addAction(e)},t.prototype.clear=function(){e.prototype.clear.call(this),this._actionCollection.clear()},t.prototype.getAllInputs=function(t){void 0===t&&(t=!0);var n=e.prototype.getAllInputs.call(this,t);return t&&n.push.apply(n,this._actionCollection.getAllInputs(t)),n},t.prototype.getResourceInformation=function(){var t=e.prototype.getResourceInformation.call(this);return t.push.apply(t,this._actionCollection.getResourceInformation()),t},t.prototype.isBleedingAtBottom=function(){return 0===this._actionCollection.renderedActionCount?e.prototype.isBleedingAtBottom.call(this):1===this._actionCollection.getActionCount()?void 0!==this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:void 0!==this._actionCollection.expandedAction},t.prototype.getForbiddenActionNames=function(){return[]},Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),t}(ge);t.ContainerWithActions=Ae;var we=function(e){function t(t,n){var r=e.call(this,t,n,void 0)||this;return r.targetVersion=t,r.name=n,r}return o(t,e),t.prototype.parse=function(e,t,n){var r=n.parseAction(e.parent,t[this.name],[],!1);if(void 0!==r){if(r instanceof ne)return r;n.logParseEvent(e,p.ValidationEvent.ActionTypeNotAllowed,m.Strings.errors.actionTypeNotAllowed(r.getJsonTypeName()))}n.logParseEvent(e,p.ValidationEvent.PropertyCantBeNull,m.Strings.errors.propertyMustBeSet("action"))},t.prototype.toJSON=function(e,t,n,r){r.serializeValue(t,this.name,n?n.toJSON(r):void 0,void 0,!0)},t}(y.PropertyDefinition);t.RefreshActionProperty=we;var Ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),Object.defineProperty(t.prototype,"action",{get:function(){return this.getValue(t.actionProperty)},set:function(e){this.setValue(t.actionProperty,e),e&&e.setParent(this.parent)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"RefreshDefinition"},t.actionProperty=new we(y.Versions.v1_4,"action"),t.userIdsProperty=new y.StringArrayProperty(y.Versions.v1_4,"userIds"),s([(0,y.property)(t.actionProperty)],t.prototype,"action",null),s([(0,y.property)(t.userIdsProperty)],t.prototype,"userIds",void 0),t}(y.SerializableObject);t.RefreshDefinition=Ee;var Pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getSchemaKey=function(){return"AuthCardButton"},t.typeProperty=new y.StringProperty(y.Versions.v1_4,"type"),t.titleProperty=new y.StringProperty(y.Versions.v1_4,"title"),t.imageProperty=new y.StringProperty(y.Versions.v1_4,"image"),t.valueProperty=new y.StringProperty(y.Versions.v1_4,"value"),s([(0,y.property)(t.typeProperty)],t.prototype,"type",void 0),s([(0,y.property)(t.titleProperty)],t.prototype,"title",void 0),s([(0,y.property)(t.imageProperty)],t.prototype,"image",void 0),s([(0,y.property)(t.valueProperty)],t.prototype,"value",void 0),t}(y.SerializableObject);t.AuthCardButton=Pe;var xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getSchemaKey=function(){return"TokenExchangeResource"},t.idProperty=new y.StringProperty(y.Versions.v1_4,"id"),t.uriProperty=new y.StringProperty(y.Versions.v1_4,"uri"),t.providerIdProperty=new y.StringProperty(y.Versions.v1_4,"providerId"),s([(0,y.property)(t.idProperty)],t.prototype,"id",void 0),s([(0,y.property)(t.uriProperty)],t.prototype,"uri",void 0),s([(0,y.property)(t.providerIdProperty)],t.prototype,"providerId",void 0),t}(y.SerializableObject);t.TokenExchangeResource=xe;var ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getSchemaKey=function(){return"Authentication"},t.textProperty=new y.StringProperty(y.Versions.v1_4,"text"),t.connectionNameProperty=new y.StringProperty(y.Versions.v1_4,"connectionName"),t.buttonsProperty=new y.SerializableObjectCollectionProperty(y.Versions.v1_4,"buttons",Pe),t.tokenExchangeResourceProperty=new y.SerializableObjectProperty(y.Versions.v1_4,"tokenExchangeResource",xe,!0),s([(0,y.property)(t.textProperty)],t.prototype,"text",void 0),s([(0,y.property)(t.connectionNameProperty)],t.prototype,"connectionName",void 0),s([(0,y.property)(t.buttonsProperty)],t.prototype,"buttons",void 0),s([(0,y.property)(t.tokenExchangeResourceProperty)],t.prototype,"tokenExchangeResource",void 0),t}(y.SerializableObject);t.Authentication=ke;var Ie=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.designMode=!1,t}return o(t,e),Object.defineProperty(t.prototype,"refresh",{get:function(){return this.getValue(t.refreshProperty)},set:function(e){this.setValue(t.refreshProperty,e),e&&(e.parent=this)},enumerable:!1,configurable:!0}),Object.defineProperty(t,"processMarkdown",{get:function(){throw new Error(m.Strings.errors.processMarkdownEventRemoved())},set:function(e){throw new Error(m.Strings.errors.processMarkdownEventRemoved())},enumerable:!1,configurable:!0}),t.applyMarkdown=function(e){var n={didProcess:!1};if(t.onProcessMarkdown)t.onProcessMarkdown(e,n);else if(window.markdownit){var r=window.markdownit;n.outputHtml=r().render(e),n.didProcess=!0}else t._haveWarnedAboutNoMarkdownProcessing||(console.warn(m.Strings.errors.markdownProcessingNotEnabled),t._haveWarnedAboutNoMarkdownProcessing=!0);return n},t.prototype.isVersionSupported=function(){return!!this.bypassVersionCheck||!(!this.version||!this.version.isValid||this.maxVersion.major<this.version.major||this.maxVersion.major===this.version.major&&this.maxVersion.minor<this.version.minor)},t.prototype.getDefaultSerializationContext=function(){return new Oe(this.version)},t.prototype.getItemsCollectionPropertyName=function(){return"body"},t.prototype.canHostSingletons=function(){return!0},t.prototype.internalParse=function(n,r){this._fallbackCard=void 0;var i=r.parseElement(void 0,n.fallback,this.forbiddenChildElements(),!this.isDesignMode());i&&(this._fallbackCard=new t,this._fallbackCard.addItem(i)),e.prototype.internalParse.call(this,n,r)},t.prototype.internalToJSON=function(n,r){this.setValue(t.versionProperty,r.targetVersion),e.prototype.internalToJSON.call(this,n,r)},t.prototype.internalRender=function(){var t=e.prototype.internalRender.call(this);return u.GlobalSettings.useAdvancedCardBottomTruncation&&t&&t.style.removeProperty("minHeight"),t},t.prototype.getHasBackground=function(e){return void 0===e&&(e=!1),!0},t.prototype.getDefaultPadding=function(){return new u.PaddingDefinition(p.Spacing.Padding,p.Spacing.Padding,p.Spacing.Padding,p.Spacing.Padding)},t.prototype.shouldSerialize=function(e){return!0},Object.defineProperty(t.prototype,"renderIfEmpty",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bypassVersionCheck",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowCustomStyle",{get:function(){return this.hostConfig.adaptiveCard&&this.hostConfig.adaptiveCard.allowCustomStyle},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasBackground",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return"AdaptiveCard"},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),"AdaptiveCard"!==this.getValue(C.typeNameProperty)&&t.addFailure(this,p.ValidationEvent.MissingCardType,m.Strings.errors.invalidCardType()),this.bypassVersionCheck||this.version?this.isVersionSupported()||t.addFailure(this,p.ValidationEvent.UnsupportedCardVersion,m.Strings.errors.unsupportedCardVersion(this.version.toString(),this.maxVersion.toString())):t.addFailure(this,p.ValidationEvent.PropertyCantBeNull,m.Strings.errors.propertyMustBeSet("version"))},t.prototype.render=function(t){var n;return this.shouldFallback()&&this._fallbackCard?(this._fallbackCard.hostConfig=this.hostConfig,n=this._fallbackCard.render()):(n=e.prototype.render.call(this))&&(n.classList.add(this.hostConfig.makeCssClassName("ac-adaptiveCard")),u.GlobalSettings.setTabIndexAtCardRoot&&(n.tabIndex=0),this.speak&&n.setAttribute("aria-label",this.speak)),t&&(c.appendChild(t,n),this.updateLayout()),n},t.prototype.updateLayout=function(t){if(void 0===t&&(t=!0),e.prototype.updateLayout.call(this,t),u.GlobalSettings.useAdvancedCardBottomTruncation&&this.isDisplayed()){var n=this.hostConfig.getEffectiveSpacing(p.Spacing.Default);this.handleOverflow(this.renderedElement.offsetHeight-n)}},t.prototype.shouldFallback=function(){return e.prototype.shouldFallback.call(this)||!this.isVersionSupported()},Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!1},enumerable:!1,configurable:!0}),t.schemaUrl="http://adaptivecards.io/schemas/adaptive-card.json",t.$schemaProperty=new y.CustomProperty(y.Versions.v1_0,"$schema",(function(e,n,r,i){return t.schemaUrl}),(function(e,n,r,i,o){o.serializeValue(r,n.name,t.schemaUrl)})),t.versionProperty=new y.CustomProperty(y.Versions.v1_0,"version",(function(e,t,n,r){var i=y.Version.parse(n[t.name],r);return void 0===i&&(i=y.Versions.latest,r.logParseEvent(e,p.ValidationEvent.InvalidPropertyValue,m.Strings.errors.invalidCardVersion(i.toString()))),i}),(function(e,t,n,r,i){void 0!==r&&i.serializeValue(n,t.name,r.toString())}),y.Versions.v1_0),t.fallbackTextProperty=new y.StringProperty(y.Versions.v1_0,"fallbackText"),t.speakProperty=new y.StringProperty(y.Versions.v1_0,"speak"),t.refreshProperty=new y.SerializableObjectProperty(y.Versions.v1_4,"refresh",Ee,!0),t.authenticationProperty=new y.SerializableObjectProperty(y.Versions.v1_4,"authentication",ke,!0),t._haveWarnedAboutNoMarkdownProcessing=!1,s([(0,y.property)(t.versionProperty)],t.prototype,"version",void 0),s([(0,y.property)(t.fallbackTextProperty)],t.prototype,"fallbackText",void 0),s([(0,y.property)(t.speakProperty)],t.prototype,"speak",void 0),s([(0,y.property)(t.refreshProperty)],t.prototype,"refresh",null),s([(0,y.property)(t.authenticationProperty)],t.prototype,"authentication",void 0),t}(Ae);t.AdaptiveCard=Ie;var Te=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.suppressStyle=!1,t}return o(t,e),t.prototype.getSchemaKey=function(){return"InlineAdaptiveCard"},t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.remove(Ie.$schemaProperty,Ie.versionProperty)},t.prototype.getDefaultPadding=function(){return new u.PaddingDefinition(this.suppressStyle?p.Spacing.None:p.Spacing.Padding,p.Spacing.Padding,this.suppressStyle?p.Spacing.None:p.Spacing.Padding,p.Spacing.Padding)},Object.defineProperty(t.prototype,"bypassVersionCheck",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultStyle",{get:function(){return this.suppressStyle?p.ContainerStyle.Default:this.hostConfig.actions.showCard.style?this.hostConfig.actions.showCard.style:p.ContainerStyle.Emphasis},enumerable:!1,configurable:!0}),t.prototype.render=function(t){var n=e.prototype.render.call(this,t);return n&&(n.setAttribute("aria-live","polite"),n.removeAttribute("tabindex")),n},t}(Ie),Oe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._forbiddenTypes=new Set,t}return o(t,e),t.prototype.internalParseCardObject=function(e,t,n,i,o,s,a){var l=this;void 0===a&&(a=!1);var h=void 0;if(t&&"object"===r(t)){var d=new Set;this._forbiddenTypes.forEach((function(e){d.add(e)})),n.forEach((function(e){l._forbiddenTypes.add(e)}));var f=c.parseString(t.type),y=a&&"Carousel"===f;if(f&&this._forbiddenTypes.has(f)&&!y)s(f,p.TypeErrorType.ForbiddenType);else{var g=!1;if((h=o(f))?(h.setParent(e),h.parse(t,this),g=u.GlobalSettings.enableFallback&&i&&h.shouldFallback()):(g=u.GlobalSettings.enableFallback&&i,s(f,p.TypeErrorType.UnknownType)),g){var m=t.fallback;!m&&e&&e.setShouldFallback(!0),"string"==typeof m&&"drop"===m.toLowerCase()?h=void 0:"object"===r(m)&&(h=this.internalParseCardObject(e,m,n,!0,o,s))}}this._forbiddenTypes=d}return h},t.prototype.cardObjectParsed=function(e,t){e instanceof Q&&this.onParseAction?this.onParseAction(e,t,this):e instanceof C&&this.onParseElement&&this.onParseElement(e,t,this)},t.prototype.shouldSerialize=function(e){return e instanceof Q?void 0!==this.actionRegistry.findByName(e.getJsonTypeName()):!(e instanceof C)||void 0!==this.elementRegistry.findByName(e.getJsonTypeName())},t.prototype.parseCardObject=function(e,t,n,r,i,o,s){void 0===s&&(s=!1);var a=new Set(n),l=this.internalParseCardObject(e,t,a,r,i,o,s);return void 0!==l&&this.cardObjectParsed(l,t),l},t.prototype.parseElement=function(e,t,n,r,i){var o=this;return void 0===i&&(i=!1),this.parseCardObject(e,t,n,r,(function(e){return o.elementRegistry.createInstance(e,o.targetVersion)}),(function(e,t){t===p.TypeErrorType.UnknownType?o.logParseEvent(void 0,p.ValidationEvent.UnknownElementType,m.Strings.errors.unknownElementType(e)):o.logParseEvent(void 0,p.ValidationEvent.ElementTypeNotAllowed,m.Strings.errors.elementTypeNotAllowed(e))}),i)},t.prototype.parseAction=function(e,t,n,r){var i=this;return this.parseCardObject(e,t,n,r,(function(e){return i.actionRegistry.createInstance(e,i.targetVersion)}),(function(e,t){t===p.TypeErrorType.UnknownType?i.logParseEvent(void 0,p.ValidationEvent.UnknownActionType,m.Strings.errors.unknownActionType(e)):i.logParseEvent(void 0,p.ValidationEvent.ActionTypeNotAllowed,m.Strings.errors.actionTypeNotAllowed(e))}))},Object.defineProperty(t.prototype,"elementRegistry",{get:function(){var e;return null!==(e=this._elementRegistry)&&void 0!==e?e:g.GlobalRegistry.elements},enumerable:!1,configurable:!0}),t.prototype.setElementRegistry=function(e){this._elementRegistry=e},Object.defineProperty(t.prototype,"actionRegistry",{get:function(){var e;return null!==(e=this._actionRegistry)&&void 0!==e?e:g.GlobalRegistry.actions},enumerable:!1,configurable:!0}),t.prototype.setActionRegistry=function(e){this._actionRegistry=e},t}(y.BaseSerializationContext);t.SerializationContext=Oe,g.GlobalRegistry.defaultElements.register("Container",ge),g.GlobalRegistry.defaultElements.register("TextBlock",w),g.GlobalRegistry.defaultElements.register("RichTextBlock",P,y.Versions.v1_2),g.GlobalRegistry.defaultElements.register("TextRun",E,y.Versions.v1_2),g.GlobalRegistry.defaultElements.register("Image",T),g.GlobalRegistry.defaultElements.register("ImageSet",V),g.GlobalRegistry.defaultElements.register("Media",U,y.Versions.v1_1),g.GlobalRegistry.defaultElements.register("FactSet",k),g.GlobalRegistry.defaultElements.register("ColumnSet",ve),g.GlobalRegistry.defaultElements.register("ActionSet",ce,y.Versions.v1_2),g.GlobalRegistry.defaultElements.register("Input.Text",q),g.GlobalRegistry.defaultElements.register("Input.Date",Z),g.GlobalRegistry.defaultElements.register("Input.Time",X),g.GlobalRegistry.defaultElements.register("Input.Number",Y),g.GlobalRegistry.defaultElements.register("Input.ChoiceSet",$),g.GlobalRegistry.defaultElements.register("Input.Toggle",G),g.GlobalRegistry.defaultActions.register(re.JsonTypeName,re),g.GlobalRegistry.defaultActions.register(te.JsonTypeName,te),g.GlobalRegistry.defaultActions.register(le.JsonTypeName,le),g.GlobalRegistry.defaultActions.register(ie.JsonTypeName,ie,y.Versions.v1_2),g.GlobalRegistry.defaultActions.register(ne.JsonTypeName,ne,y.Versions.v1_4)},715:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var i,o=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__decorate||function(e,t,n,i){var o,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.CardObject=t.ValidationResults=void 0;var a=n(489),l=n(558),p=n(14),u=n(7),c=n(246),h=function(){function e(){this.allIds={},this.validationEvents=[]}return e.prototype.addFailure=function(e,t,n){this.validationEvents.push({phase:a.ValidationPhase.Validation,source:e,event:t,message:n})},e}();t.ValidationResults=h;var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._shouldFallback=!1,t}return o(t,e),t.prototype.getSchemaKey=function(){return this.getJsonTypeName()},Object.defineProperty(t.prototype,"requires",{get:function(){return this.getValue(t.requiresProperty)},enumerable:!1,configurable:!0}),t.prototype.contains=function(e){return!!this._renderedElement&&this._renderedElement.contains(e)},t.prototype.preProcessPropertyValue=function(e,t){var n=void 0===t?this.getValue(e):t;if(p.GlobalSettings.allowPreProcessingPropertyValues){for(var r=this;r&&!r.onPreProcessPropertyValue;)r=r.parent;if(r&&r.onPreProcessPropertyValue)return r.onPreProcessPropertyValue(this,e,n)}return n},t.prototype.setParent=function(e){this._parent=e},t.prototype.setShouldFallback=function(e){this._shouldFallback=e},t.prototype.shouldFallback=function(){return this._shouldFallback||!this.requires.areAllMet(this.hostConfig.hostCapabilities)},t.prototype.getRootObject=function(){for(var e=this;e.parent;)e=e.parent;return e},t.prototype.internalValidateProperties=function(e){this.id&&(e.allIds.hasOwnProperty(this.id)?(1===e.allIds[this.id]&&e.addFailure(this,a.ValidationEvent.DuplicateId,l.Strings.errors.duplicateId(this.id)),e.allIds[this.id]+=1):e.allIds[this.id]=1)},t.prototype.validateProperties=function(){var e=new h;return this.internalValidateProperties(e),e},t.prototype.findDOMNodeOwner=function(e){return this.contains(e)?this:void 0},t.prototype.releaseDOMResources=function(){},Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedElement",{get:function(){return this._renderedElement},enumerable:!1,configurable:!0}),t.typeNameProperty=new c.StringProperty(c.Versions.v1_0,"type",void 0,void 0,void 0,(function(e){return e.getJsonTypeName()})),t.idProperty=new c.StringProperty(c.Versions.v1_0,"id"),t.requiresProperty=new c.SerializableObjectProperty(c.Versions.v1_2,"requires",u.HostCapabilities,!1,new u.HostCapabilities),s([(0,c.property)(t.idProperty)],t.prototype,"id",void 0),s([(0,c.property)(t.requiresProperty)],t.prototype,"requires",null),t}(c.SerializableObject);t.CardObject=d},792:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelAdapter=void 0;var n=function(){};t.ChannelAdapter=n},850:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Collection=void 0;var n=function(){function e(){this._items=[]}return e.prototype.get=function(e){return this._items[e]},e.prototype.add=function(e){this._items.push(e),this.onItemAdded&&this.onItemAdded(e)},e.prototype.remove=function(e){var t=this._items.indexOf(e);t>=0&&(this._items=this._items.splice(t,1),this.onItemRemoved&&this.onItemRemoved(e))},e.prototype.indexOf=function(e){return this._items.indexOf(e)},Object.defineProperty(e.prototype,"length",{get:function(){return this._items.length},enumerable:!1,configurable:!0}),e}();t.Collection=n},371:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Constants=void 0;var n=function(){function e(){}return e.keys={tab:"Tab",enter:"Enter",escape:"Escape",space:" ",up:"ArrowUp",down:"ArrowDown",delete:"Delete"},e}();t.Constants=n},512:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(467),t),i(n(937),t)},467:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MenuItem=void 0;var r=n(611),i=n(371),o=function(){function e(e,t){this._isEnabled=!0,this.key=e,this._value=t}return e.prototype.click=function(){this.isEnabled&&this.onClick&&this.onClick(this)},e.prototype.updateCssClasses=function(){if(this._element){var e=this._hostConfig?this._hostConfig:r.defaultHostConfig;this._element.className=e.makeCssClassName("ac-ctrl"),this._element.classList.add(e.makeCssClassName(this.isEnabled?"ac-ctrl-dropdown-item":"ac-ctrl-dropdown-item-disabled")),this.isEnabled||this._element.classList.add(e.makeCssClassName("ac-disabled"))}},e.prototype.toString=function(){return this.value},e.prototype.render=function(e){var t=this;return this._hostConfig=e,this._element||(this._element=document.createElement("span"),this._element.innerText=this.value,this._element.setAttribute("role","menuitem"),this.isEnabled||this._element.setAttribute("aria-disabled","true"),this._element.setAttribute("aria-current","false"),this._element.onmouseup=function(e){t.click()},this._element.onkeydown=function(e){e.key===i.Constants.keys.enter&&(e.cancelBubble=!0,t.click())},this.updateCssClasses()),this._element},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e,this._element&&(this._element.innerText=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isEnabled",{get:function(){return this._isEnabled},set:function(e){this._isEnabled!==e&&(this._isEnabled=e,this.updateCssClasses())},enumerable:!1,configurable:!0}),e}();t.MenuItem=o},143:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PopupControl=void 0;var r=n(371),i=n(527),o=n(611),s=function(){function e(){this._isOpen=!1}return e.prototype.keyDown=function(e){if(e.key===r.Constants.keys.escape)this.closePopup(!0)},e.prototype.render=function(e){var t=this,n=document.createElement("div");return n.tabIndex=0,n.className=this.hostConfig.makeCssClassName("ac-ctrl","ac-ctrl-popup-container"),n.setAttribute("role","dialog"),n.setAttribute("aria-modal","true"),n.onkeydown=function(e){return t.keyDown(e),!e.cancelBubble},n.appendChild(this.renderContent()),n},e.prototype.focus=function(){this._popupElement&&this._popupElement.firstElementChild.focus()},e.prototype.popup=function(e){var t,n,r,o,s,a=this;if(!this._isOpen){this._overlayElement=document.createElement("div"),this._overlayElement.className=this.hostConfig.makeCssClassName("ac-ctrl-overlay"),this._overlayElement.tabIndex=0,this._overlayElement.style.width=document.documentElement.scrollWidth+"px",this._overlayElement.style.height=document.documentElement.scrollHeight+"px",this._overlayElement.onfocus=function(e){a.closePopup(!0)},document.body.appendChild(this._overlayElement);var l=e.getBoundingClientRect();this._popupElement=this.render(l),(t=this._popupElement.classList).remove.apply(t,this.hostConfig.makeCssClassNames("ac-ctrl-slide","ac-ctrl-slideLeftToRight","ac-ctrl-slideRightToLeft","ac-ctrl-slideTopToBottom","ac-ctrl-slideRightToLeft")),window.addEventListener("resize",(function(e){a.closePopup(!0)}));var p=e.getAttribute("aria-label");p&&this._popupElement.setAttribute("aria-label",p),this._overlayElement.appendChild(this._popupElement);var u,c=this._popupElement.getBoundingClientRect(),h=window.innerHeight-l.bottom,d=l.top,f=window.innerWidth-l.right,y=l.left,g=l.left+i.getScrollX();if(d<c.height&&h<c.height){var m=Math.min(c.height,window.innerHeight);if(this._popupElement.style.maxHeight=m+"px",u=m<c.height?i.getScrollY():i.getScrollY()+l.top+(l.height-m)/2,y<c.width&&f<c.width){var v=Math.min(c.width,window.innerWidth);this._popupElement.style.maxWidth=v+"px",g=v<c.width?i.getScrollX():i.getScrollX()+l.left+(l.width-v)/2}else f>=c.width?(g=i.getScrollX()+l.right,(n=this._popupElement.classList).add.apply(n,this.hostConfig.makeCssClassNames("ac-ctrl-slide","ac-ctrl-slideLeftToRight"))):(g=i.getScrollX()+l.left-c.width,(r=this._popupElement.classList).add.apply(r,this.hostConfig.makeCssClassNames("ac-ctrl-slide","ac-ctrl-slideRightToLeft")))}else h>=c.height?(u=i.getScrollY()+l.bottom,(o=this._popupElement.classList).add.apply(o,this.hostConfig.makeCssClassNames("ac-ctrl-slide","ac-ctrl-slideTopToBottom"))):(u=i.getScrollY()+l.top-c.height,(s=this._popupElement.classList).add.apply(s,this.hostConfig.makeCssClassNames("ac-ctrl-slide","ac-ctrl-slideBottomToTop"))),f<c.width&&(g=i.getScrollX()+l.right-c.width);this._popupElement.style.left=g+"px",this._popupElement.style.top=u+"px",this._popupElement.focus(),this._isOpen=!0}},e.prototype.closePopup=function(e){this._isOpen&&(document.body.removeChild(this._overlayElement),this._isOpen=!1,this.onClose&&this.onClose(this,e))},Object.defineProperty(e.prototype,"hostConfig",{get:function(){return this._hostConfig?this._hostConfig:o.defaultHostConfig},set:function(e){this._hostConfig=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isOpen",{get:function(){return this._isOpen},enumerable:!1,configurable:!0}),e}();t.PopupControl=s},937:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.PopupMenu=void 0;var o=n(371),s=n(850),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._items=new s.Collection,t._renderedItems=[],t._selectedIndex=-1,t}return i(t,e),t.prototype.renderContent=function(){var e=document.createElement("div");e.className=this.hostConfig.makeCssClassName("ac-ctrl ac-popup"),e.setAttribute("role","listbox");for(var t=0;t<this._items.length;t++){var n=this._items.get(t).render(this.hostConfig);n.tabIndex=0,e.appendChild(n),t===this.selectedIndex&&n.focus(),this._renderedItems.push(n)}return e},t.prototype.keyDown=function(t){e.prototype.keyDown.call(this,t);var n=this._selectedIndex;switch(t.key){case o.Constants.keys.tab:this.closePopup(!0);break;case o.Constants.keys.up:(n<=0||--n<0)&&(n=this._renderedItems.length-1),this.selectedIndex=n,t.cancelBubble=!0;break;case o.Constants.keys.down:(n<0||++n>=this._renderedItems.length)&&(n=0),this.selectedIndex=n,t.cancelBubble=!0}},Object.defineProperty(t.prototype,"items",{get:function(){return this._items},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(e){e>=0&&e<this._renderedItems.length&&(this._renderedItems[e].focus(),this._selectedIndex=e)},enumerable:!1,configurable:!0}),t}(n(143).PopupControl);t.PopupMenu=a},489:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogLevel=t.RefreshMode=t.TypeErrorType=t.ContainerFitStatus=t.ValidationEvent=t.ValidationPhase=t.InputTextStyle=t.ActionIconPlacement=t.FillMode=t.Orientation=t.ShowCardActionMode=t.ImageStyle=t.ActionAlignment=t.VerticalAlignment=t.HorizontalAlignment=t.TextColor=t.Spacing=t.FontType=t.TextWeight=t.TextSize=t.SizeUnit=t.ImageSize=t.Size=t.ActionMode=t.ActionStyle=t.ContainerStyle=void 0;var n=function(){function e(){}return e.Default="default",e.Emphasis="emphasis",e.Accent="accent",e.Good="good",e.Attention="attention",e.Warning="warning",e}();t.ContainerStyle=n;var r=function(){function e(){}return e.Default="default",e.Positive="positive",e.Destructive="destructive",e}();t.ActionStyle=r;var i=function(){function e(){}return e.Primary="primary",e.Secondary="secondary",e}();t.ActionMode=i,function(e){e[e.Auto=0]="Auto",e[e.Stretch=1]="Stretch",e[e.Small=2]="Small",e[e.Medium=3]="Medium",e[e.Large=4]="Large"}(t.Size||(t.Size={})),function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large"}(t.ImageSize||(t.ImageSize={})),function(e){e[e.Weight=0]="Weight",e[e.Pixel=1]="Pixel"}(t.SizeUnit||(t.SizeUnit={})),function(e){e[e.Small=0]="Small",e[e.Default=1]="Default",e[e.Medium=2]="Medium",e[e.Large=3]="Large",e[e.ExtraLarge=4]="ExtraLarge"}(t.TextSize||(t.TextSize={})),function(e){e[e.Lighter=0]="Lighter",e[e.Default=1]="Default",e[e.Bolder=2]="Bolder"}(t.TextWeight||(t.TextWeight={})),function(e){e[e.Default=0]="Default",e[e.Monospace=1]="Monospace"}(t.FontType||(t.FontType={})),function(e){e[e.None=0]="None",e[e.Small=1]="Small",e[e.Default=2]="Default",e[e.Medium=3]="Medium",e[e.Large=4]="Large",e[e.ExtraLarge=5]="ExtraLarge",e[e.Padding=6]="Padding"}(t.Spacing||(t.Spacing={})),function(e){e[e.Default=0]="Default",e[e.Dark=1]="Dark",e[e.Light=2]="Light",e[e.Accent=3]="Accent",e[e.Good=4]="Good",e[e.Warning=5]="Warning",e[e.Attention=6]="Attention"}(t.TextColor||(t.TextColor={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right"}(t.HorizontalAlignment||(t.HorizontalAlignment={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Bottom=2]="Bottom"}(t.VerticalAlignment||(t.VerticalAlignment={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",e[e.Stretch=3]="Stretch"}(t.ActionAlignment||(t.ActionAlignment={})),function(e){e[e.Default=0]="Default",e[e.Person=1]="Person"}(t.ImageStyle||(t.ImageStyle={})),function(e){e[e.Inline=0]="Inline",e[e.Popup=1]="Popup"}(t.ShowCardActionMode||(t.ShowCardActionMode={})),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(t.Orientation||(t.Orientation={})),function(e){e[e.Cover=0]="Cover",e[e.RepeatHorizontally=1]="RepeatHorizontally",e[e.RepeatVertically=2]="RepeatVertically",e[e.Repeat=3]="Repeat"}(t.FillMode||(t.FillMode={})),function(e){e[e.LeftOfTitle=0]="LeftOfTitle",e[e.AboveTitle=1]="AboveTitle"}(t.ActionIconPlacement||(t.ActionIconPlacement={})),function(e){e[e.Text=0]="Text",e[e.Tel=1]="Tel",e[e.Url=2]="Url",e[e.Email=3]="Email",e[e.Password=4]="Password"}(t.InputTextStyle||(t.InputTextStyle={})),function(e){e[e.Parse=0]="Parse",e[e.ToJSON=1]="ToJSON",e[e.Validation=2]="Validation"}(t.ValidationPhase||(t.ValidationPhase={})),function(e){e[e.Hint=0]="Hint",e[e.ActionTypeNotAllowed=1]="ActionTypeNotAllowed",e[e.CollectionCantBeEmpty=2]="CollectionCantBeEmpty",e[e.Deprecated=3]="Deprecated",e[e.ElementTypeNotAllowed=4]="ElementTypeNotAllowed",e[e.InteractivityNotAllowed=5]="InteractivityNotAllowed",e[e.InvalidPropertyValue=6]="InvalidPropertyValue",e[e.MissingCardType=7]="MissingCardType",e[e.PropertyCantBeNull=8]="PropertyCantBeNull",e[e.TooManyActions=9]="TooManyActions",e[e.UnknownActionType=10]="UnknownActionType",e[e.UnknownElementType=11]="UnknownElementType",e[e.UnsupportedCardVersion=12]="UnsupportedCardVersion",e[e.DuplicateId=13]="DuplicateId",e[e.UnsupportedProperty=14]="UnsupportedProperty",e[e.RequiredInputsShouldHaveLabel=15]="RequiredInputsShouldHaveLabel",e[e.RequiredInputsShouldHaveErrorMessage=16]="RequiredInputsShouldHaveErrorMessage",e[e.Other=17]="Other"}(t.ValidationEvent||(t.ValidationEvent={})),function(e){e[e.FullyInContainer=0]="FullyInContainer",e[e.Overflowing=1]="Overflowing",e[e.FullyOutOfContainer=2]="FullyOutOfContainer"}(t.ContainerFitStatus||(t.ContainerFitStatus={})),function(e){e[e.UnknownType=0]="UnknownType",e[e.ForbiddenType=1]="ForbiddenType"}(t.TypeErrorType||(t.TypeErrorType={})),function(e){e[e.Disabled=0]="Disabled",e[e.Manual=1]="Manual",e[e.Automatic=2]="Automatic"}(t.RefreshMode||(t.RefreshMode={})),function(e){e[e.Info=0]="Info",e[e.Warning=1]="Warning",e[e.Error=2]="Error"}(t.LogLevel||(t.LogLevel={}))},7:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.HostCapabilities=void 0;var o=n(246),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._capabilities={},t}return i(t,e),t.prototype.getSchemaKey=function(){return"HostCapabilities"},t.prototype.internalParse=function(t,n){if(e.prototype.internalParse.call(this,t,n),t)for(var r in t){var i=t[r];if("string"==typeof i)if("*"===i)this.addCapability(r,"*");else{var s=o.Version.parse(i,n);(null==s?void 0:s.isValid)&&this.addCapability(r,s)}}},t.prototype.internalToJSON=function(t,n){for(var r in e.prototype.internalToJSON.call(this,t,n),this._capabilities)t[r]=this._capabilities[r]},t.prototype.addCapability=function(e,t){this._capabilities[e]=t},t.prototype.removeCapability=function(e){delete this._capabilities[e]},t.prototype.clear=function(){this._capabilities={}},t.prototype.hasCapability=function(e,t){return!!this._capabilities.hasOwnProperty(e)&&("*"===t||"*"===this._capabilities[e]||t.compareTo(this._capabilities[e])<=0)},t.prototype.areAllMet=function(e){for(var t in this._capabilities)if(!e.hasCapability(t,this._capabilities[t]))return!1;return!0},t}(o.SerializableObject);t.HostCapabilities=s},611:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.defaultHostConfig=t.HostConfig=t.FontTypeSet=t.FontTypeDefinition=t.ContainerStyleSet=t.ContainerStyleDefinition=t.ColorSetDefinition=t.ActionsConfig=t.ShowCardActionConfig=t.FactSetConfig=t.FactTitleDefinition=t.FactTextDefinition=t.InputConfig=t.InputLabelConfig=t.RequiredInputLabelTextDefinition=t.TextBlockConfig=t.TextStyleSet=t.TextStyleDefinition=t.BaseTextDefinition=t.TableConfig=t.MediaConfig=t.ImageSetConfig=t.AdaptiveCardConfig=t.TextColorDefinition=t.ColorDefinition=void 0;var o=n(489),s=n(527),a=n(14),l=n(7);function p(e,t,n){if("string"==typeof t){var r=s.parseEnum(e,t,n);return void 0!==r?r:n}return"number"==typeof t?t:n}var u=function(){function e(e,t){this.default="#000000",this.subtle="#666666",e&&(this.default=e),t&&(this.subtle=t)}return e.prototype.parse=function(e){e&&(this.default=e.default||this.default,this.subtle=e.subtle||this.subtle)},e}();t.ColorDefinition=u;var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.highlightColors=new u("#22000000","#11000000"),t}return i(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&this.highlightColors.parse(t.highlightColors)},t}(u);t.TextColorDefinition=c;var h=function(e){this.allowCustomStyle=!1,e&&(this.allowCustomStyle=e.allowCustomStyle||this.allowCustomStyle)};t.AdaptiveCardConfig=h;var d=function(){function e(e){this.imageSize=o.Size.Medium,this.maxImageHeight=100,e&&(this.imageSize=null!=e.imageSize?e.imageSize:this.imageSize,this.maxImageHeight=s.parseNumber(e.maxImageHeight,100))}return e.prototype.toJSON=function(){return{imageSize:o.Size[this.imageSize],maxImageHeight:this.maxImageHeight}},e}();t.ImageSetConfig=d;var f=function(){function e(e){this.allowInlinePlayback=!0,e&&(this.defaultPoster=e.defaultPoster,this.allowInlinePlayback=e.allowInlinePlayback||this.allowInlinePlayback)}return e.prototype.toJSON=function(){return{defaultPoster:this.defaultPoster,allowInlinePlayback:this.allowInlinePlayback}},e}();t.MediaConfig=f;var y=function(){function e(e){this.cellSpacing=8,e&&(this.cellSpacing=e.cellSpacing&&"number"==typeof e.cellSpacing?e.cellSpacing:this.cellSpacing)}return e.prototype.toJSON=function(){return{cellSpacing:this.cellSpacing}},e}();t.TableConfig=y;var g=function(){function e(e){this.size=o.TextSize.Default,this.color=o.TextColor.Default,this.isSubtle=!1,this.weight=o.TextWeight.Default,this.parse(e)}return e.prototype.parse=function(e){e&&(this.size=p(o.TextSize,e.size,this.size),this.color=p(o.TextColor,e.color,this.color),this.isSubtle=void 0!==e.isSubtle&&"boolean"==typeof e.isSubtle?e.isSubtle:this.isSubtle,this.weight=p(o.TextWeight,e.weight,this.getDefaultWeight()))},e.prototype.getDefaultWeight=function(){return o.TextWeight.Default},e.prototype.toJSON=function(){return{size:o.TextSize[this.size],color:o.TextColor[this.color],isSubtle:this.isSubtle,weight:o.TextWeight[this.weight]}},e}();t.BaseTextDefinition=g;var m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fontType=o.FontType.Default,t}return i(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&(this.fontType=p(o.FontType,t.fontType,this.fontType))},t}(g);t.TextStyleDefinition=m;var v=function(){function e(e){this.default=new m,this.heading=new m({size:"Large",weight:"Bolder"}),this.columnHeader=new m({weight:"Bolder"}),e&&(this.heading.parse(e.heading),this.columnHeader.parse(e.columnHeader))}return e.prototype.getStyleByName=function(e){switch(e.toLowerCase()){case"heading":return this.heading;case"columnHeader":return this.columnHeader;default:return this.default}},e}();t.TextStyleSet=v;var b=function(e){e&&(this.headingLevel=s.parseNumber(e.headingLevel))};t.TextBlockConfig=b;var _=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.suffix=" *",t.suffixColor=o.TextColor.Attention,t}return i(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&(this.suffix=t.suffix||this.suffix,this.suffixColor=p(o.TextColor,t.suffixColor,this.suffixColor))},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.suffix=this.suffix,t.suffixColor=o.TextColor[this.suffixColor],t},t}(g);t.RequiredInputLabelTextDefinition=_;var C=function(e){this.inputSpacing=o.Spacing.Small,this.requiredInputs=new _,this.optionalInputs=new g,e&&(this.inputSpacing=p(o.Spacing,e.inputSpacing,this.inputSpacing),this.requiredInputs=new _(e.requiredInputs),this.optionalInputs=new g(e.optionalInputs))};t.InputLabelConfig=C;var S=function(e){this.label=new C,this.errorMessage=new g({color:o.TextColor.Attention}),e&&(this.label=new C(e.label),this.errorMessage=new g(e.errorMessage))};t.InputConfig=S;var A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.wrap=!0,t}return i(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&(this.wrap=null!=t.wrap?t.wrap:this.wrap)},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.wrap=this.wrap,t},t}(g);t.FactTextDefinition=A;var w=function(e){function t(t){var n=e.call(this,t)||this;return n.maxWidth=150,n.weight=o.TextWeight.Bolder,t&&(n.maxWidth=null!=t.maxWidth?t.maxWidth:n.maxWidth,n.weight=p(o.TextWeight,t.weight,o.TextWeight.Bolder)),n}return i(t,e),t.prototype.getDefaultWeight=function(){return o.TextWeight.Bolder},t}(A);t.FactTitleDefinition=w;var E=function(e){this.title=new w,this.value=new A,this.spacing=10,e&&(this.title=new w(e.title),this.value=new A(e.value),this.spacing=e.spacing&&null!=e.spacing?e.spacing&&e.spacing:this.spacing)};t.FactSetConfig=E;var P=function(){function e(e){this.actionMode=o.ShowCardActionMode.Inline,this.inlineTopMargin=16,this.style=o.ContainerStyle.Emphasis,e&&(this.actionMode=p(o.ShowCardActionMode,e.actionMode,o.ShowCardActionMode.Inline),this.inlineTopMargin=null!=e.inlineTopMargin?e.inlineTopMargin:this.inlineTopMargin,this.style=e.style&&"string"==typeof e.style?e.style:o.ContainerStyle.Emphasis)}return e.prototype.toJSON=function(){return{actionMode:o.ShowCardActionMode[this.actionMode],inlineTopMargin:this.inlineTopMargin,style:this.style}},e}();t.ShowCardActionConfig=P;var x=function(){function e(e){if(this.maxActions=5,this.spacing=o.Spacing.Default,this.buttonSpacing=20,this.showCard=new P,this.preExpandSingleShowCardAction=!1,this.actionsOrientation=o.Orientation.Horizontal,this.actionAlignment=o.ActionAlignment.Left,this.iconPlacement=o.ActionIconPlacement.LeftOfTitle,this.allowTitleToWrap=!1,this.iconSize=16,e){this.maxActions=null!=e.maxActions?e.maxActions:this.maxActions,this.spacing=p(o.Spacing,e.spacing&&e.spacing,o.Spacing.Default),this.buttonSpacing=null!=e.buttonSpacing?e.buttonSpacing:this.buttonSpacing,this.showCard=new P(e.showCard),this.preExpandSingleShowCardAction=s.parseBool(e.preExpandSingleShowCardAction,!1),this.actionsOrientation=p(o.Orientation,e.actionsOrientation,o.Orientation.Horizontal),this.actionAlignment=p(o.ActionAlignment,e.actionAlignment,o.ActionAlignment.Left),this.iconPlacement=p(o.ActionIconPlacement,e.iconPlacement,o.ActionIconPlacement.LeftOfTitle),this.allowTitleToWrap=null!=e.allowTitleToWrap?e.allowTitleToWrap:this.allowTitleToWrap;try{var t=a.SizeAndUnit.parse(e.iconSize);t.unit===o.SizeUnit.Pixel&&(this.iconSize=t.physicalSize)}catch(e){}}}return e.prototype.toJSON=function(){return{maxActions:this.maxActions,spacing:o.Spacing[this.spacing],buttonSpacing:this.buttonSpacing,showCard:this.showCard,preExpandSingleShowCardAction:this.preExpandSingleShowCardAction,actionsOrientation:o.Orientation[this.actionsOrientation],actionAlignment:o.ActionAlignment[this.actionAlignment]}},e}();t.ActionsConfig=x;var k=function(){function e(e){this.default=new c,this.dark=new c,this.light=new c,this.accent=new c,this.good=new c,this.warning=new c,this.attention=new c,this.parse(e)}return e.prototype.parseSingleColor=function(e,t){e&&this[t].parse(e[t])},e.prototype.parse=function(e){e&&(this.parseSingleColor(e,"default"),this.parseSingleColor(e,"dark"),this.parseSingleColor(e,"light"),this.parseSingleColor(e,"accent"),this.parseSingleColor(e,"good"),this.parseSingleColor(e,"warning"),this.parseSingleColor(e,"attention"))},e}();t.ColorSetDefinition=k;var I=function(){function e(e){this.foregroundColors=new k({default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#E69500",subtle:"#DDE69500"},attention:{default:"#CC3300",subtle:"#DDCC3300"}}),this.parse(e)}return e.prototype.parse=function(e){e&&(this.backgroundColor=e.backgroundColor,this.foregroundColors.parse(e.foregroundColors),this.highlightBackgroundColor=e.highlightBackgroundColor,this.highlightForegroundColor=e.highlightForegroundColor,this.borderColor=e.borderColor)},Object.defineProperty(e.prototype,"isBuiltIn",{get:function(){return!1},enumerable:!1,configurable:!0}),e}();t.ContainerStyleDefinition=I;var T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"isBuiltIn",{get:function(){return!0},enumerable:!1,configurable:!0}),t}(I),O=function(){function e(e){if(this._allStyles={},this._allStyles[o.ContainerStyle.Default]=new T,this._allStyles[o.ContainerStyle.Emphasis]=new T,this._allStyles[o.ContainerStyle.Accent]=new T,this._allStyles[o.ContainerStyle.Good]=new T,this._allStyles[o.ContainerStyle.Attention]=new T,this._allStyles[o.ContainerStyle.Warning]=new T,e){this._allStyles[o.ContainerStyle.Default].parse(e[o.ContainerStyle.Default]),this._allStyles[o.ContainerStyle.Emphasis].parse(e[o.ContainerStyle.Emphasis]),this._allStyles[o.ContainerStyle.Accent].parse(e[o.ContainerStyle.Accent]),this._allStyles[o.ContainerStyle.Good].parse(e[o.ContainerStyle.Good]),this._allStyles[o.ContainerStyle.Attention].parse(e[o.ContainerStyle.Attention]),this._allStyles[o.ContainerStyle.Warning].parse(e[o.ContainerStyle.Warning]);var t=e.customStyles;if(t&&Array.isArray(t))for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i){var s=i.name;s&&"string"==typeof s&&(this._allStyles.hasOwnProperty(s)?this._allStyles[s].parse(i.style):this._allStyles[s]=new I(i.style))}}}}return e.prototype.toJSON=function(){var e=this,t=[];Object.keys(this._allStyles).forEach((function(n){e._allStyles[n].isBuiltIn||t.push({name:n,style:e._allStyles[n]})}));var n={default:this.default,emphasis:this.emphasis};return t.length>0&&(n.customStyles=t),n},e.prototype.getStyleByName=function(e,t){return e&&this._allStyles.hasOwnProperty(e)?this._allStyles[e]:t||this._allStyles[o.ContainerStyle.Default]},Object.defineProperty(e.prototype,"default",{get:function(){return this._allStyles[o.ContainerStyle.Default]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"emphasis",{get:function(){return this._allStyles[o.ContainerStyle.Emphasis]},enumerable:!1,configurable:!0}),e}();t.ContainerStyleSet=O;var V=function(){function e(e){this.fontFamily="Segoe UI,Segoe,Segoe WP,Helvetica Neue,Helvetica,sans-serif",this.fontSizes={small:12,default:14,medium:17,large:21,extraLarge:26},this.fontWeights={lighter:200,default:400,bolder:600},e&&(this.fontFamily=e)}return e.prototype.parse=function(e){this.fontFamily=e.fontFamily||this.fontFamily,this.fontSizes={small:e.fontSizes&&e.fontSizes.small||this.fontSizes.small,default:e.fontSizes&&e.fontSizes.default||this.fontSizes.default,medium:e.fontSizes&&e.fontSizes.medium||this.fontSizes.medium,large:e.fontSizes&&e.fontSizes.large||this.fontSizes.large,extraLarge:e.fontSizes&&e.fontSizes.extraLarge||this.fontSizes.extraLarge},this.fontWeights={lighter:e.fontWeights&&e.fontWeights.lighter||this.fontWeights.lighter,default:e.fontWeights&&e.fontWeights.default||this.fontWeights.default,bolder:e.fontWeights&&e.fontWeights.bolder||this.fontWeights.bolder}},e.monospace=new e("'Courier New', Courier, monospace"),e}();t.FontTypeDefinition=V;var M=function(){function e(e){this.default=new V,this.monospace=new V("'Courier New', Courier, monospace"),e&&(this.default.parse(e.default),this.monospace.parse(e.monospace))}return e.prototype.getStyleDefinition=function(e){switch(e){case o.FontType.Monospace:return this.monospace;case o.FontType.Default:default:return this.default}},e}();t.FontTypeSet=M;var N=function(){function e(e){this.hostCapabilities=new l.HostCapabilities,this.choiceSetInputValueSeparator=",",this.supportsInteractivity=!0,this.spacing={small:3,default:8,medium:20,large:30,extraLarge:40,padding:15},this.separator={lineThickness:1,lineColor:"#EEEEEE"},this.imageSizes={small:40,medium:80,large:160},this.containerStyles=new O,this.inputs=new S,this.actions=new x,this.adaptiveCard=new h,this.imageSet=new d,this.media=new f,this.factSet=new E,this.table=new y,this.textStyles=new v,this.textBlock=new b,this.alwaysAllowBleed=!1,e&&(("string"==typeof e||e instanceof String)&&(e=JSON.parse(e)),this.choiceSetInputValueSeparator=e&&"string"==typeof e.choiceSetInputValueSeparator?e.choiceSetInputValueSeparator:this.choiceSetInputValueSeparator,this.supportsInteractivity=e&&"boolean"==typeof e.supportsInteractivity?e.supportsInteractivity:this.supportsInteractivity,this._legacyFontType=new V,this._legacyFontType.parse(e),e.fontTypes&&(this.fontTypes=new M(e.fontTypes)),e.lineHeights&&(this.lineHeights={small:e.lineHeights.small,default:e.lineHeights.default,medium:e.lineHeights.medium,large:e.lineHeights.large,extraLarge:e.lineHeights.extraLarge}),this.imageSizes={small:e.imageSizes&&e.imageSizes.small||this.imageSizes.small,medium:e.imageSizes&&e.imageSizes.medium||this.imageSizes.medium,large:e.imageSizes&&e.imageSizes.large||this.imageSizes.large},this.containerStyles=new O(e.containerStyles),this.spacing={small:e.spacing&&e.spacing.small||this.spacing.small,default:e.spacing&&e.spacing.default||this.spacing.default,medium:e.spacing&&e.spacing.medium||this.spacing.medium,large:e.spacing&&e.spacing.large||this.spacing.large,extraLarge:e.spacing&&e.spacing.extraLarge||this.spacing.extraLarge,padding:e.spacing&&e.spacing.padding||this.spacing.padding},this.separator={lineThickness:e.separator&&e.separator.lineThickness||this.separator.lineThickness,lineColor:e.separator&&e.separator.lineColor||this.separator.lineColor},this.inputs=new S(e.inputs||this.inputs),this.actions=new x(e.actions||this.actions),this.adaptiveCard=new h(e.adaptiveCard||this.adaptiveCard),this.imageSet=new d(e.imageSet),this.factSet=new E(e.factSet),this.textStyles=new v(e.textStyles),this.textBlock=new b(e.textBlock))}return e.prototype.getFontTypeDefinition=function(e){return this.fontTypes?this.fontTypes.getStyleDefinition(e):e===o.FontType.Monospace?V.monospace:this._legacyFontType},e.prototype.getEffectiveSpacing=function(e){switch(e){case o.Spacing.Small:return this.spacing.small;case o.Spacing.Default:return this.spacing.default;case o.Spacing.Medium:return this.spacing.medium;case o.Spacing.Large:return this.spacing.large;case o.Spacing.ExtraLarge:return this.spacing.extraLarge;case o.Spacing.Padding:return this.spacing.padding;default:return 0}},e.prototype.paddingDefinitionToSpacingDefinition=function(e){return new a.SpacingDefinition(this.getEffectiveSpacing(e.top),this.getEffectiveSpacing(e.right),this.getEffectiveSpacing(e.bottom),this.getEffectiveSpacing(e.left))},e.prototype.makeCssClassNames=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],r=0,i=e;r<i.length;r++){var o=i[r];n.push((this.cssClassNamePrefix?this.cssClassNamePrefix+"-":"")+o)}return n},e.prototype.makeCssClassName=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.makeCssClassNames.apply(this,e).join(" ");return n||""},Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this._legacyFontType.fontFamily},set:function(e){this._legacyFontType.fontFamily=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSizes",{get:function(){return this._legacyFontType.fontSizes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontWeights",{get:function(){return this._legacyFontType.fontWeights},enumerable:!1,configurable:!0}),e}();t.HostConfig=N,t.defaultHostConfig=new N({supportsInteractivity:!0,spacing:{small:10,default:20,medium:30,large:40,extraLarge:50,padding:20},separator:{lineThickness:1,lineColor:"#EEEEEE"},fontTypes:{default:{fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}},monospace:{fontFamily:"'Courier New', Courier, monospace",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}}},imageSizes:{small:40,medium:80,large:160},containerStyles:{default:{backgroundColor:"#FFFFFF",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},emphasis:{backgroundColor:"#08000000",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},accent:{backgroundColor:"#C7DEF9",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},good:{backgroundColor:"#CCFFCC",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},attention:{backgroundColor:"#FFC5B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},warning:{backgroundColor:"#FFE2B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}}},inputs:{label:{requiredInputs:{weight:o.TextWeight.Bolder,suffix:" *",suffixColor:o.TextColor.Attention},optionalInputs:{weight:o.TextWeight.Bolder}},errorMessage:{color:o.TextColor.Attention,weight:o.TextWeight.Bolder}},actions:{maxActions:5,spacing:o.Spacing.Default,buttonSpacing:10,showCard:{actionMode:o.ShowCardActionMode.Inline,inlineTopMargin:16},actionsOrientation:o.Orientation.Horizontal,actionAlignment:o.ActionAlignment.Left},adaptiveCard:{allowCustomStyle:!1},imageSet:{imageSize:o.Size.Medium,maxImageHeight:100},factSet:{title:{color:o.TextColor.Default,size:o.TextSize.Default,isSubtle:!1,weight:o.TextWeight.Bolder,wrap:!0,maxWidth:150},value:{color:o.TextColor.Default,size:o.TextSize.Default,isSubtle:!1,weight:o.TextWeight.Default,wrap:!0},spacing:10}})},885:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalRegistry=t.CardObjectRegistry=t.ElementSingletonBehavior=void 0;var r,i=n(246);!function(e){e[e.Only=0]="Only",e[e.Allowed=1]="Allowed",e[e.NotAllowed=2]="NotAllowed"}(r=t.ElementSingletonBehavior||(t.ElementSingletonBehavior={}));var o=function(){function e(){this._items={}}return e.prototype.findByName=function(e){return this._items.hasOwnProperty(e)?this._items[e]:void 0},e.prototype.clear=function(){this._items={}},e.prototype.copyTo=function(e){for(var t=0,n=Object.keys(this._items);t<n.length;t++){var r=n[t],i=this._items[r];e.register(i.typeName,i.objectType,i.schemaVersion,i.singletonBehavior)}},e.prototype.register=function(e,t,n,o){void 0===n&&(n=i.Versions.v1_0),void 0===o&&(o=r.NotAllowed);var s=this.findByName(e);void 0!==s?s.objectType=t:s={typeName:e,objectType:t,schemaVersion:n,singletonBehavior:o},this._items[e]=s},e.prototype.unregister=function(e){delete this._items[e]},e.prototype.createInstance=function(e,t){var n=this.findByName(e);return n&&n.schemaVersion.compareTo(t)<=0?new n.objectType:void 0},e.prototype.getItemCount=function(){return Object.keys(this._items).length},e.prototype.getItemAt=function(e){var t=this;return Object.keys(this._items).map((function(e){return t._items[e]}))[e]},e}();t.CardObjectRegistry=o;var s=function(){function e(){}return e.populateWithDefaultElements=function(t){t.clear(),e.defaultElements.copyTo(t)},e.populateWithDefaultActions=function(t){t.clear(),e.defaultActions.copyTo(t)},Object.defineProperty(e,"elements",{get:function(){return e._elements||(e._elements=new o,e.populateWithDefaultElements(e._elements)),e._elements},enumerable:!1,configurable:!0}),Object.defineProperty(e,"actions",{get:function(){return e._actions||(e._actions=new o,e.populateWithDefaultActions(e._actions)),e._actions},enumerable:!1,configurable:!0}),e.reset=function(){e._elements=void 0,e._actions=void 0},e.defaultElements=new o,e.defaultActions=new o,e}();t.GlobalRegistry=s},246:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var i,o=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.SerializableObject=t.property=t.SerializableObjectSchema=t.CustomProperty=t.SerializableObjectCollectionProperty=t.SerializableObjectProperty=t.EnumProperty=t.ValueSetProperty=t.StringArrayProperty=t.PixelSizeProperty=t.NumProperty=t.BoolProperty=t.StringProperty=t.PropertyDefinition=t.BaseSerializationContext=t.isVersionLessOrEqual=t.Versions=t.Version=void 0;var s=n(14),a=n(527),l=n(489),p=n(558),u=function(){function e(e,t,n){void 0===e&&(e=1),void 0===t&&(t=1),this._isValid=!0,this._major=e,this._minor=t,this._label=n}return e.parse=function(t,n){if(t){var r=new e;r._versionString=t;var i=/(\d+).(\d+)/gi.exec(t);return null!=i&&3===i.length?(r._major=parseInt(i[1]),r._minor=parseInt(i[2])):r._isValid=!1,r._isValid||n.logParseEvent(void 0,l.ValidationEvent.InvalidPropertyValue,p.Strings.errors.invalidVersionString(r._versionString)),r}},e.prototype.toString=function(){return this._isValid?this._major+"."+this._minor:this._versionString},e.prototype.toJSON=function(){return this.toString()},e.prototype.compareTo=function(e){if(!this.isValid||!e.isValid)throw new Error("Cannot compare invalid version.");return this.major>e.major?1:this.major<e.major?-1:this.minor>e.minor?1:this.minor<e.minor?-1:0},Object.defineProperty(e.prototype,"label",{get:function(){return this._label?this._label:this.toString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"major",{get:function(){return this._major},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minor",{get:function(){return this._minor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isValid",{get:function(){return this._isValid},enumerable:!1,configurable:!0}),e}();t.Version=u;var c=function(){function e(){}return e.getAllDeclaredVersions=function(){var t=e,n=[];for(var r in t)if(r.match(/^v[0-9_]*$/))try{var i=t[r];i instanceof u&&n.push(i)}catch(e){}return n.sort((function(e,t){return e.compareTo(t)}))},e.v1_0=new u(1,0),e.v1_1=new u(1,1),e.v1_2=new u(1,2),e.v1_3=new u(1,3),e.v1_4=new u(1,4),e.v1_5=new u(1,5),e.v1_6=new u(1,6,"1.6 Preview"),e.latest=e.v1_5,e}();t.Versions=c,t.isVersionLessOrEqual=function(e,t){return!(e instanceof u)||(!(t instanceof u)||t.compareTo(e)>=0)};var h=function(){function e(e){void 0===e&&(e=c.latest),this._validationEvents=[],this.targetVersion=e}return e.prototype.serializeValue=function(e,t,n,r,i){void 0===r&&(r=void 0),void 0===i&&(i=!1),null==n||n===r?s.GlobalSettings.enableFullJsonRoundTrip&&!i||delete e[t]:n===r?delete e[t]:e[t]=n},e.prototype.serializeString=function(e,t,n,r){null==n||n===r?s.GlobalSettings.enableFullJsonRoundTrip||delete e[t]:e[t]=n},e.prototype.serializeBool=function(e,t,n,r){null==n||n===r?s.GlobalSettings.enableFullJsonRoundTrip||delete e[t]:e[t]=n},e.prototype.serializeNumber=function(e,t,n,r){null==n||n===r||isNaN(n)?s.GlobalSettings.enableFullJsonRoundTrip||delete e[t]:e[t]=n},e.prototype.serializeEnum=function(e,t,n,r,i){void 0===i&&(i=void 0),null==r||r===i?s.GlobalSettings.enableFullJsonRoundTrip||delete t[n]:t[n]=e[r]},e.prototype.serializeArray=function(e,t,n){var r=[];if(n)for(var i=0,o=n;i<o.length;i++){var s=o[i],a=void 0;void 0!==(a=s instanceof P?s.toJSON(this):s.toJSON?s.toJSON():s)&&r.push(a)}0===r.length?e.hasOwnProperty(t)&&Array.isArray(e[t])&&delete e[t]:this.serializeValue(e,t,r)},e.prototype.clearEvents=function(){this._validationEvents=[]},e.prototype.logEvent=function(e,t,n,r){this._validationEvents.push({source:e,phase:t,event:n,message:r})},e.prototype.logParseEvent=function(e,t,n){this.logEvent(e,l.ValidationPhase.Parse,t,n)},e.prototype.getEventAt=function(e){return this._validationEvents[e]},Object.defineProperty(e.prototype,"eventCount",{get:function(){return this._validationEvents.length},enumerable:!1,configurable:!0}),e}();t.BaseSerializationContext=h;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t}(h),f=function(){function e(t,n,r,i){this.targetVersion=t,this.name=n,this.defaultValue=r,this.onGetInitialValue=i,this.isSerializationEnabled=!0,this.sequentialNumber=e._sequentialNumber,e._sequentialNumber++}return e.prototype.getInternalName=function(){return this.name},e.prototype.parse=function(e,t,n){return t[this.name]},e.prototype.toJSON=function(e,t,n,r){r.serializeValue(t,this.name,n,this.defaultValue)},e._sequentialNumber=0,e}();t.PropertyDefinition=f;var y=function(e){function t(t,n,r,i,o,s){void 0===r&&(r=!0);var a=e.call(this,t,n,o,s)||this;return a.targetVersion=t,a.name=n,a.treatEmptyAsUndefined=r,a.regEx=i,a.defaultValue=o,a.onGetInitialValue=s,a}return o(t,e),t.prototype.parse=function(e,t,n){var r=a.parseString(t[this.name],this.defaultValue);if(!(void 0===r||""===r&&this.treatEmptyAsUndefined)&&void 0!==this.regEx&&!this.regEx.exec(r))return void n.logParseEvent(e,l.ValidationEvent.InvalidPropertyValue,p.Strings.errors.invalidPropertyValue(r,this.name));return r},t.prototype.toJSON=function(e,t,n,r){r.serializeString(t,this.name,""===n&&this.treatEmptyAsUndefined?void 0:n,this.defaultValue)},t}(f);t.StringProperty=y;var g=function(e){function t(t,n,r,i){var o=e.call(this,t,n,r,i)||this;return o.targetVersion=t,o.name=n,o.defaultValue=r,o.onGetInitialValue=i,o}return o(t,e),t.prototype.parse=function(e,t,n){return a.parseBool(t[this.name],this.defaultValue)},t.prototype.toJSON=function(e,t,n,r){r.serializeBool(t,this.name,n,this.defaultValue)},t}(f);t.BoolProperty=g;var m=function(e){function t(t,n,r,i){var o=e.call(this,t,n,r,i)||this;return o.targetVersion=t,o.name=n,o.defaultValue=r,o.onGetInitialValue=i,o}return o(t,e),t.prototype.parse=function(e,t,n){return a.parseNumber(t[this.name],this.defaultValue)},t.prototype.toJSON=function(e,t,n,r){r.serializeNumber(t,this.name,n,this.defaultValue)},t}(f);t.NumProperty=m;var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.parse=function(e,t,n){var r=void 0,i=t[this.name];if("string"==typeof i){var o=!1;try{var a=s.SizeAndUnit.parse(i,!0);a.unit===l.SizeUnit.Pixel&&(r=a.physicalSize,o=!0)}catch(e){}o||n.logParseEvent(e,l.ValidationEvent.InvalidPropertyValue,p.Strings.errors.invalidPropertyValue(t[this.name],"minHeight"))}return r},t.prototype.toJSON=function(e,t,n,r){r.serializeValue(t,this.name,"number"!=typeof n||isNaN(n)?void 0:n+"px")},t}(f);t.PixelSizeProperty=v;var b=function(e){function t(t,n,r,i){var o=e.call(this,t,n,r,i)||this;return o.targetVersion=t,o.name=n,o.defaultValue=r,o.onGetInitialValue=i,o}return o(t,e),t.prototype.parse=function(e,t,n){var i=t[this.name];if(void 0===i||!Array.isArray(i))return this.defaultValue;for(var o=[],s=0,a=i;s<a.length;s++){var p=a[s];"string"==typeof p?o.push(p):n.logParseEvent(e,l.ValidationEvent.InvalidPropertyValue,'Invalid array value "'.concat(JSON.stringify(p),'" of type "').concat(r(p),'" ignored for "').concat(this.name,'".'))}return o},t.prototype.toJSON=function(e,t,n,r){r.serializeArray(t,this.name,n)},t}(f);t.StringArrayProperty=b;var _=function(e){function t(t,n,r,i,o){var s=e.call(this,t,n,i,o)||this;return s.targetVersion=t,s.name=n,s.values=r,s.defaultValue=i,s.onGetInitialValue=o,s}return o(t,e),t.prototype.isValidValue=function(e,t){for(var n=0,r=this.values;n<r.length;n++){var i=r[n];if(e.toLowerCase()===i.value.toLowerCase())return(i.targetVersion?i.targetVersion:this.targetVersion).compareTo(t.targetVersion)<=0}return!1},t.prototype.parse=function(e,t,n){var r=t[this.name];if(void 0===r)return this.defaultValue;if("string"==typeof r)for(var i=0,o=this.values;i<o.length;i++){var s=o[i];if(r.toLowerCase()===s.value.toLowerCase()){var a=s.targetVersion?s.targetVersion:this.targetVersion;return a.compareTo(n.targetVersion)<=0?s.value:(n.logParseEvent(e,l.ValidationEvent.InvalidPropertyValue,p.Strings.errors.propertyValueNotSupported(r,this.name,a.toString(),n.targetVersion.toString())),this.defaultValue)}}return n.logParseEvent(e,l.ValidationEvent.InvalidPropertyValue,p.Strings.errors.invalidPropertyValue(r,this.name)),this.defaultValue},t.prototype.toJSON=function(e,t,n,r){var i=!1;if(void 0!==n){i=!0;for(var o=0,s=this.values;o<s.length;o++){var a=s[o];if(a.value===n){var u=a.targetVersion?a.targetVersion:this.targetVersion;if(u.compareTo(r.targetVersion)<=0){i=!1;break}r.logEvent(e,l.ValidationPhase.ToJSON,l.ValidationEvent.InvalidPropertyValue,p.Strings.errors.propertyValueNotSupported(n,this.name,u.toString(),r.targetVersion.toString()))}}}i||r.serializeValue(t,this.name,n,this.defaultValue,!0)},t}(f);t.ValueSetProperty=_;var C=function(e){function t(t,n,r,i,o,s){var a=e.call(this,t,n,i,s)||this;if(a.targetVersion=t,a.name=n,a.enumType=r,a.defaultValue=i,a.onGetInitialValue=s,a._values=[],o)a._values=o;else for(var l in r){var p=parseInt(l,10);p>=0&&a._values.push({value:p})}return a}return o(t,e),t.prototype.parse=function(e,t,n){var r=t[this.name];if("string"!=typeof r)return this.defaultValue;var i=a.getEnumValueByName(this.enumType,r);if(void 0!==i)for(var o=0,s=this.values;o<s.length;o++){var u=s[o];if(u.value===i){var c=u.targetVersion?u.targetVersion:this.targetVersion;return c.compareTo(n.targetVersion)<=0?i:(n.logParseEvent(e,l.ValidationEvent.InvalidPropertyValue,p.Strings.errors.propertyValueNotSupported(r,this.name,c.toString(),n.targetVersion.toString())),this.defaultValue)}}return n.logParseEvent(e,l.ValidationEvent.InvalidPropertyValue,p.Strings.errors.invalidPropertyValue(r,this.name)),this.defaultValue},t.prototype.toJSON=function(e,t,n,r){var i=!1;if(void 0!==n){i=!0;for(var o=0,s=this.values;o<s.length;o++){var a=s[o];if(a.value===n){if((a.targetVersion?a.targetVersion:this.targetVersion).compareTo(r.targetVersion)<=0){i=!1;break}r.logEvent(e,l.ValidationPhase.ToJSON,l.ValidationEvent.InvalidPropertyValue,p.Strings.errors.invalidPropertyValue(n,this.name))}}}i||r.serializeEnum(this.enumType,t,this.name,n,this.defaultValue)},Object.defineProperty(t.prototype,"values",{get:function(){return this._values},enumerable:!1,configurable:!0}),t}(f);t.EnumProperty=C;var S=function(e){function t(t,n,r,i,o){void 0===i&&(i=!1);var s=e.call(this,t,n,o,(function(e){return s.nullable?void 0:new s.objectType}))||this;return s.targetVersion=t,s.name=n,s.objectType=r,s.nullable=i,s}return o(t,e),t.prototype.parse=function(e,t,n){var r=t[this.name];if(void 0===r)return this.onGetInitialValue?this.onGetInitialValue(e):this.defaultValue;var i=new this.objectType;return i.parse(r,n),i},t.prototype.toJSON=function(e,t,n,i){var o=void 0;void 0===n||n.hasAllDefaultValues()||(o=n.toJSON(i)),"object"===r(o)&&0===Object.keys(o).length&&(o=void 0),i.serializeValue(t,this.name,o,this.defaultValue,!0)},t}(f);t.SerializableObjectProperty=S;var A=function(e){function t(t,n,r,i){var o=e.call(this,t,n,void 0,(function(e){return[]}))||this;return o.targetVersion=t,o.name=n,o.objectType=r,o.onItemAdded=i,o}return o(t,e),t.prototype.parse=function(e,t,n){var r=[],i=t[this.name];if(Array.isArray(i))for(var o=0,s=i;o<s.length;o++){var a=s[o],l=new this.objectType;l.parse(a,n),r.push(l),this.onItemAdded&&this.onItemAdded(e,l)}return r.length>0?r:this.onGetInitialValue?this.onGetInitialValue(e):void 0},t.prototype.toJSON=function(e,t,n,r){r.serializeArray(t,this.name,n)},t}(f);t.SerializableObjectCollectionProperty=A;var w=function(e){function t(t,n,r,i,o,s){var a=e.call(this,t,n,o,s)||this;if(a.targetVersion=t,a.name=n,a.onParse=r,a.onToJSON=i,a.defaultValue=o,a.onGetInitialValue=s,!a.onParse)throw new Error("CustomPropertyDefinition instances must have an onParse handler.");if(!a.onToJSON)throw new Error("CustomPropertyDefinition instances must have an onToJSON handler.");return a}return o(t,e),t.prototype.parse=function(e,t,n){return this.onParse(e,this,t,n)},t.prototype.toJSON=function(e,t,n,r){this.onToJSON(e,this,t,n,r)},t}(f);t.CustomProperty=w;var E=function(){function e(){this._properties=[]}return e.prototype.indexOf=function(e){for(var t=0;t<this._properties.length;t++)if(this._properties[t]===e)return t;return-1},e.prototype.add=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0,r=e;n<r.length;n++){var i=r[n];-1===this.indexOf(i)&&this._properties.push(i)}},e.prototype.remove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0,r=e;n<r.length;n++)for(var i=r[n];;){var o=this.indexOf(i);if(!(o>=0))break;this._properties.splice(o,1)}},e.prototype.getItemAt=function(e){return this._properties[e]},e.prototype.getCount=function(){return this._properties.length},e}();t.SerializableObjectSchema=E,t.property=function(e){return function(t,n){var r=Object.getOwnPropertyDescriptor(t,n)||{};r.get||r.set||(r.get=function(){return this.getValue(e)},r.set=function(t){this.setValue(e,t)},Object.defineProperty(t,n,r))}};var P=function(){function e(){this._propertyBag={},this._rawProperties={},this.maxVersion=e.defaultMaxVersion;for(var t=this.getSchema(),n=0;n<t.getCount();n++){var r=t.getItemAt(n);r.onGetInitialValue&&this.setValue(r,r.onGetInitialValue(this))}}return e.prototype.getDefaultSerializationContext=function(){return new d},e.prototype.populateSchema=function(t){var n=this.constructor,r=[];for(var i in n)try{var o=n[i];o instanceof f&&r.push(o)}catch(e){}if(r.length>0){var s=r.sort((function(e,t){return e.sequentialNumber>t.sequentialNumber?1:e.sequentialNumber<t.sequentialNumber?-1:0}));t.add.apply(t,s)}e.onRegisterCustomProperties&&e.onRegisterCustomProperties(this,t)},e.prototype.getValue=function(e){return this._propertyBag.hasOwnProperty(e.getInternalName())?this._propertyBag[e.getInternalName()]:e.defaultValue},e.prototype.setValue=function(e,t){null==t?delete this._propertyBag[e.getInternalName()]:this._propertyBag[e.getInternalName()]=t},e.prototype.internalParse=function(e,t){if(this._propertyBag={},this._rawProperties=s.GlobalSettings.enableFullJsonRoundTrip&&e||{},e)for(var n=this.getSchema(),r=0;r<n.getCount();r++){var i=n.getItemAt(r);if(i.isSerializationEnabled){var o=i.onGetInitialValue?i.onGetInitialValue(this):void 0;e.hasOwnProperty(i.name)&&(i.targetVersion.compareTo(t.targetVersion)<=0?o=i.parse(this,e,t):t.logParseEvent(this,l.ValidationEvent.UnsupportedProperty,p.Strings.errors.propertyNotSupported(i.name,i.targetVersion.toString(),t.targetVersion.toString()))),this.setValue(i,o)}}else this.resetDefaultValues()},e.prototype.internalToJSON=function(e,t){for(var n=this.getSchema(),r=[],i=0;i<n.getCount();i++){var o=n.getItemAt(i);o.isSerializationEnabled&&o.targetVersion.compareTo(t.targetVersion)<=0&&-1===r.indexOf(o.name)&&(o.toJSON(this,e,this.getValue(o),t),r.push(o.name))}},e.prototype.shouldSerialize=function(e){return!0},e.prototype.parse=function(e,t){this.internalParse(e,t||new d)},e.prototype.toJSON=function(e){var t;if(e&&e instanceof h?t=e:(t=this.getDefaultSerializationContext()).toJSONOriginalParam=e,this.shouldSerialize(t)){var n=void 0;return n=s.GlobalSettings.enableFullJsonRoundTrip&&this._rawProperties&&"object"===r(this._rawProperties)?this._rawProperties:{},this.internalToJSON(n,t),n}},e.prototype.hasDefaultValue=function(e){return this.getValue(e)===e.defaultValue},e.prototype.hasAllDefaultValues=function(){for(var e=this.getSchema(),t=0;t<e.getCount();t++){var n=e.getItemAt(t);if(!this.hasDefaultValue(n))return!1}return!0},e.prototype.resetDefaultValues=function(){for(var e=this.getSchema(),t=0;t<e.getCount();t++){var n=e.getItemAt(t);this.setValue(n,n.defaultValue)}},e.prototype.setCustomProperty=function(e,t){"string"==typeof t&&!t||null==t?delete this._rawProperties[e]:this._rawProperties[e]=t},e.prototype.getCustomProperty=function(e){return this._rawProperties[e]},e.prototype.getSchema=function(){var t=e._schemaCache[this.getSchemaKey()];return t||(t=new E,this.populateSchema(t),e._schemaCache[this.getSchemaKey()]=t),t},e.defaultMaxVersion=c.latest,e._schemaCache={},e}();t.SerializableObject=P},14:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UUID=t.SizeAndUnit=t.PaddingDefinition=t.SpacingDefinition=t.StringWithSubstitutions=t.ContentTypes=t.GlobalSettings=void 0;var r=n(489),i=function(){function e(){}return e.useAdvancedTextBlockTruncation=!0,e.useAdvancedCardBottomTruncation=!1,e.useMarkdownInRadioButtonAndCheckbox=!0,e.allowMarkForTextHighlighting=!1,e.alwaysBleedSeparators=!1,e.enableFullJsonRoundTrip=!1,e.displayInputValidationErrors=!0,e.allowPreProcessingPropertyValues=!1,e.setTabIndexAtCardRoot=!0,e.enableFallback=!0,e.useWebkitLineClamp=!0,e.allowMoreThanMaxActionsInOverflowMenu=!1,e.removePaddingFromContainersWithBackgroundImage=!1,e.resetInputsDirtyStateAfterActionExecution=!0,e.applets={logEnabled:!0,logLevel:r.LogLevel.Error,maximumRetryAttempts:3,defaultTimeBetweenRetryAttempts:3e3,authPromptWidth:400,authPromptHeight:600,refresh:{mode:r.RefreshMode.Manual,timeBetweenAutomaticRefreshes:3e3,maximumConsecutiveAutomaticRefreshes:3,allowManualRefreshesAfterAutomaticRefreshes:!0}},e}();t.GlobalSettings=i,t.ContentTypes={applicationJson:"application/json",applicationXWwwFormUrlencoded:"application/x-www-form-urlencoded"};var o=function(){function e(){this._isProcessed=!1}return e.prototype.getReferencedInputs=function(e,t){if(!t)throw new Error("The referencedInputs parameter cannot be null.");if(this._original)for(var n=0,r=e;n<r.length;n++){var i=r[n];null!=new RegExp("\\{{2}("+i.id+").value\\}{2}","gi").exec(this._original)&&i.id&&(t[i.id]=i)}},e.prototype.substituteInputValues=function(e,n){if(this._processed=this._original,this._original)for(var r=/\{{2}([a-z0-9_$@]+).value\}{2}/gi,i=void 0;null!==(i=r.exec(this._original))&&this._processed;)for(var o=0,s=Object.keys(e);o<s.length;o++){var a=s[o];if(a.toLowerCase()===i[1].toLowerCase()){var l=e[a],p="";l.value&&(p=l.value),n===t.ContentTypes.applicationJson?p=(p=JSON.stringify(p)).slice(1,-1):n===t.ContentTypes.applicationXWwwFormUrlencoded&&(p=encodeURIComponent(p)),this._processed=this._processed.replace(i[0],p);break}}this._isProcessed=!0},e.prototype.getOriginal=function(){return this._original},e.prototype.get=function(){return this._isProcessed?this._processed:this._original},e.prototype.set=function(e){this._original=e,this._isProcessed=!1},e}();t.StringWithSubstitutions=o;var s=function(e,t,n,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),this.left=0,this.top=0,this.right=0,this.bottom=0,this.top=e,this.right=t,this.bottom=n,this.left=r};t.SpacingDefinition=s;var a=function(e,t,n,i){void 0===e&&(e=r.Spacing.None),void 0===t&&(t=r.Spacing.None),void 0===n&&(n=r.Spacing.None),void 0===i&&(i=r.Spacing.None),this.top=r.Spacing.None,this.right=r.Spacing.None,this.bottom=r.Spacing.None,this.left=r.Spacing.None,this.top=e,this.right=t,this.bottom=n,this.left=i};t.PaddingDefinition=a;var l=function(){function e(e,t){this.physicalSize=e,this.unit=t}return e.parse=function(t,n){void 0===n&&(n=!1);var i=new e(0,r.SizeUnit.Weight);if("number"==typeof t)return i.physicalSize=t,i;if("string"==typeof t){var o=/^([0-9]+)(px|\*)?$/g.exec(t),s=n?3:2;if(o&&o.length>=s)return i.physicalSize=parseInt(o[1]),3===o.length&&"px"===o[2]&&(i.unit=r.SizeUnit.Pixel),i}throw new Error("Invalid size: "+t)},e}();t.SizeAndUnit=l;
/**
 * Fast UUID generator, RFC4122 version 4 compliant.
 * @author Jeff Ward (jcward.com).
 * @license MIT license
 * @link http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136
 **/
var p=function(){function e(){}return e.generate=function(){var t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return e.lut[255&t]+e.lut[t>>8&255]+e.lut[t>>16&255]+e.lut[t>>24&255]+"-"+e.lut[255&n]+e.lut[n>>8&255]+"-"+e.lut[n>>16&15|64]+e.lut[n>>24&255]+"-"+e.lut[63&r|128]+e.lut[r>>8&255]+"-"+e.lut[r>>16&255]+e.lut[r>>24&255]+e.lut[255&i]+e.lut[i>>8&255]+e.lut[i>>16&255]+e.lut[i>>24&255]},e.initialize=function(){for(var t=0;t<256;t++)e.lut[t]=(t<16?"0":"")+t.toString(16)},e.lut=[],e}();t.UUID=p,p.initialize()},558:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Strings=void 0;var n=function(){function e(){}return e.errors={unknownElementType:function(e){return'Unknown element type "'.concat(e,'". Fallback will be used if present.')},unknownActionType:function(e){return'Unknown action type "'.concat(e,'". Fallback will be used if present.')},elementTypeNotAllowed:function(e){return'Element type "'.concat(e,'" is not allowed in this context.')},actionTypeNotAllowed:function(e){return'Action type "'.concat(e,'" is not allowed in this context.')},invalidPropertyValue:function(e,t){return'Invalid value "'.concat(e,'" for property "').concat(t,'".')},showCardMustHaveCard:function(){return'"An Action.ShowCard must have its "card" property set to a valid AdaptiveCard object.'},invalidColumnWidth:function(e){return'Invalid column width "'.concat(e,'" - defaulting to "auto".')},invalidCardVersion:function(e){return'Invalid card version. Defaulting to "'.concat(e,'".')},invalidVersionString:function(e){return'Invalid version string "'.concat(e,'".')},propertyValueNotSupported:function(e,t,n,r){return'Value "'.concat(e,'" for property "').concat(t,'" is supported in version ').concat(n,", but you are using version ").concat(r,".")},propertyNotSupported:function(e,t,n){return'Property "'.concat(e,'" is supported in version ').concat(t,", but you are using version ").concat(n,".")},indexOutOfRange:function(e){return"Index out of range (".concat(e,").")},elementCannotBeUsedAsInline:function(){return"RichTextBlock.addInline: the specified card element cannot be used as a RichTextBlock inline."},inlineAlreadyParented:function(){return"RichTextBlock.addInline: the specified inline already belongs to another RichTextBlock."},interactivityNotAllowed:function(){return"Interactivity is not allowed."},inputsMustHaveUniqueId:function(){return"All inputs must have a unique Id."},choiceSetMustHaveAtLeastOneChoice:function(){return"An Input.ChoiceSet must have at least one choice defined."},choiceSetChoicesMustHaveTitleAndValue:function(){return"All choices in an Input.ChoiceSet must have their title and value properties set."},propertyMustBeSet:function(e){return'Property "'.concat(e,'" must be set.')},actionHttpHeadersMustHaveNameAndValue:function(){return"All headers of an Action.Http must have their name and value properties set."},tooManyActions:function(e){return"Maximum number of actions exceeded (".concat(e,").")},tooLittleTimeDelay:function(e){return"Autoplay Delay is too short (".concat(e,").")},columnAlreadyBelongsToAnotherSet:function(){return"This column already belongs to another ColumnSet."},invalidCardType:function(){return'Invalid or missing card type. Make sure the card\'s type property is set to "AdaptiveCard".'},unsupportedCardVersion:function(e,t){return"The specified card version (".concat(e,") is not supported or still in preview. The latest released card version is ").concat(t,".")},duplicateId:function(e){return'Duplicate Id "'.concat(e,'".')},markdownProcessingNotEnabled:function(){return"Markdown processing isn't enabled. Please see https://www.npmjs.com/package/adaptivecards#supporting-markdown"},processMarkdownEventRemoved:function(){return"The processMarkdown event has been removed. Please update your code and set onProcessMarkdown instead."},elementAlreadyParented:function(){return"The element already belongs to another container."},actionAlreadyParented:function(){return"The action already belongs to another element."},elementTypeNotStandalone:function(e){return"Elements of type ".concat(e," cannot be used as standalone elements.")}},e.magicCodeInputCard={tryAgain:function(){return"That didn't work... let's try again."},pleaseLogin:function(){return'Please login in the popup. You will obtain a magic code. Paste that code below and select "Submit"'},enterMagicCode:function(){return"Enter magic code"},pleaseEnterMagicCodeYouReceived:function(){return"Please enter the magic code you received."},submit:function(){return"Submit"},cancel:function(){return"Cancel"},somethingWentWrong:function(){return"Something went wrong. This action can't be handled."},authenticationFailed:function(){return"Authentication failed."}},e.runtime={automaticRefreshPaused:function(){return"Automatic refresh paused."},clckToRestartAutomaticRefresh:function(){return"Click to restart."},refreshThisCard:function(){return"Refresh this card"}},e.hints={dontUseWeightedAndStrecthedColumnsInSameSet:function(){return"It is not recommended to use weighted and stretched columns in the same ColumnSet, because in such a situation stretched columns will always get the minimum amount of space."}},e.defaults={inlineActionTitle:function(){return"Inline Action"},overflowButtonText:function(){return"..."},mediaPlayerAriaLabel:function(){return"Media content"},mediaPlayerPlayMedia:function(){return"Play media"},youTubeVideoPlayer:function(){return"YouTube video player"},vimeoVideoPlayer:function(){return"Vimeo video player"},dailymotionVideoPlayer:function(){return"Dailymotion video player"}},e}();t.Strings=n},597:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var i,o=this&&this.__extends||(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__decorate||function(e,t,n,i){var o,s=arguments.length,a=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(s<3?o(a):s>3?o(t,n,a):o(t,n))||a);return s>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.Table=t.TableRow=t.TableCell=t.StylableContainer=t.TableColumnDefinition=void 0;var a=n(155),l=n(489),p=n(885),u=n(246),c=n(14),h=n(558),d=n(527),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.width=new c.SizeAndUnit(1,l.SizeUnit.Weight),t}return o(t,e),t.prototype.getSchemaKey=function(){return"ColumnDefinition"},t.horizontalCellContentAlignmentProperty=new u.EnumProperty(u.Versions.v1_5,"horizontalCellContentAlignment",l.HorizontalAlignment),t.verticalCellContentAlignmentProperty=new u.EnumProperty(u.Versions.v1_5,"verticalCellContentAlignment",l.VerticalAlignment),t.widthProperty=new u.CustomProperty(u.Versions.v1_5,"width",(function(e,t,n,r){var i=t.defaultValue,o=n[t.name],s=!1;if("number"!=typeof o||isNaN(o))if("string"==typeof o)try{i=c.SizeAndUnit.parse(o)}catch(e){s=!0}else s=!0;else i=new c.SizeAndUnit(o,l.SizeUnit.Weight);return s&&r.logParseEvent(e,l.ValidationEvent.InvalidPropertyValue,h.Strings.errors.invalidColumnWidth(o)),i}),(function(e,t,n,r,i){r.unit===l.SizeUnit.Pixel?i.serializeValue(n,"width",r.physicalSize+"px"):i.serializeNumber(n,"width",r.physicalSize)}),new c.SizeAndUnit(1,l.SizeUnit.Weight)),s([(0,u.property)(t.horizontalCellContentAlignmentProperty)],t.prototype,"horizontalCellContentAlignment",void 0),s([(0,u.property)(t.verticalCellContentAlignmentProperty)],t.prototype,"verticalCellContentAlignment",void 0),s([(0,u.property)(t.widthProperty)],t.prototype,"width",void 0),t}(u.SerializableObject);t.TableColumnDefinition=f;var y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._items=[],t}return o(t,e),t.prototype.parseItem=function(e,t){var n=this;return t.parseCardObject(this,e,[],!this.isDesignMode(),(function(e){return n.createItemInstance(e)}),(function(e,n){t.logParseEvent(void 0,l.ValidationEvent.ElementTypeNotAllowed,h.Strings.errors.elementTypeNotAllowed(e))}))},t.prototype.internalAddItem=function(e){if(e.parent)throw new Error(h.Strings.errors.elementAlreadyParented());this._items.push(e),e.setParent(this)},t.prototype.internalRemoveItem=function(e){var t=this._items.indexOf(e);return t>=0&&(this._items.splice(t,1),e.setParent(void 0),this.updateLayout(),!0)},t.prototype.internalIndexOf=function(e){return this._items.indexOf(e)},t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this._items=[];var r=t[this.getCollectionPropertyName()];if(Array.isArray(r))for(var i=0,o=r;i<o.length;i++){var s=o[i],a=this.parseItem(s,n);a&&this._items.push(a)}},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),n.serializeArray(t,this.getCollectionPropertyName(),this._items)},t.prototype.removeItem=function(e){return this.internalRemoveItem(e)},t.prototype.getItemCount=function(){return this._items.length},t.prototype.getItemAt=function(e){return this._items[e]},t.prototype.getFirstVisibleRenderedItem=function(){return this.getItemCount()>0?this.getItemAt(0):void 0},t.prototype.getLastVisibleRenderedItem=function(){return this.getItemCount()>0?this.getItemAt(this.getItemCount()-1):void 0},t}(a.StylableCardElementContainer);t.StylableContainer=y;var g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._columnIndex=-1,t._cellType="data",t}return o(t,e),t.prototype.getHasBorder=function(){return this.parentRow.parentTable.showGridLines},t.prototype.applyBorder=function(){if(this.renderedElement&&this.getHasBorder()){var e=this.hostConfig.containerStyles.getStyleByName(this.parentRow.parentTable.gridStyle);if(e.borderColor){var t=(0,d.stringToCssColor)(e.borderColor);t&&(this.renderedElement.style.borderRight="1px solid "+t,this.renderedElement.style.borderBottom="1px solid "+t)}}},t.prototype.getDefaultPadding=function(){return this.getHasBackground()||this.getHasBorder()?new c.PaddingDefinition(l.Spacing.Small,l.Spacing.Small,l.Spacing.Small,l.Spacing.Small):e.prototype.getDefaultPadding.call(this)},t.prototype.internalRender=function(){var t=e.prototype.internalRender.call(this);return t&&(t.setAttribute("role","data"===this.cellType?"cell":"columnheader"),t.style.minWidth="0","header"===this.cellType&&t.setAttribute("scope","col")),t},t.prototype.shouldSerialize=function(e){return!0},t.prototype.getJsonTypeName=function(){return"TableCell"},t.prototype.getEffectiveTextStyleDefinition=function(){return"header"===this.cellType?this.hostConfig.textStyles.columnHeader:e.prototype.getEffectiveTextStyleDefinition.call(this)},t.prototype.getEffectiveHorizontalAlignment=function(){if(void 0!==this.horizontalAlignment)return this.horizontalAlignment;if(void 0!==this.parentRow.horizontalCellContentAlignment)return this.parentRow.horizontalCellContentAlignment;if(this.columnIndex>=0){var t=this.parentRow.parentTable.getColumnAt(this.columnIndex).horizontalCellContentAlignment;if(void 0!==t)return t}return void 0!==this.parentRow.parentTable.horizontalCellContentAlignment?this.parentRow.parentTable.horizontalCellContentAlignment:e.prototype.getEffectiveHorizontalAlignment.call(this)},t.prototype.getEffectiveVerticalContentAlignment=function(){if(void 0!==this.verticalContentAlignment)return this.verticalContentAlignment;if(void 0!==this.parentRow.verticalCellContentAlignment)return this.parentRow.verticalCellContentAlignment;if(this.columnIndex>=0){var t=this.parentRow.parentTable.getColumnAt(this.columnIndex).verticalCellContentAlignment;if(void 0!==t)return t}return void 0!==this.parentRow.parentTable.verticalCellContentAlignment?this.parentRow.parentTable.verticalCellContentAlignment:e.prototype.getEffectiveVerticalContentAlignment.call(this)},Object.defineProperty(t.prototype,"columnIndex",{get:function(){return this._columnIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cellType",{get:function(){return this._cellType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentRow",{get:function(){return this.parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),t}(a.Container);t.TableCell=g;var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.getDefaultPadding=function(){return new c.PaddingDefinition(l.Spacing.None,l.Spacing.None,l.Spacing.None,l.Spacing.None)},t.prototype.applyBackground=function(){if(this.renderedElement){var e=this.hostConfig.containerStyles.getStyleByName(this.style,this.hostConfig.containerStyles.getStyleByName(this.defaultStyle));if(e.backgroundColor){var t=(0,d.stringToCssColor)(e.backgroundColor);t&&(this.renderedElement.style.backgroundColor=t)}}},t.prototype.getCollectionPropertyName=function(){return"cells"},t.prototype.createItemInstance=function(e){return e&&"TableCell"!==e?void 0:new g},t.prototype.internalRender=function(){var e=this.getIsFirstRow(),t=this.hostConfig.table.cellSpacing,n=document.createElement("div");n.setAttribute("role","row"),n.style.display="flex",n.style.flexDirection="row";for(var r=0;r<Math.min(this.getItemCount(),this.parentTable.getColumnCount());r++){var i=this.getItemAt(r);i._columnIndex=r,i._cellType=this.parentTable.firstRowAsHeaders&&e?"header":"data";var o=i.render();if(o){var s=this.parentTable.getColumnAt(r);s.computedWidth.unit===l.SizeUnit.Pixel?o.style.flex="0 0 "+s.computedWidth.physicalSize+"px":o.style.flex="1 1 "+s.computedWidth.physicalSize+"%",r>0&&!this.parentTable.showGridLines&&t>0&&(o.style.marginLeft=t+"px"),n.appendChild(o)}}return n.children.length>0?n:void 0},t.prototype.shouldSerialize=function(e){return!0},t.prototype.addCell=function(e){this.internalAddItem(e)},t.prototype.removeCellAt=function(e){return e>=0&&e<this.getItemCount()&&this.removeItem(this.getItemAt(e))},t.prototype.indexOf=function(e){return e instanceof g?this.internalIndexOf(e):-1},t.prototype.ensureHasEnoughCells=function(e){for(;this.getItemCount()<e;)this.addCell(new g)},t.prototype.getJsonTypeName=function(){return"TableRow"},t.prototype.getIsFirstRow=function(){return this.parentTable.getItemAt(0)===this},Object.defineProperty(t.prototype,"parentTable",{get:function(){return this.parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),t.styleProperty=new a.ContainerStyleProperty(u.Versions.v1_5,"style"),t.horizontalCellContentAlignmentProperty=new u.EnumProperty(u.Versions.v1_5,"horizontalCellContentAlignment",l.HorizontalAlignment),t.verticalCellContentAlignmentProperty=new u.EnumProperty(u.Versions.v1_5,"verticalCellContentAlignment",l.VerticalAlignment),s([(0,u.property)(t.horizontalCellContentAlignmentProperty)],t.prototype,"horizontalCellContentAlignment",void 0),s([(0,u.property)(t.verticalCellContentAlignmentProperty)],t.prototype,"verticalCellContentAlignment",void 0),t}(y);t.TableRow=m;var v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._columns=[],t.firstRowAsHeaders=!0,t.showGridLines=!0,t}return o(t,e),Object.defineProperty(t.prototype,"gridStyle",{get:function(){var e=this.getValue(t.gridStyleProperty);if(e&&this.hostConfig.containerStyles.getStyleByName(e))return e},set:function(e){this.setValue(t.gridStyleProperty,e)},enumerable:!1,configurable:!0}),t.prototype.ensureRowsHaveEnoughCells=function(){for(var e=0;e<this.getItemCount();e++)this.getItemAt(e).ensureHasEnoughCells(this.getColumnCount())},t.prototype.removeCellsFromColumn=function(e){for(var t=0;t<this.getItemCount();t++)this.getItemAt(t).removeCellAt(e)},t.prototype.getCollectionPropertyName=function(){return"rows"},t.prototype.createItemInstance=function(e){return e&&"TableRow"!==e?void 0:new m},t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this.ensureRowsHaveEnoughCells()},t.prototype.internalRender=function(){if(this.getItemCount()>0){for(var e=0,t=0,n=this._columns;t<n.length;t++){(o=n[t]).width.unit===l.SizeUnit.Weight&&(e+=o.width.physicalSize)}for(var r=0,i=this._columns;r<i.length;r++){var o;(o=i[r]).width.unit===l.SizeUnit.Pixel?o.computedWidth=new c.SizeAndUnit(o.width.physicalSize,l.SizeUnit.Pixel):o.computedWidth=new c.SizeAndUnit(100/e*o.width.physicalSize,l.SizeUnit.Weight)}var s=document.createElement("div");if(s.setAttribute("role","table"),s.style.display="flex",s.style.flexDirection="column",this.showGridLines){var a=this.hostConfig.containerStyles.getStyleByName(this.gridStyle);if(a.borderColor){var p=(0,d.stringToCssColor)(a.borderColor);p&&(s.style.borderTop="1px solid "+p,s.style.borderLeft="1px solid "+p)}}for(var u=this.hostConfig.table.cellSpacing,h=0;h<this.getItemCount();h++){var f=this.getItemAt(h).render();if(f){if(h>0&&!this.showGridLines&&u>0){var y=document.createElement("div");y.setAttribute("aria-hidden","true"),y.style.height=u+"px",s.appendChild(y)}s.appendChild(f)}}return s}},t.prototype.addColumn=function(e){this._columns.push(e),this.ensureRowsHaveEnoughCells()},t.prototype.removeColumn=function(e){var t=this._columns.indexOf(e);t>=0&&(this.removeCellsFromColumn(t),this._columns.splice(t,1))},t.prototype.getColumnCount=function(){return this._columns.length},t.prototype.getColumnAt=function(e){return this._columns[e]},t.prototype.addRow=function(e){this.internalAddItem(e),e.ensureHasEnoughCells(this.getColumnCount())},t.prototype.indexOf=function(e){return e instanceof m?this.internalIndexOf(e):-1},t.prototype.getJsonTypeName=function(){return"Table"},t._columnsProperty=new u.SerializableObjectCollectionProperty(u.Versions.v1_5,"columns",f),t.firstRowAsHeadersProperty=new u.BoolProperty(u.Versions.v1_5,"firstRowAsHeaders",!0),t.showGridLinesProperty=new u.BoolProperty(u.Versions.v1_5,"showGridLines",!0),t.gridStyleProperty=new a.ContainerStyleProperty(u.Versions.v1_5,"gridStyle"),t.horizontalCellContentAlignmentProperty=new u.EnumProperty(u.Versions.v1_5,"horizontalCellContentAlignment",l.HorizontalAlignment),t.verticalCellContentAlignmentProperty=new u.EnumProperty(u.Versions.v1_5,"verticalCellContentAlignment",l.VerticalAlignment),s([(0,u.property)(t._columnsProperty)],t.prototype,"_columns",void 0),s([(0,u.property)(t.firstRowAsHeadersProperty)],t.prototype,"firstRowAsHeaders",void 0),s([(0,u.property)(t.showGridLinesProperty)],t.prototype,"showGridLines",void 0),s([(0,u.property)(t.gridStyleProperty)],t.prototype,"gridStyle",null),s([(0,u.property)(t.horizontalCellContentAlignmentProperty)],t.prototype,"horizontalCellContentAlignment",void 0),s([(0,u.property)(t.verticalCellContentAlignmentProperty)],t.prototype,"verticalCellContentAlignment",void 0),t}(y);t.Table=v,p.GlobalRegistry.defaultElements.register("Table",v,u.Versions.v1_5)},816:function(e,t){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.formatText=void 0;var i=function(){function e(e){this._regularExpression=e}return e.prototype.format=function(e,t){var n;if(t){for(var r=t;null!=(n=this._regularExpression.exec(t));)r=r.replace(n[0],this.internalFormat(e,n));return r}return t},e}(),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.internalFormat=function(e,t){var n=new Date(Date.parse(t[1])),r=void 0!==t[2]?t[2].toLowerCase():"compact";return"compact"!==r?n.toLocaleDateString(e,{day:"numeric",weekday:r,month:r,year:"numeric"}):n.toLocaleDateString()},t}(i),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.internalFormat=function(e,t){return new Date(Date.parse(t[1])).toLocaleTimeString(e,{hour:"numeric",minute:"2-digit"})},t}(i);t.formatText=function(e,t){for(var n=t,r=0,i=[new o(/\{{2}DATE\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))(?:, ?(COMPACT|LONG|SHORT))?\)\}{2}/g),new s(/\{{2}TIME\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))\)\}{2}/g)];r<i.length;r++){n=i[r].format(e,n)}return n}},527:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.clearElementChildren=t.getScrollY=t.getScrollX=t.getFitStatus=t.truncate=t.truncateText=t.stringToCssColor=t.parseEnum=t.getEnumValueByName=t.parseBool=t.parseNumber=t.parseString=t.appendChild=t.generateUniqueId=t.isMobileOS=t.isInternetExplorer=void 0;var i=n(489),o=n(14);function s(e,t){for(var n in e){var r=parseInt(n,10);if(r>=0){var i=e[n];if(i&&"string"==typeof i&&i.toLowerCase()===t.toLowerCase())return r}}}function a(e,t,n,r,i){var o=function(){return t-e.scrollHeight>=-1};if(!o()){for(var s=function(e){var t=[],n=p(e,-1);for(;n<e.length;)" "===e[n]&&t.push(n),n=p(e,n);return t}(n),a=0,l=s.length,u=0;a<l;){var c=Math.floor((a+l)/2);r(n,s[c]),o()?(u=s[c],a=c+1):l=c}if(r(n,u),i&&t-e.scrollHeight>=i-1){for(var h=p(n,u);h<n.length&&(r(n,h),o());)u=h,h=p(n,h);r(n,u)}}}t.isInternetExplorer=function(){return void 0!==window.document.documentMode},t.isMobileOS=function(){var e=window.navigator.userAgent;return!!e.match(/Android/i)||!!e.match(/iPad/i)||!!e.match(/iPhone/i)},t.generateUniqueId=function(){return"__ac-"+o.UUID.generate()},t.appendChild=function(e,t){t&&e.appendChild(t)},t.parseString=function(e,t){return"string"==typeof e?e:t},t.parseNumber=function(e,t){return"number"==typeof e?e:t},t.parseBool=function(e,t){if("boolean"==typeof e)return e;if("string"==typeof e)switch(e.toLowerCase()){case"true":return!0;case"false":return!1;default:return t}return t},t.getEnumValueByName=s,t.parseEnum=function(e,t,n){if(!t)return n;var r=s(e,t);return void 0!==r?r:n},t.stringToCssColor=function(e){if(e){var t=/#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})?/gi.exec(e);if(t&&t[4]){var n=parseInt(t[1],16)/255;return"rgba("+parseInt(t[2],16)+","+parseInt(t[3],16)+","+parseInt(t[4],16)+","+n+")"}}return e},t.truncateText=function(e,t,n){a(e,t,e.innerText,(function(t,n){e.innerText=t.substring(0,n)+"..."}),n)};var l="undefined"==typeof window||null===(r=window.trustedTypes)||void 0===r?void 0:r.createPolicy("adaptivecards#deprecatedExportedFunctionPolicy",{createHTML:function(e){return e}});function p(e,t){for(t+=1;t<e.length&&"<"===e[t];)for(;t<e.length&&">"!==e[t++];);return t}t.truncate=function(e,t,n){a(e,t,e.innerHTML,(function(t,n){var r,i=t.substring(0,n)+"...",o=null!==(r=null==l?void 0:l.createHTML(i))&&void 0!==r?r:i;e.innerHTML=o}),n)},t.getFitStatus=function(e,t){var n=e.offsetTop;return n+e.clientHeight<=t?i.ContainerFitStatus.FullyInContainer:n<t?i.ContainerFitStatus.Overflowing:i.ContainerFitStatus.FullyOutOfContainer},t.getScrollX=function(){return window.pageXOffset},t.getScrollY=function(){return window.pageYOffset},t.clearElementChildren=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}},989:function(e,t,n){var r,i,o;function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)
/*! @license DOMPurify 2.4.9 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.9/LICENSE */}o=function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,n){return t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t(e,n)}function n(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function r(e,i,o){return r=n()?Reflect.construct:function(e,n,r){var i=[null];i.push.apply(i,n);var o=new(Function.bind.apply(e,i));return r&&t(o,r.prototype),o},r.apply(null,arguments)}function i(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s=Object.hasOwnProperty,a=Object.setPrototypeOf,l=Object.isFrozen,p=Object.getPrototypeOf,u=Object.getOwnPropertyDescriptor,c=Object.freeze,h=Object.seal,d=Object.create,f="undefined"!=typeof Reflect&&Reflect,y=f.apply,g=f.construct;y||(y=function(e,t,n){return e.apply(t,n)}),c||(c=function(e){return e}),h||(h=function(e){return e}),g||(g=function(e,t){return r(e,i(t))});var m,v=I(Array.prototype.forEach),b=I(Array.prototype.pop),_=I(Array.prototype.push),C=I(String.prototype.toLowerCase),S=I(String.prototype.toString),A=I(String.prototype.match),w=I(String.prototype.replace),E=I(String.prototype.indexOf),P=I(String.prototype.trim),x=I(RegExp.prototype.test),k=(m=TypeError,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return g(m,t)});function I(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return y(e,t,r)}}function T(e,t,n){var r;n=null!==(r=n)&&void 0!==r?r:C,a&&a(e,null);for(var i=t.length;i--;){var o=t[i];if("string"==typeof o){var s=n(o);s!==o&&(l(t)||(t[i]=s),o=s)}e[o]=!0}return e}function O(e){var t,n=d(null);for(t in e)!0===y(s,e,[t])&&(n[t]=e[t]);return n}function V(e,t){for(;null!==e;){var n=u(e,t);if(n){if(n.get)return I(n.get);if("function"==typeof n.value)return I(n.value)}e=p(e)}return function(e){return console.warn("fallback value for",e),null}}var M=c(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),N=c(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),R=c(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),z=c(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),L=c(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),D=c(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),B=c(["#text"]),j=c(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),F=c(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),H=c(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),U=c(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),W=h(/\{\{[\w\W]*|[\w\W]*\}\}/gm),q=h(/<%[\w\W]*|[\w\W]*%>/gm),G=h(/\${[\w\W]*}/gm),J=h(/^data-[\-\w.\u00B7-\uFFFF]/),$=h(/^aria-[\-\w]+$/),Y=h(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Z=h(/^(?:\w+script|data):/i),K=h(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),X=h(/^html$/i),Q=h(/^[a-z][.\w]*(-[.\w]+)+$/i),ee=function(){return"undefined"==typeof window?null:window},te=function(t,n){if("object"!==e(t)||"function"!=typeof t.createPolicy)return null;var r=null,i="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(i)&&(r=n.currentScript.getAttribute(i));var o="dompurify"+(r?"#"+r:"");try{return t.createPolicy(o,{createHTML:function(e){return e},createScriptURL:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+o+" could not be created."),null}},ne=function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee(),r=function(e){return t(e)};if(r.version="2.4.9",r.removed=[],!n||!n.document||9!==n.document.nodeType)return r.isSupported=!1,r;var o=n.document,s=n.document,a=n.DocumentFragment,l=n.HTMLTemplateElement,p=n.Node,u=n.Element,h=n.NodeFilter,d=n.NamedNodeMap,f=void 0===d?n.NamedNodeMap||n.MozNamedAttrMap:d,y=n.HTMLFormElement,g=n.DOMParser,m=n.trustedTypes,I=u.prototype,ne=V(I,"cloneNode"),re=V(I,"nextSibling"),ie=V(I,"childNodes"),oe=V(I,"parentNode");if("function"==typeof l){var se=s.createElement("template");se.content&&se.content.ownerDocument&&(s=se.content.ownerDocument)}var ae=te(m,o),le=ae?ae.createHTML(""):"",pe=s,ue=pe.implementation,ce=pe.createNodeIterator,he=pe.createDocumentFragment,de=pe.getElementsByTagName,fe=o.importNode,ye={};try{ye=O(s).documentMode?s.documentMode:{}}catch(e){}var ge={};r.isSupported="function"==typeof oe&&ue&&void 0!==ue.createHTMLDocument&&9!==ye;var me,ve,be=W,_e=q,Ce=G,Se=J,Ae=$,we=Z,Ee=K,Pe=Q,xe=Y,ke=null,Ie=T({},[].concat(i(M),i(N),i(R),i(L),i(B))),Te=null,Oe=T({},[].concat(i(j),i(F),i(H),i(U))),Ve=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Me=null,Ne=null,Re=!0,ze=!0,Le=!1,De=!0,Be=!1,je=!1,Fe=!1,He=!1,Ue=!1,We=!1,qe=!1,Ge=!0,Je=!1,$e="user-content-",Ye=!0,Ze=!1,Ke={},Xe=null,Qe=T({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),et=null,tt=T({},["audio","video","img","source","image","track"]),nt=null,rt=T({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),it="http://www.w3.org/1998/Math/MathML",ot="http://www.w3.org/2000/svg",st="http://www.w3.org/1999/xhtml",at=st,lt=!1,pt=null,ut=T({},[it,ot,st],S),ct=["application/xhtml+xml","text/html"],ht="text/html",dt=null,ft=s.createElement("form"),yt=function(e){return e instanceof RegExp||e instanceof Function},gt=function(t){dt&&dt===t||(t&&"object"===e(t)||(t={}),t=O(t),me=me=-1===ct.indexOf(t.PARSER_MEDIA_TYPE)?ht:t.PARSER_MEDIA_TYPE,ve="application/xhtml+xml"===me?S:C,ke="ALLOWED_TAGS"in t?T({},t.ALLOWED_TAGS,ve):Ie,Te="ALLOWED_ATTR"in t?T({},t.ALLOWED_ATTR,ve):Oe,pt="ALLOWED_NAMESPACES"in t?T({},t.ALLOWED_NAMESPACES,S):ut,nt="ADD_URI_SAFE_ATTR"in t?T(O(rt),t.ADD_URI_SAFE_ATTR,ve):rt,et="ADD_DATA_URI_TAGS"in t?T(O(tt),t.ADD_DATA_URI_TAGS,ve):tt,Xe="FORBID_CONTENTS"in t?T({},t.FORBID_CONTENTS,ve):Qe,Me="FORBID_TAGS"in t?T({},t.FORBID_TAGS,ve):{},Ne="FORBID_ATTR"in t?T({},t.FORBID_ATTR,ve):{},Ke="USE_PROFILES"in t&&t.USE_PROFILES,Re=!1!==t.ALLOW_ARIA_ATTR,ze=!1!==t.ALLOW_DATA_ATTR,Le=t.ALLOW_UNKNOWN_PROTOCOLS||!1,De=!1!==t.ALLOW_SELF_CLOSE_IN_ATTR,Be=t.SAFE_FOR_TEMPLATES||!1,je=t.WHOLE_DOCUMENT||!1,Ue=t.RETURN_DOM||!1,We=t.RETURN_DOM_FRAGMENT||!1,qe=t.RETURN_TRUSTED_TYPE||!1,He=t.FORCE_BODY||!1,Ge=!1!==t.SANITIZE_DOM,Je=t.SANITIZE_NAMED_PROPS||!1,Ye=!1!==t.KEEP_CONTENT,Ze=t.IN_PLACE||!1,xe=t.ALLOWED_URI_REGEXP||xe,at=t.NAMESPACE||st,Ve=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&yt(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ve.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&yt(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ve.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Ve.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Be&&(ze=!1),We&&(Ue=!0),Ke&&(ke=T({},i(B)),Te=[],!0===Ke.html&&(T(ke,M),T(Te,j)),!0===Ke.svg&&(T(ke,N),T(Te,F),T(Te,U)),!0===Ke.svgFilters&&(T(ke,R),T(Te,F),T(Te,U)),!0===Ke.mathMl&&(T(ke,L),T(Te,H),T(Te,U))),t.ADD_TAGS&&(ke===Ie&&(ke=O(ke)),T(ke,t.ADD_TAGS,ve)),t.ADD_ATTR&&(Te===Oe&&(Te=O(Te)),T(Te,t.ADD_ATTR,ve)),t.ADD_URI_SAFE_ATTR&&T(nt,t.ADD_URI_SAFE_ATTR,ve),t.FORBID_CONTENTS&&(Xe===Qe&&(Xe=O(Xe)),T(Xe,t.FORBID_CONTENTS,ve)),Ye&&(ke["#text"]=!0),je&&T(ke,["html","head","body"]),ke.table&&(T(ke,["tbody"]),delete Me.tbody),c&&c(t),dt=t)},mt=T({},["mi","mo","mn","ms","mtext"]),vt=T({},["foreignobject","desc","title","annotation-xml"]),bt=T({},["title","style","font","a","script"]),_t=T({},N);T(_t,R),T(_t,z);var Ct=T({},L);T(Ct,D);var St=function(e){var t=oe(e);t&&t.tagName||(t={namespaceURI:at,tagName:"template"});var n=C(e.tagName),r=C(t.tagName);return!!pt[e.namespaceURI]&&(e.namespaceURI===ot?t.namespaceURI===st?"svg"===n:t.namespaceURI===it?"svg"===n&&("annotation-xml"===r||mt[r]):Boolean(_t[n]):e.namespaceURI===it?t.namespaceURI===st?"math"===n:t.namespaceURI===ot?"math"===n&&vt[r]:Boolean(Ct[n]):e.namespaceURI===st?!(t.namespaceURI===ot&&!vt[r])&&!(t.namespaceURI===it&&!mt[r])&&!Ct[n]&&(bt[n]||!_t[n]):!("application/xhtml+xml"!==me||!pt[e.namespaceURI]))},At=function(e){_(r.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=le}catch(t){e.remove()}}},wt=function(e,t){try{_(r.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){_(r.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!Te[e])if(Ue||We)try{At(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},Et=function(e){var t,n;if(He)e="<remove></remove>"+e;else{var r=A(e,/^[\r\n\t ]+/);n=r&&r[0]}"application/xhtml+xml"===me&&at===st&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var i=ae?ae.createHTML(e):e;if(at===st)try{t=(new g).parseFromString(i,me)}catch(e){}if(!t||!t.documentElement){t=ue.createDocument(at,"template",null);try{t.documentElement.innerHTML=lt?le:i}catch(e){}}var o=t.body||t.documentElement;return e&&n&&o.insertBefore(s.createTextNode(n),o.childNodes[0]||null),at===st?de.call(t,je?"html":"body")[0]:je?t.documentElement:o},Pt=function(e){return ce.call(e.ownerDocument||e,e,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT|h.SHOW_PROCESSING_INSTRUCTION|h.SHOW_CDATA_SECTION,null,!1)},xt=function(e){return e instanceof y&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof f)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},kt=function(t){return"object"===e(p)?t instanceof p:t&&"object"===e(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},It=function(e,t,n){ge[e]&&v(ge[e],(function(e){e.call(r,t,n,dt)}))},Tt=function(e){var t;if(It("beforeSanitizeElements",e,null),xt(e))return At(e),!0;if(x(/[\u0080-\uFFFF]/,e.nodeName))return At(e),!0;var n=ve(e.nodeName);if(It("uponSanitizeElement",e,{tagName:n,allowedTags:ke}),e.hasChildNodes()&&!kt(e.firstElementChild)&&(!kt(e.content)||!kt(e.content.firstElementChild))&&x(/<[/\w]/g,e.innerHTML)&&x(/<[/\w]/g,e.textContent))return At(e),!0;if("select"===n&&x(/<template/i,e.innerHTML))return At(e),!0;if(7===e.nodeType)return At(e),!0;if(!ke[n]||Me[n]){if(!Me[n]&&Vt(n)){if(Ve.tagNameCheck instanceof RegExp&&x(Ve.tagNameCheck,n))return!1;if(Ve.tagNameCheck instanceof Function&&Ve.tagNameCheck(n))return!1}if(Ye&&!Xe[n]){var i=oe(e)||e.parentNode,o=ie(e)||e.childNodes;if(o&&i)for(var s=o.length-1;s>=0;--s)i.insertBefore(ne(o[s],!0),re(e))}return At(e),!0}return e instanceof u&&!St(e)?(At(e),!0):"noscript"!==n&&"noembed"!==n&&"noframes"!==n||!x(/<\/no(script|embed|frames)/i,e.innerHTML)?(Be&&3===e.nodeType&&(t=e.textContent,t=w(t,be," "),t=w(t,_e," "),t=w(t,Ce," "),e.textContent!==t&&(_(r.removed,{element:e.cloneNode()}),e.textContent=t)),It("afterSanitizeElements",e,null),!1):(At(e),!0)},Ot=function(e,t,n){if(Ge&&("id"===t||"name"===t)&&(n in s||n in ft))return!1;if(ze&&!Ne[t]&&x(Se,t));else if(Re&&x(Ae,t));else if(!Te[t]||Ne[t]){if(!(Vt(e)&&(Ve.tagNameCheck instanceof RegExp&&x(Ve.tagNameCheck,e)||Ve.tagNameCheck instanceof Function&&Ve.tagNameCheck(e))&&(Ve.attributeNameCheck instanceof RegExp&&x(Ve.attributeNameCheck,t)||Ve.attributeNameCheck instanceof Function&&Ve.attributeNameCheck(t))||"is"===t&&Ve.allowCustomizedBuiltInElements&&(Ve.tagNameCheck instanceof RegExp&&x(Ve.tagNameCheck,n)||Ve.tagNameCheck instanceof Function&&Ve.tagNameCheck(n))))return!1}else if(nt[t]);else if(x(xe,w(n,Ee,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==E(n,"data:")||!et[e])if(Le&&!x(we,w(n,Ee,"")));else if(n)return!1;return!0},Vt=function(e){return"annotation-xml"!==e&&A(e,Pe)},Mt=function(t){var n,i,o,s;It("beforeSanitizeAttributes",t,null);var a=t.attributes;if(a){var l={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Te};for(s=a.length;s--;){var p=n=a[s],u=p.name,c=p.namespaceURI;if(i="value"===u?n.value:P(n.value),o=ve(u),l.attrName=o,l.attrValue=i,l.keepAttr=!0,l.forceKeepAttr=void 0,It("uponSanitizeAttribute",t,l),i=l.attrValue,!l.forceKeepAttr&&(wt(u,t),l.keepAttr))if(De||!x(/\/>/i,i)){Be&&(i=w(i,be," "),i=w(i,_e," "),i=w(i,Ce," "));var h=ve(t.nodeName);if(Ot(h,o,i)){if(!Je||"id"!==o&&"name"!==o||(wt(u,t),i=$e+i),ae&&"object"===e(m)&&"function"==typeof m.getAttributeType)if(c);else switch(m.getAttributeType(h,o)){case"TrustedHTML":i=ae.createHTML(i);break;case"TrustedScriptURL":i=ae.createScriptURL(i)}try{c?t.setAttributeNS(c,u,i):t.setAttribute(u,i),b(r.removed)}catch(e){}}}else wt(u,t)}It("afterSanitizeAttributes",t,null)}},Nt=function e(t){var n,r=Pt(t);for(It("beforeSanitizeShadowDOM",t,null);n=r.nextNode();)It("uponSanitizeShadowNode",n,null),Tt(n)||(n.content instanceof a&&e(n.content),Mt(n));It("afterSanitizeShadowDOM",t,null)};return r.sanitize=function(t){var i,s,l,u,c,h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((lt=!t)&&(t="\x3c!--\x3e"),"string"!=typeof t&&!kt(t)){if("function"!=typeof t.toString)throw k("toString is not a function");if("string"!=typeof(t=t.toString()))throw k("dirty is not a string, aborting")}if(!r.isSupported){if("object"===e(n.toStaticHTML)||"function"==typeof n.toStaticHTML){if("string"==typeof t)return n.toStaticHTML(t);if(kt(t))return n.toStaticHTML(t.outerHTML)}return t}if(Fe||gt(h),r.removed=[],"string"==typeof t&&(Ze=!1),Ze){if(t.nodeName){var d=ve(t.nodeName);if(!ke[d]||Me[d])throw k("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof p)1===(s=(i=Et("\x3c!----\x3e")).ownerDocument.importNode(t,!0)).nodeType&&"BODY"===s.nodeName||"HTML"===s.nodeName?i=s:i.appendChild(s);else{if(!Ue&&!Be&&!je&&-1===t.indexOf("<"))return ae&&qe?ae.createHTML(t):t;if(!(i=Et(t)))return Ue?null:qe?le:""}i&&He&&At(i.firstChild);for(var f=Pt(Ze?t:i);l=f.nextNode();)3===l.nodeType&&l===u||Tt(l)||(l.content instanceof a&&Nt(l.content),Mt(l),u=l);if(u=null,Ze)return t;if(Ue){if(We)for(c=he.call(i.ownerDocument);i.firstChild;)c.appendChild(i.firstChild);else c=i;return(Te.shadowroot||Te.shadowrootmod)&&(c=fe.call(o,c,!0)),c}var y=je?i.outerHTML:i.innerHTML;return je&&ke["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&x(X,i.ownerDocument.doctype.name)&&(y="<!DOCTYPE "+i.ownerDocument.doctype.name+">\n"+y),Be&&(y=w(y,be," "),y=w(y,_e," "),y=w(y,Ce," ")),ae&&qe?ae.createHTML(y):y},r.setConfig=function(e){gt(e),Fe=!0},r.clearConfig=function(){dt=null,Fe=!1},r.isValidAttribute=function(e,t,n){dt||gt({});var r=ve(e),i=ve(t);return Ot(r,i,n)},r.addHook=function(e,t){"function"==typeof t&&(ge[e]=ge[e]||[],_(ge[e],t))},r.removeHook=function(e){if(ge[e])return b(ge[e])},r.removeHooks=function(e){ge[e]&&(ge[e]=[])},r.removeAllHooks=function(){ge={}},r}();return ne},"object"===s(t)?e.exports=o():void 0===(i="function"==typeof(r=o)?r.call(t,n,t,e):r)||(e.exports=i)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";var e,t=n(780),r=n.n(t),i=n(254);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function s(t){return(e=e||document.createElement("textarea")).innerHTML="&"+t+";",e.value}var a=Object.prototype.hasOwnProperty;function l(e,t){return!!e&&a.call(e,t)}function p(e){var t=[].slice.call(arguments,1);return t.forEach((function(t){if(t){if("object"!==o(t))throw new TypeError(t+"must be object");Object.keys(t).forEach((function(n){e[n]=t[n]}))}})),e}var u=/\\([\\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;function c(e){return e.indexOf("\\")<0?e:e.replace(u,"$1")}function h(e){return!(e>=55296&&e<=57343)&&(!(e>=64976&&e<=65007)&&(65535!=(65535&e)&&65534!=(65535&e)&&(!(e>=0&&e<=8)&&(11!==e&&(!(e>=14&&e<=31)&&(!(e>=127&&e<=159)&&!(e>1114111)))))))}function d(e){if(e>65535){var t=55296+((e-=65536)>>10),n=56320+(1023&e);return String.fromCharCode(t,n)}return String.fromCharCode(e)}var f=/&([a-z#][a-z0-9]{1,31});/gi,y=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))/i;function g(e,t){var n=0,r=s(t);return t!==r?r:35===t.charCodeAt(0)&&y.test(t)&&h(n="x"===t[1].toLowerCase()?parseInt(t.slice(2),16):parseInt(t.slice(1),10))?d(n):e}function m(e){return e.indexOf("&")<0?e:e.replace(f,g)}var v=/[&<>"]/,b=/[&<>"]/g,_={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function C(e){return _[e]}function S(e){return v.test(e)?e.replace(b,C):e}var A={};function w(e,t){return++t>=e.length-2?t:"paragraph_open"===e[t].type&&e[t].tight&&"inline"===e[t+1].type&&0===e[t+1].content.length&&"paragraph_close"===e[t+2].type&&e[t+2].tight?w(e,t+2):t}A.blockquote_open=function(){return"<blockquote>\n"},A.blockquote_close=function(e,t){return"</blockquote>"+E(e,t)},A.code=function(e,t){return e[t].block?"<pre><code>"+S(e[t].content)+"</code></pre>"+E(e,t):"<code>"+S(e[t].content)+"</code>"},A.fence=function(e,t,n,r,i){var o,s,a=e[t],p="",u=n.langPrefix;if(a.params){if(s=(o=a.params.split(/\s+/g)).join(" "),l(i.rules.fence_custom,o[0]))return i.rules.fence_custom[o[0]](e,t,n,r,i);p=' class="'+u+S(m(c(s)))+'"'}return"<pre><code"+p+">"+(n.highlight&&n.highlight.apply(n.highlight,[a.content].concat(o))||S(a.content))+"</code></pre>"+E(e,t)},A.fence_custom={},A.heading_open=function(e,t){return"<h"+e[t].hLevel+">"},A.heading_close=function(e,t){return"</h"+e[t].hLevel+">\n"},A.hr=function(e,t,n){return(n.xhtmlOut?"<hr />":"<hr>")+E(e,t)},A.bullet_list_open=function(){return"<ul>\n"},A.bullet_list_close=function(e,t){return"</ul>"+E(e,t)},A.list_item_open=function(){return"<li>"},A.list_item_close=function(){return"</li>\n"},A.ordered_list_open=function(e,t){var n=e[t];return"<ol"+(n.order>1?' start="'+n.order+'"':"")+">\n"},A.ordered_list_close=function(e,t){return"</ol>"+E(e,t)},A.paragraph_open=function(e,t){return e[t].tight?"":"<p>"},A.paragraph_close=function(e,t){var n=!(e[t].tight&&t&&"inline"===e[t-1].type&&!e[t-1].content);return(e[t].tight?"":"</p>")+(n?E(e,t):"")},A.link_open=function(e,t,n){var r=e[t].title?' title="'+S(m(e[t].title))+'"':"",i=n.linkTarget?' target="'+n.linkTarget+'"':"";return'<a href="'+S(e[t].href)+'"'+r+i+">"},A.link_close=function(){return"</a>"},A.image=function(e,t,n){var r=' src="'+S(e[t].src)+'"',i=e[t].title?' title="'+S(m(e[t].title))+'"':"";return"<img"+r+(' alt="'+(e[t].alt?S(m(c(e[t].alt))):"")+'"')+i+(n.xhtmlOut?" /":"")+">"},A.table_open=function(){return"<table>\n"},A.table_close=function(){return"</table>\n"},A.thead_open=function(){return"<thead>\n"},A.thead_close=function(){return"</thead>\n"},A.tbody_open=function(){return"<tbody>\n"},A.tbody_close=function(){return"</tbody>\n"},A.tr_open=function(){return"<tr>"},A.tr_close=function(){return"</tr>\n"},A.th_open=function(e,t){var n=e[t];return"<th"+(n.align?' style="text-align:'+n.align+'"':"")+">"},A.th_close=function(){return"</th>"},A.td_open=function(e,t){var n=e[t];return"<td"+(n.align?' style="text-align:'+n.align+'"':"")+">"},A.td_close=function(){return"</td>"},A.strong_open=function(){return"<strong>"},A.strong_close=function(){return"</strong>"},A.em_open=function(){return"<em>"},A.em_close=function(){return"</em>"},A.del_open=function(){return"<del>"},A.del_close=function(){return"</del>"},A.ins_open=function(){return"<ins>"},A.ins_close=function(){return"</ins>"},A.mark_open=function(){return"<mark>"},A.mark_close=function(){return"</mark>"},A.sub=function(e,t){return"<sub>"+S(e[t].content)+"</sub>"},A.sup=function(e,t){return"<sup>"+S(e[t].content)+"</sup>"},A.hardbreak=function(e,t,n){return n.xhtmlOut?"<br />\n":"<br>\n"},A.softbreak=function(e,t,n){return n.breaks?n.xhtmlOut?"<br />\n":"<br>\n":"\n"},A.text=function(e,t){return S(e[t].content)},A.htmlblock=function(e,t){return e[t].content},A.htmltag=function(e,t){return e[t].content},A.abbr_open=function(e,t){return'<abbr title="'+S(m(e[t].title))+'">'},A.abbr_close=function(){return"</abbr>"},A.footnote_ref=function(e,t){var n=Number(e[t].id+1).toString(),r="fnref"+n;return e[t].subId>0&&(r+=":"+e[t].subId),'<sup class="footnote-ref"><a href="#fn'+n+'" id="'+r+'">['+n+"]</a></sup>"},A.footnote_block_open=function(e,t,n){return(n.xhtmlOut?'<hr class="footnotes-sep" />\n':'<hr class="footnotes-sep">\n')+'<section class="footnotes">\n<ol class="footnotes-list">\n'},A.footnote_block_close=function(){return"</ol>\n</section>\n"},A.footnote_open=function(e,t){return'<li id="fn'+Number(e[t].id+1).toString()+'"  class="footnote-item">'},A.footnote_close=function(){return"</li>\n"},A.footnote_anchor=function(e,t){var n="fnref"+Number(e[t].id+1).toString();return e[t].subId>0&&(n+=":"+e[t].subId),' <a href="#'+n+'" class="footnote-backref">↩</a>'},A.dl_open=function(){return"<dl>\n"},A.dt_open=function(){return"<dt>"},A.dd_open=function(){return"<dd>"},A.dl_close=function(){return"</dl>\n"},A.dt_close=function(){return"</dt>\n"},A.dd_close=function(){return"</dd>\n"};var E=A.getBreak=function(e,t){return(t=w(e,t))<e.length&&"list_item_close"===e[t].type?"":"\n"};function P(){this.rules=p({},A),this.getBreak=A.getBreak}function x(){this.__rules__=[],this.__cache__=null}function k(e,t,n,r,i){this.src=e,this.env=r,this.options=n,this.parser=t,this.tokens=i,this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache=[],this.isInLabel=!1,this.linkLevel=0,this.linkContent="",this.labelUnmatchedScopes=0}function I(e,t){var n,r,i,o=-1,s=e.posMax,a=e.pos,l=e.isInLabel;if(e.isInLabel)return-1;if(e.labelUnmatchedScopes)return e.labelUnmatchedScopes--,-1;for(e.pos=t+1,e.isInLabel=!0,n=1;e.pos<s;){if(91===(i=e.src.charCodeAt(e.pos)))n++;else if(93===i&&0===--n){r=!0;break}e.parser.skipToken(e)}return r?(o=e.pos,e.labelUnmatchedScopes=0):e.labelUnmatchedScopes=n-1,e.pos=a,e.isInLabel=l,o}function T(e,t,n,r){var i,o,s,a,l,p;if(42!==e.charCodeAt(0))return-1;if(91!==e.charCodeAt(1))return-1;if(-1===e.indexOf("]:"))return-1;if((o=I(i=new k(e,t,n,r,[]),1))<0||58!==e.charCodeAt(o+1))return-1;for(a=i.posMax,s=o+2;s<a&&10!==i.src.charCodeAt(s);s++);return l=e.slice(2,o),0===(p=e.slice(o+2,s).trim()).length?-1:(r.abbreviations||(r.abbreviations={}),void 0===r.abbreviations[":"+l]&&(r.abbreviations[":"+l]=p),s)}function O(e){var t=m(e);try{t=decodeURI(t)}catch(e){}return encodeURI(t)}function V(e,t){var n,r,i,o=t,s=e.posMax;if(60===e.src.charCodeAt(t)){for(t++;t<s;){if(10===(n=e.src.charCodeAt(t)))return!1;if(62===n)return i=O(c(e.src.slice(o+1,t))),!!e.parser.validateLink(i)&&(e.pos=t+1,e.linkContent=i,!0);92===n&&t+1<s?t+=2:t++}return!1}for(r=0;t<s&&32!==(n=e.src.charCodeAt(t))&&!(n<32||127===n);)if(92===n&&t+1<s)t+=2;else{if(40===n&&++r>1)break;if(41===n&&--r<0)break;t++}return o!==t&&(i=c(e.src.slice(o,t)),!!e.parser.validateLink(i)&&(e.linkContent=i,e.pos=t,!0))}function M(e,t){var n,r=t,i=e.posMax,o=e.src.charCodeAt(t);if(34!==o&&39!==o&&40!==o)return!1;for(t++,40===o&&(o=41);t<i;){if((n=e.src.charCodeAt(t))===o)return e.pos=t+1,e.linkContent=c(e.src.slice(r+1,t)),!0;92===n&&t+1<i?t+=2:t++}return!1}function N(e){return e.trim().replace(/\s+/g," ").toUpperCase()}function R(e,t,n,r){var i,o,s,a,l,p,u,c,h;if(91!==e.charCodeAt(0))return-1;if(-1===e.indexOf("]:"))return-1;if((o=I(i=new k(e,t,n,r,[]),0))<0||58!==e.charCodeAt(o+1))return-1;for(a=i.posMax,s=o+2;s<a&&(32===(l=i.src.charCodeAt(s))||10===l);s++);if(!V(i,s))return-1;for(u=i.linkContent,p=s=i.pos,s+=1;s<a&&(32===(l=i.src.charCodeAt(s))||10===l);s++);for(s<a&&p!==s&&M(i,s)?(c=i.linkContent,s=i.pos):(c="",s=p);s<a&&32===i.src.charCodeAt(s);)s++;return s<a&&10!==i.src.charCodeAt(s)?-1:(h=N(e.slice(1,o)),void 0===r.references[h]&&(r.references[h]={title:c,href:u}),s)}P.prototype.renderInline=function(e,t,n){for(var r=this.rules,i=e.length,o=0,s="";i--;)s+=r[e[o].type](e,o++,t,n,this);return s},P.prototype.render=function(e,t,n){for(var r=this.rules,i=e.length,o=-1,s="";++o<i;)"inline"===e[o].type?s+=this.renderInline(e[o].children,t,n):s+=r[e[o].type](e,o,t,n,this);return s},x.prototype.__find__=function(e){for(var t=this.__rules__.length,n=-1;t--;)if(this.__rules__[++n].name===e)return n;return-1},x.prototype.__compile__=function(){var e=this,t=[""];e.__rules__.forEach((function(e){e.enabled&&e.alt.forEach((function(e){t.indexOf(e)<0&&t.push(e)}))})),e.__cache__={},t.forEach((function(t){e.__cache__[t]=[],e.__rules__.forEach((function(n){n.enabled&&(t&&n.alt.indexOf(t)<0||e.__cache__[t].push(n.fn))}))}))},x.prototype.at=function(e,t,n){var r=this.__find__(e),i=n||{};if(-1===r)throw new Error("Parser rule not found: "+e);this.__rules__[r].fn=t,this.__rules__[r].alt=i.alt||[],this.__cache__=null},x.prototype.before=function(e,t,n,r){var i=this.__find__(e),o=r||{};if(-1===i)throw new Error("Parser rule not found: "+e);this.__rules__.splice(i,0,{name:t,enabled:!0,fn:n,alt:o.alt||[]}),this.__cache__=null},x.prototype.after=function(e,t,n,r){var i=this.__find__(e),o=r||{};if(-1===i)throw new Error("Parser rule not found: "+e);this.__rules__.splice(i+1,0,{name:t,enabled:!0,fn:n,alt:o.alt||[]}),this.__cache__=null},x.prototype.push=function(e,t,n){var r=n||{};this.__rules__.push({name:e,enabled:!0,fn:t,alt:r.alt||[]}),this.__cache__=null},x.prototype.enable=function(e,t){e=Array.isArray(e)?e:[e],t&&this.__rules__.forEach((function(e){e.enabled=!1})),e.forEach((function(e){var t=this.__find__(e);if(t<0)throw new Error("Rules manager: invalid rule name "+e);this.__rules__[t].enabled=!0}),this),this.__cache__=null},x.prototype.disable=function(e){(e=Array.isArray(e)?e:[e]).forEach((function(e){var t=this.__find__(e);if(t<0)throw new Error("Rules manager: invalid rule name "+e);this.__rules__[t].enabled=!1}),this),this.__cache__=null},x.prototype.getRules=function(e){return null===this.__cache__&&this.__compile__(),this.__cache__[e]||[]},k.prototype.pushPending=function(){this.tokens.push({type:"text",content:this.pending,level:this.pendingLevel}),this.pending=""},k.prototype.push=function(e){this.pending&&this.pushPending(),this.tokens.push(e),this.pendingLevel=this.level},k.prototype.cacheSet=function(e,t){for(var n=this.cache.length;n<=e;n++)this.cache.push(0);this.cache[e]=t},k.prototype.cacheGet=function(e){return e<this.cache.length?this.cache[e]:0};var z=" \n()[]'\".,!?-";function L(e){return e.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1")}var D=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,B=/\((c|tm|r|p)\)/gi,j={c:"©",r:"®",p:"§",tm:"™"};var F=/['"]/,H=/['"]/g,U=/[-\s()\[\]]/;function W(e,t){return!(t<0||t>=e.length)&&!U.test(e[t])}function q(e,t,n){return e.substr(0,t)+n+e.substr(t+1)}var G=[["block",function(e){e.inlineMode?e.tokens.push({type:"inline",content:e.src.replace(/\n/g," ").trim(),level:0,lines:[0,1],children:[]}):e.block.parse(e.src,e.options,e.env,e.tokens)}],["abbr",function(e){var t,n,r,i,o=e.tokens;if(!e.inlineMode)for(t=1,n=o.length-1;t<n;t++)if("paragraph_open"===o[t-1].type&&"inline"===o[t].type&&"paragraph_close"===o[t+1].type){for(r=o[t].content;r.length&&!((i=T(r,e.inline,e.options,e.env))<0);)r=r.slice(i).trim();o[t].content=r,r.length||(o[t-1].tight=!0,o[t+1].tight=!0)}}],["references",function(e){var t,n,r,i,o=e.tokens;if(e.env.references=e.env.references||{},!e.inlineMode)for(t=1,n=o.length-1;t<n;t++)if("inline"===o[t].type&&"paragraph_open"===o[t-1].type&&"paragraph_close"===o[t+1].type){for(r=o[t].content;r.length&&!((i=R(r,e.inline,e.options,e.env))<0);)r=r.slice(i).trim();o[t].content=r,r.length||(o[t-1].tight=!0,o[t+1].tight=!0)}}],["inline",function(e){var t,n,r,i=e.tokens;for(n=0,r=i.length;n<r;n++)"inline"===(t=i[n]).type&&e.inline.parse(t.content,e.options,e.env,t.children)}],["footnote_tail",function(e){var t,n,r,i,o,s,a,l,p,u=0,c=!1,h={};if(e.env.footnotes&&(e.tokens=e.tokens.filter((function(e){return"footnote_reference_open"===e.type?(c=!0,l=[],p=e.label,!1):"footnote_reference_close"===e.type?(c=!1,h[":"+p]=l,!1):(c&&l.push(e),!c)})),e.env.footnotes.list)){for(s=e.env.footnotes.list,e.tokens.push({type:"footnote_block_open",level:u++}),t=0,n=s.length;t<n;t++){for(e.tokens.push({type:"footnote_open",id:t,level:u++}),s[t].tokens?((a=[]).push({type:"paragraph_open",tight:!1,level:u++}),a.push({type:"inline",content:"",level:u,children:s[t].tokens}),a.push({type:"paragraph_close",tight:!1,level:--u})):s[t].label&&(a=h[":"+s[t].label]),e.tokens=e.tokens.concat(a),o="paragraph_close"===e.tokens[e.tokens.length-1].type?e.tokens.pop():null,i=s[t].count>0?s[t].count:1,r=0;r<i;r++)e.tokens.push({type:"footnote_anchor",id:t,subId:r,level:u});o&&e.tokens.push(o),e.tokens.push({type:"footnote_close",level:--u})}e.tokens.push({type:"footnote_block_close",level:--u})}}],["abbr2",function(e){var t,n,r,i,o,s,a,l,p,u,c,h,d=e.tokens;if(e.env.abbreviations)for(e.env.abbrRegExp||(h="(^|["+z.split("").map(L).join("")+"])("+Object.keys(e.env.abbreviations).map((function(e){return e.substr(1)})).sort((function(e,t){return t.length-e.length})).map(L).join("|")+")($|["+z.split("").map(L).join("")+"])",e.env.abbrRegExp=new RegExp(h,"g")),u=e.env.abbrRegExp,n=0,r=d.length;n<r;n++)if("inline"===d[n].type)for(t=(i=d[n].children).length-1;t>=0;t--)if("text"===(o=i[t]).type){for(l=0,s=o.content,u.lastIndex=0,p=o.level,a=[];c=u.exec(s);)u.lastIndex>l&&a.push({type:"text",content:s.slice(l,c.index+c[1].length),level:p}),a.push({type:"abbr_open",title:e.env.abbreviations[":"+c[2]],level:p++}),a.push({type:"text",content:c[2],level:p}),a.push({type:"abbr_close",level:--p}),l=u.lastIndex-c[3].length;a.length&&(l<s.length&&a.push({type:"text",content:s.slice(l),level:p}),d[n].children=i=[].concat(i.slice(0,t),a,i.slice(t+1)))}}],["replacements",function(e){var t,n,r,i,o,s;if(e.options.typographer)for(o=e.tokens.length-1;o>=0;o--)if("inline"===e.tokens[o].type)for(t=(i=e.tokens[o].children).length-1;t>=0;t--)"text"===(n=i[t]).type&&(r=n.content,r=(s=r).indexOf("(")<0?s:s.replace(B,(function(e,t){return j[t.toLowerCase()]})),D.test(r)&&(r=r.replace(/\+-/g,"±").replace(/\.{2,}/g,"…").replace(/([?!])…/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---([^-]|$)/gm,"$1—$2").replace(/(^|\s)--(\s|$)/gm,"$1–$2").replace(/(^|[^-\s])--([^-\s]|$)/gm,"$1–$2")),n.content=r)}],["smartquotes",function(e){var t,n,r,i,o,s,a,l,p,u,c,h,d,f,y,g,m;if(e.options.typographer)for(m=[],y=e.tokens.length-1;y>=0;y--)if("inline"===e.tokens[y].type)for(g=e.tokens[y].children,m.length=0,t=0;t<g.length;t++)if("text"===(n=g[t]).type&&!F.test(n.text)){for(a=g[t].level,d=m.length-1;d>=0&&!(m[d].level<=a);d--);m.length=d+1,o=0,s=(r=n.content).length;e:for(;o<s&&(H.lastIndex=o,i=H.exec(r));)if(l=!W(r,i.index-1),o=i.index+1,f="'"===i[0],(p=!W(r,o))||l){if(c=!p,h=!l)for(d=m.length-1;d>=0&&(u=m[d],!(m[d].level<a));d--)if(u.single===f&&m[d].level===a){u=m[d],f?(g[u.token].content=q(g[u.token].content,u.pos,e.options.quotes[2]),n.content=q(n.content,i.index,e.options.quotes[3])):(g[u.token].content=q(g[u.token].content,u.pos,e.options.quotes[0]),n.content=q(n.content,i.index,e.options.quotes[1])),m.length=d;continue e}c?m.push({token:t,pos:i.index,single:f,level:a}):h&&f&&(n.content=q(n.content,i.index,"’"))}else f&&(n.content=q(n.content,i.index,"’"))}}]];function J(){this.options={},this.ruler=new x;for(var e=0;e<G.length;e++)this.ruler.push(G[e][0],G[e][1])}function $(e,t,n,r,i){var o,s,a,l,p,u,c;for(this.src=e,this.parser=t,this.options=n,this.env=r,this.tokens=i,this.bMarks=[],this.eMarks=[],this.tShift=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.parentType="root",this.ddIndent=-1,this.level=0,this.result="",u=0,c=!1,a=l=u=0,p=(s=this.src).length;l<p;l++){if(o=s.charCodeAt(l),!c){if(32===o){u++;continue}c=!0}10!==o&&l!==p-1||(10!==o&&l++,this.bMarks.push(a),this.eMarks.push(l),this.tShift.push(u),c=!1,u=0,a=l+1)}this.bMarks.push(s.length),this.eMarks.push(s.length),this.tShift.push(0),this.lineMax=this.bMarks.length-1}function Y(e,t){var n,r,i;return(r=e.bMarks[t]+e.tShift[t])>=(i=e.eMarks[t])||42!==(n=e.src.charCodeAt(r++))&&45!==n&&43!==n||r<i&&32!==e.src.charCodeAt(r)?-1:r}function Z(e,t){var n,r=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(r+1>=i)return-1;if((n=e.src.charCodeAt(r++))<48||n>57)return-1;for(;;){if(r>=i)return-1;if(!((n=e.src.charCodeAt(r++))>=48&&n<=57)){if(41===n||46===n)break;return-1}}return r<i&&32!==e.src.charCodeAt(r)?-1:r}J.prototype.process=function(e){var t,n,r;for(t=0,n=(r=this.ruler.getRules("")).length;t<n;t++)r[t](e)},$.prototype.isEmpty=function(e){return this.bMarks[e]+this.tShift[e]>=this.eMarks[e]},$.prototype.skipEmptyLines=function(e){for(var t=this.lineMax;e<t&&!(this.bMarks[e]+this.tShift[e]<this.eMarks[e]);e++);return e},$.prototype.skipSpaces=function(e){for(var t=this.src.length;e<t&&32===this.src.charCodeAt(e);e++);return e},$.prototype.skipChars=function(e,t){for(var n=this.src.length;e<n&&this.src.charCodeAt(e)===t;e++);return e},$.prototype.skipCharsBack=function(e,t,n){if(e<=n)return e;for(;e>n;)if(t!==this.src.charCodeAt(--e))return e+1;return e},$.prototype.getLines=function(e,t,n,r){var i,o,s,a,l,p=e;if(e>=t)return"";if(p+1===t)return o=this.bMarks[p]+Math.min(this.tShift[p],n),s=r?this.eMarks[p]+1:this.eMarks[p],this.src.slice(o,s);for(a=new Array(t-e),i=0;p<t;p++,i++)(l=this.tShift[p])>n&&(l=n),l<0&&(l=0),o=this.bMarks[p]+l,s=p+1<t||r?this.eMarks[p]+1:this.eMarks[p],a[i]=this.src.slice(o,s);return a.join("")};var K={};["article","aside","button","blockquote","body","canvas","caption","col","colgroup","dd","div","dl","dt","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","iframe","li","map","object","ol","output","p","pre","progress","script","section","style","table","tbody","td","textarea","tfoot","th","tr","thead","ul","video"].forEach((function(e){K[e]=!0}));var X=/^<([a-zA-Z]{1,15})[\s\/>]/,Q=/^<\/([a-zA-Z]{1,15})[\s>]/;function ee(e,t){var n=e.bMarks[t]+e.blkIndent,r=e.eMarks[t];return e.src.substr(n,r-n)}function te(e,t){var n,r,i=e.bMarks[t]+e.tShift[t],o=e.eMarks[t];return i>=o||126!==(r=e.src.charCodeAt(i++))&&58!==r||i===(n=e.skipSpaces(i))||n>=o?-1:n}var ne=[["code",function(e,t,n){var r,i;if(e.tShift[t]-e.blkIndent<4)return!1;for(i=r=t+1;r<n;)if(e.isEmpty(r))r++;else{if(!(e.tShift[r]-e.blkIndent>=4))break;i=++r}return e.line=r,e.tokens.push({type:"code",content:e.getLines(t,i,4+e.blkIndent,!0),block:!0,lines:[t,e.line],level:e.level}),!0}],["fences",function(e,t,n,r){var i,o,s,a,l,p=!1,u=e.bMarks[t]+e.tShift[t],c=e.eMarks[t];if(u+3>c)return!1;if(126!==(i=e.src.charCodeAt(u))&&96!==i)return!1;if(l=u,(o=(u=e.skipChars(u,i))-l)<3)return!1;if((s=e.src.slice(u,c).trim()).indexOf("`")>=0)return!1;if(r)return!0;for(a=t;!(++a>=n)&&!((u=l=e.bMarks[a]+e.tShift[a])<(c=e.eMarks[a])&&e.tShift[a]<e.blkIndent);)if(e.src.charCodeAt(u)===i&&!(e.tShift[a]-e.blkIndent>=4||(u=e.skipChars(u,i))-l<o||(u=e.skipSpaces(u))<c)){p=!0;break}return o=e.tShift[t],e.line=a+(p?1:0),e.tokens.push({type:"fence",params:s,content:e.getLines(t+1,a,o,!0),lines:[t,e.line],level:e.level}),!0},["paragraph","blockquote","list"]],["blockquote",function(e,t,n,r){var i,o,s,a,l,p,u,c,h,d,f,y=e.bMarks[t]+e.tShift[t],g=e.eMarks[t];if(y>g)return!1;if(62!==e.src.charCodeAt(y++))return!1;if(e.level>=e.options.maxNesting)return!1;if(r)return!0;for(32===e.src.charCodeAt(y)&&y++,l=e.blkIndent,e.blkIndent=0,a=[e.bMarks[t]],e.bMarks[t]=y,o=(y=y<g?e.skipSpaces(y):y)>=g,s=[e.tShift[t]],e.tShift[t]=y-e.bMarks[t],c=e.parser.ruler.getRules("blockquote"),i=t+1;i<n&&!((y=e.bMarks[i]+e.tShift[i])>=(g=e.eMarks[i]));i++)if(62!==e.src.charCodeAt(y++)){if(o)break;for(f=!1,h=0,d=c.length;h<d;h++)if(c[h](e,i,n,!0)){f=!0;break}if(f)break;a.push(e.bMarks[i]),s.push(e.tShift[i]),e.tShift[i]=-1337}else 32===e.src.charCodeAt(y)&&y++,a.push(e.bMarks[i]),e.bMarks[i]=y,o=(y=y<g?e.skipSpaces(y):y)>=g,s.push(e.tShift[i]),e.tShift[i]=y-e.bMarks[i];for(p=e.parentType,e.parentType="blockquote",e.tokens.push({type:"blockquote_open",lines:u=[t,0],level:e.level++}),e.parser.tokenize(e,t,i),e.tokens.push({type:"blockquote_close",level:--e.level}),e.parentType=p,u[1]=e.line,h=0;h<s.length;h++)e.bMarks[h+t]=a[h],e.tShift[h+t]=s[h];return e.blkIndent=l,!0},["paragraph","blockquote","list"]],["hr",function(e,t,n,r){var i,o,s,a=e.bMarks[t],l=e.eMarks[t];if((a+=e.tShift[t])>l)return!1;if(42!==(i=e.src.charCodeAt(a++))&&45!==i&&95!==i)return!1;for(o=1;a<l;){if((s=e.src.charCodeAt(a++))!==i&&32!==s)return!1;s===i&&o++}return!(o<3)&&(r||(e.line=t+1,e.tokens.push({type:"hr",lines:[t,e.line],level:e.level})),!0)},["paragraph","blockquote","list"]],["list",function(e,t,n,r){var i,o,s,a,l,p,u,c,h,d,f,y,g,m,v,b,_,C,S,A,w,E=!0;if((c=Z(e,t))>=0)y=!0;else{if(!((c=Y(e,t))>=0))return!1;y=!1}if(e.level>=e.options.maxNesting)return!1;if(f=e.src.charCodeAt(c-1),r)return!0;for(m=e.tokens.length,y?(u=e.bMarks[t]+e.tShift[t],d=Number(e.src.substr(u,c-u-1)),e.tokens.push({type:"ordered_list_open",order:d,lines:b=[t,0],level:e.level++})):e.tokens.push({type:"bullet_list_open",lines:b=[t,0],level:e.level++}),i=t,v=!1,C=e.parser.ruler.getRules("list");!(!(i<n)||((h=(g=e.skipSpaces(c))>=e.eMarks[i]?1:g-c)>4&&(h=1),h<1&&(h=1),o=c-e.bMarks[i]+h,e.tokens.push({type:"list_item_open",lines:_=[t,0],level:e.level++}),a=e.blkIndent,l=e.tight,s=e.tShift[t],p=e.parentType,e.tShift[t]=g-e.bMarks[t],e.blkIndent=o,e.tight=!0,e.parentType="list",e.parser.tokenize(e,t,n,!0),e.tight&&!v||(E=!1),v=e.line-t>1&&e.isEmpty(e.line-1),e.blkIndent=a,e.tShift[t]=s,e.tight=l,e.parentType=p,e.tokens.push({type:"list_item_close",level:--e.level}),i=t=e.line,_[1]=i,g=e.bMarks[t],i>=n)||e.isEmpty(i)||e.tShift[i]<e.blkIndent);){for(w=!1,S=0,A=C.length;S<A;S++)if(C[S](e,i,n,!0)){w=!0;break}if(w)break;if(y){if((c=Z(e,i))<0)break}else if((c=Y(e,i))<0)break;if(f!==e.src.charCodeAt(c-1))break}return e.tokens.push({type:y?"ordered_list_close":"bullet_list_close",level:--e.level}),b[1]=i,e.line=i,E&&function(e,t){var n,r,i=e.level+2;for(n=t+2,r=e.tokens.length-2;n<r;n++)e.tokens[n].level===i&&"paragraph_open"===e.tokens[n].type&&(e.tokens[n+2].tight=!0,e.tokens[n].tight=!0,n+=2)}(e,m),!0},["paragraph","blockquote"]],["footnote",function(e,t,n,r){var i,o,s,a,l,p=e.bMarks[t]+e.tShift[t],u=e.eMarks[t];if(p+4>u)return!1;if(91!==e.src.charCodeAt(p))return!1;if(94!==e.src.charCodeAt(p+1))return!1;if(e.level>=e.options.maxNesting)return!1;for(a=p+2;a<u;a++){if(32===e.src.charCodeAt(a))return!1;if(93===e.src.charCodeAt(a))break}return a!==p+2&&(!(a+1>=u||58!==e.src.charCodeAt(++a))&&(r||(a++,e.env.footnotes||(e.env.footnotes={}),e.env.footnotes.refs||(e.env.footnotes.refs={}),l=e.src.slice(p+2,a-2),e.env.footnotes.refs[":"+l]=-1,e.tokens.push({type:"footnote_reference_open",label:l,level:e.level++}),i=e.bMarks[t],o=e.tShift[t],s=e.parentType,e.tShift[t]=e.skipSpaces(a)-a,e.bMarks[t]=a,e.blkIndent+=4,e.parentType="footnote",e.tShift[t]<e.blkIndent&&(e.tShift[t]+=e.blkIndent,e.bMarks[t]-=e.blkIndent),e.parser.tokenize(e,t,n,!0),e.parentType=s,e.blkIndent-=4,e.tShift[t]=o,e.bMarks[t]=i,e.tokens.push({type:"footnote_reference_close",level:--e.level})),!0))},["paragraph"]],["heading",function(e,t,n,r){var i,o,s,a=e.bMarks[t]+e.tShift[t],l=e.eMarks[t];if(a>=l)return!1;if(35!==(i=e.src.charCodeAt(a))||a>=l)return!1;for(o=1,i=e.src.charCodeAt(++a);35===i&&a<l&&o<=6;)o++,i=e.src.charCodeAt(++a);return!(o>6||a<l&&32!==i)&&(r||(l=e.skipCharsBack(l,32,a),(s=e.skipCharsBack(l,35,a))>a&&32===e.src.charCodeAt(s-1)&&(l=s),e.line=t+1,e.tokens.push({type:"heading_open",hLevel:o,lines:[t,e.line],level:e.level}),a<l&&e.tokens.push({type:"inline",content:e.src.slice(a,l).trim(),level:e.level+1,lines:[t,e.line],children:[]}),e.tokens.push({type:"heading_close",hLevel:o,level:e.level})),!0)},["paragraph","blockquote"]],["lheading",function(e,t,n){var r,i,o,s=t+1;return!(s>=n)&&(!(e.tShift[s]<e.blkIndent)&&(!(e.tShift[s]-e.blkIndent>3)&&(!((i=e.bMarks[s]+e.tShift[s])>=(o=e.eMarks[s]))&&((45===(r=e.src.charCodeAt(i))||61===r)&&(i=e.skipChars(i,r),!((i=e.skipSpaces(i))<o)&&(i=e.bMarks[t]+e.tShift[t],e.line=s+1,e.tokens.push({type:"heading_open",hLevel:61===r?1:2,lines:[t,e.line],level:e.level}),e.tokens.push({type:"inline",content:e.src.slice(i,e.eMarks[t]).trim(),level:e.level+1,lines:[t,e.line-1],children:[]}),e.tokens.push({type:"heading_close",hLevel:61===r?1:2,level:e.level}),!0))))))}],["htmlblock",function(e,t,n,r){var i,o,s,a=e.bMarks[t],l=e.eMarks[t],p=e.tShift[t];if(a+=p,!e.options.html)return!1;if(p>3||a+2>=l)return!1;if(60!==e.src.charCodeAt(a))return!1;if(33===(i=e.src.charCodeAt(a+1))||63===i){if(r)return!0}else{if(47!==i&&!function(e){var t=32|e;return t>=97&&t<=122}(i))return!1;if(47===i){if(!(o=e.src.slice(a,l).match(Q)))return!1}else if(!(o=e.src.slice(a,l).match(X)))return!1;if(!0!==K[o[1].toLowerCase()])return!1;if(r)return!0}for(s=t+1;s<e.lineMax&&!e.isEmpty(s);)s++;return e.line=s,e.tokens.push({type:"htmlblock",level:e.level,lines:[t,e.line],content:e.getLines(t,s,0,!0)}),!0},["paragraph","blockquote"]],["table",function(e,t,n,r){var i,o,s,a,l,p,u,c,h,d,f;if(t+2>n)return!1;if(l=t+1,e.tShift[l]<e.blkIndent)return!1;if((s=e.bMarks[l]+e.tShift[l])>=e.eMarks[l])return!1;if(124!==(i=e.src.charCodeAt(s))&&45!==i&&58!==i)return!1;if(o=ee(e,t+1),!/^[-:| ]+$/.test(o))return!1;if((p=o.split("|"))<=2)return!1;for(c=[],a=0;a<p.length;a++){if(!(h=p[a].trim())){if(0===a||a===p.length-1)continue;return!1}if(!/^:?-+:?$/.test(h))return!1;58===h.charCodeAt(h.length-1)?c.push(58===h.charCodeAt(0)?"center":"right"):58===h.charCodeAt(0)?c.push("left"):c.push("")}if(-1===(o=ee(e,t).trim()).indexOf("|"))return!1;if(p=o.replace(/^\||\|$/g,"").split("|"),c.length!==p.length)return!1;if(r)return!0;for(e.tokens.push({type:"table_open",lines:d=[t,0],level:e.level++}),e.tokens.push({type:"thead_open",lines:[t,t+1],level:e.level++}),e.tokens.push({type:"tr_open",lines:[t,t+1],level:e.level++}),a=0;a<p.length;a++)e.tokens.push({type:"th_open",align:c[a],lines:[t,t+1],level:e.level++}),e.tokens.push({type:"inline",content:p[a].trim(),lines:[t,t+1],level:e.level,children:[]}),e.tokens.push({type:"th_close",level:--e.level});for(e.tokens.push({type:"tr_close",level:--e.level}),e.tokens.push({type:"thead_close",level:--e.level}),e.tokens.push({type:"tbody_open",lines:f=[t+2,0],level:e.level++}),l=t+2;l<n&&!(e.tShift[l]<e.blkIndent)&&-1!==(o=ee(e,l).trim()).indexOf("|");l++){for(p=o.replace(/^\||\|$/g,"").split("|"),e.tokens.push({type:"tr_open",level:e.level++}),a=0;a<p.length;a++)e.tokens.push({type:"td_open",align:c[a],level:e.level++}),u=p[a].substring(124===p[a].charCodeAt(0)?1:0,124===p[a].charCodeAt(p[a].length-1)?p[a].length-1:p[a].length).trim(),e.tokens.push({type:"inline",content:u,level:e.level,children:[]}),e.tokens.push({type:"td_close",level:--e.level});e.tokens.push({type:"tr_close",level:--e.level})}return e.tokens.push({type:"tbody_close",level:--e.level}),e.tokens.push({type:"table_close",level:--e.level}),d[1]=f[1]=l,e.line=l,!0},["paragraph"]],["deflist",function(e,t,n,r){var i,o,s,a,l,p,u,c,h,d,f,y,g,m;if(r)return!(e.ddIndent<0)&&te(e,t)>=0;if(u=t+1,e.isEmpty(u)&&++u>n)return!1;if(e.tShift[u]<e.blkIndent)return!1;if((i=te(e,u))<0)return!1;if(e.level>=e.options.maxNesting)return!1;p=e.tokens.length,e.tokens.push({type:"dl_open",lines:l=[t,0],level:e.level++}),s=t,o=u;e:for(;;){for(m=!0,g=!1,e.tokens.push({type:"dt_open",lines:[s,s],level:e.level++}),e.tokens.push({type:"inline",content:e.getLines(s,s+1,e.blkIndent,!1).trim(),level:e.level+1,lines:[s,s],children:[]}),e.tokens.push({type:"dt_close",level:--e.level});;){if(e.tokens.push({type:"dd_open",lines:a=[u,0],level:e.level++}),y=e.tight,h=e.ddIndent,c=e.blkIndent,f=e.tShift[o],d=e.parentType,e.blkIndent=e.ddIndent=e.tShift[o]+2,e.tShift[o]=i-e.bMarks[o],e.tight=!0,e.parentType="deflist",e.parser.tokenize(e,o,n,!0),e.tight&&!g||(m=!1),g=e.line-o>1&&e.isEmpty(e.line-1),e.tShift[o]=f,e.tight=y,e.parentType=d,e.blkIndent=c,e.ddIndent=h,e.tokens.push({type:"dd_close",level:--e.level}),a[1]=u=e.line,u>=n)break e;if(e.tShift[u]<e.blkIndent)break e;if((i=te(e,u))<0)break;o=u}if(u>=n)break;if(s=u,e.isEmpty(s))break;if(e.tShift[s]<e.blkIndent)break;if((o=s+1)>=n)break;if(e.isEmpty(o)&&o++,o>=n)break;if(e.tShift[o]<e.blkIndent)break;if((i=te(e,o))<0)break}return e.tokens.push({type:"dl_close",level:--e.level}),l[1]=u,e.line=u,m&&function(e,t){var n,r,i=e.level+2;for(n=t+2,r=e.tokens.length-2;n<r;n++)e.tokens[n].level===i&&"paragraph_open"===e.tokens[n].type&&(e.tokens[n+2].tight=!0,e.tokens[n].tight=!0,n+=2)}(e,p),!0},["paragraph"]],["paragraph",function(e,t){var n,r,i,o,s,a,l=t+1;if(l<(n=e.lineMax)&&!e.isEmpty(l))for(a=e.parser.ruler.getRules("paragraph");l<n&&!e.isEmpty(l);l++)if(!(e.tShift[l]-e.blkIndent>3)){for(i=!1,o=0,s=a.length;o<s;o++)if(a[o](e,l,n,!0)){i=!0;break}if(i)break}return r=e.getLines(t,l,e.blkIndent,!1).trim(),e.line=l,r.length&&(e.tokens.push({type:"paragraph_open",tight:!1,lines:[t,e.line],level:e.level}),e.tokens.push({type:"inline",content:r,level:e.level+1,lines:[t,e.line],children:[]}),e.tokens.push({type:"paragraph_close",tight:!1,level:e.level})),!0}]];function re(){this.ruler=new x;for(var e=0;e<ne.length;e++)this.ruler.push(ne[e][0],ne[e][1],{alt:(ne[e][2]||[]).slice()})}re.prototype.tokenize=function(e,t,n){for(var r,i=this.ruler.getRules(""),o=i.length,s=t,a=!1;s<n&&(e.line=s=e.skipEmptyLines(s),!(s>=n))&&!(e.tShift[s]<e.blkIndent);){for(r=0;r<o&&!i[r](e,s,n,!1);r++);if(e.tight=!a,e.isEmpty(e.line-1)&&(a=!0),(s=e.line)<n&&e.isEmpty(s)){if(a=!0,++s<n&&"list"===e.parentType&&e.isEmpty(s))break;e.line=s}}};var ie=/[\n\t]/g,oe=/\r[\n\u0085]|[\u2424\u2028\u0085]/g,se=/\u00a0/g;function ae(e){switch(e){case 10:case 92:case 96:case 42:case 95:case 94:case 91:case 93:case 33:case 38:case 60:case 62:case 123:case 125:case 36:case 37:case 64:case 126:case 43:case 61:case 58:return!0;default:return!1}}re.prototype.parse=function(e,t,n,r){var i,o=0,s=0;if(!e)return[];(e=(e=e.replace(se," ")).replace(oe,"\n")).indexOf("\t")>=0&&(e=e.replace(ie,(function(t,n){var r;return 10===e.charCodeAt(n)?(o=n+1,s=0,t):(r="    ".slice((n-o-s)%4),s=n-o+1,r)}))),i=new $(e,this,t,n,r),this.tokenize(i,i.line,i.lineMax)};for(var le=[],pe=0;pe<256;pe++)le.push(0);function ue(e){return e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122}function ce(e,t){var n,r,i,o=t,s=!0,a=!0,l=e.posMax,p=e.src.charCodeAt(t);for(n=t>0?e.src.charCodeAt(t-1):-1;o<l&&e.src.charCodeAt(o)===p;)o++;return o>=l&&(s=!1),(i=o-t)>=4?s=a=!1:(32!==(r=o<l?e.src.charCodeAt(o):-1)&&10!==r||(s=!1),32!==n&&10!==n||(a=!1),95===p&&(ue(n)&&(s=!1),ue(r)&&(a=!1))),{can_open:s,can_close:a,delims:i}}"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach((function(e){le[e.charCodeAt(0)]=1}));var he=/\\([ \\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;var de=/\\([ \\!"#$%&'()*+,.\/:;<=>?@[\]^_`{|}~-])/g;var fe=["coap","doi","javascript","aaa","aaas","about","acap","cap","cid","crid","data","dav","dict","dns","file","ftp","geo","go","gopher","h323","http","https","iax","icap","im","imap","info","ipp","iris","iris.beep","iris.xpc","iris.xpcs","iris.lwz","ldap","mailto","mid","msrp","msrps","mtqp","mupdate","news","nfs","ni","nih","nntp","opaquelocktoken","pop","pres","rtsp","service","session","shttp","sieve","sip","sips","sms","snmp","soap.beep","soap.beeps","tag","tel","telnet","tftp","thismessage","tn3270","tip","tv","urn","vemmi","ws","wss","xcon","xcon-userid","xmlrpc.beep","xmlrpc.beeps","xmpp","z39.50r","z39.50s","adiumxtra","afp","afs","aim","apt","attachment","aw","beshare","bitcoin","bolo","callto","chrome","chrome-extension","com-eventbrite-attendee","content","cvs","dlna-playsingle","dlna-playcontainer","dtn","dvb","ed2k","facetime","feed","finger","fish","gg","git","gizmoproject","gtalk","hcp","icon","ipn","irc","irc6","ircs","itms","jar","jms","keyparc","lastfm","ldaps","magnet","maps","market","message","mms","ms-help","msnim","mumble","mvn","notes","oid","palm","paparazzi","platform","proxy","psyc","query","res","resource","rmi","rsync","rtmp","secondlife","sftp","sgn","skype","smb","soldat","spotify","ssh","steam","svn","teamspeak","things","udp","unreal","ut2004","ventrilo","view-source","webcal","wtai","wyciwyg","xfire","xri","ymsgr"],ye=/^<([a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)>/,ge=/^<([a-zA-Z.\-]{1,25}):([^<>\x00-\x20]*)>/;function me(e,t){return e=e.source,t=t||"",function n(r,i){return r?(i=i.source||i,e=e.replace(r,i),n):new RegExp(e,t)}}var ve=me(/(?:unquoted|single_quoted|double_quoted)/)("unquoted",/[^"'=<>`\x00-\x20]+/)("single_quoted",/'[^']*'/)("double_quoted",/"[^"]*"/)(),be=me(/(?:\s+attr_name(?:\s*=\s*attr_value)?)/)("attr_name",/[a-zA-Z_:][a-zA-Z0-9:._-]*/)("attr_value",ve)(),_e=me(/<[A-Za-z][A-Za-z0-9]*attribute*\s*\/?>/)("attribute",be)(),Ce=me(/^(?:open_tag|close_tag|comment|processing|declaration|cdata)/)("open_tag",_e)("close_tag",/<\/[A-Za-z][A-Za-z0-9]*\s*>/)("comment",/<!---->|<!--(?:-?[^>-])(?:-?[^-])*-->/)("processing",/<[?].*?[?]>/)("declaration",/<![A-Z]+\s+[^>]*>/)("cdata",/<!\[CDATA\[[\s\S]*?\]\]>/)();var Se=/^&#((?:x[a-f0-9]{1,8}|[0-9]{1,8}));/i,Ae=/^&([a-z][a-z0-9]{1,31});/i;var we=[["text",function(e,t){for(var n=e.pos;n<e.posMax&&!ae(e.src.charCodeAt(n));)n++;return n!==e.pos&&(t||(e.pending+=e.src.slice(e.pos,n)),e.pos=n,!0)}],["newline",function(e,t){var n,r,i=e.pos;if(10!==e.src.charCodeAt(i))return!1;if(n=e.pending.length-1,r=e.posMax,!t)if(n>=0&&32===e.pending.charCodeAt(n))if(n>=1&&32===e.pending.charCodeAt(n-1)){for(var o=n-2;o>=0;o--)if(32!==e.pending.charCodeAt(o)){e.pending=e.pending.substring(0,o+1);break}e.push({type:"hardbreak",level:e.level})}else e.pending=e.pending.slice(0,-1),e.push({type:"softbreak",level:e.level});else e.push({type:"softbreak",level:e.level});for(i++;i<r&&32===e.src.charCodeAt(i);)i++;return e.pos=i,!0}],["escape",function(e,t){var n,r=e.pos,i=e.posMax;if(92!==e.src.charCodeAt(r))return!1;if(++r<i){if((n=e.src.charCodeAt(r))<256&&0!==le[n])return t||(e.pending+=e.src[r]),e.pos+=2,!0;if(10===n){for(t||e.push({type:"hardbreak",level:e.level}),r++;r<i&&32===e.src.charCodeAt(r);)r++;return e.pos=r,!0}}return t||(e.pending+="\\"),e.pos++,!0}],["backticks",function(e,t){var n,r,i,o,s,a=e.pos;if(96!==e.src.charCodeAt(a))return!1;for(n=a,a++,r=e.posMax;a<r&&96===e.src.charCodeAt(a);)a++;for(i=e.src.slice(n,a),o=s=a;-1!==(o=e.src.indexOf("`",s));){for(s=o+1;s<r&&96===e.src.charCodeAt(s);)s++;if(s-o===i.length)return t||e.push({type:"code",content:e.src.slice(a,o).replace(/[ \n]+/g," ").trim(),block:!1,level:e.level}),e.pos=s,!0}return t||(e.pending+=i),e.pos+=i.length,!0}],["del",function(e,t){var n,r,i,o,s,a=e.posMax,l=e.pos;if(126!==e.src.charCodeAt(l))return!1;if(t)return!1;if(l+4>=a)return!1;if(126!==e.src.charCodeAt(l+1))return!1;if(e.level>=e.options.maxNesting)return!1;if(o=l>0?e.src.charCodeAt(l-1):-1,s=e.src.charCodeAt(l+2),126===o)return!1;if(126===s)return!1;if(32===s||10===s)return!1;for(r=l+2;r<a&&126===e.src.charCodeAt(r);)r++;if(r>l+3)return e.pos+=r-l,t||(e.pending+=e.src.slice(l,r)),!0;for(e.pos=l+2,i=1;e.pos+1<a;){if(126===e.src.charCodeAt(e.pos)&&126===e.src.charCodeAt(e.pos+1)&&(o=e.src.charCodeAt(e.pos-1),126!==(s=e.pos+2<a?e.src.charCodeAt(e.pos+2):-1)&&126!==o&&(32!==o&&10!==o?i--:32!==s&&10!==s&&i++,i<=0))){n=!0;break}e.parser.skipToken(e)}return n?(e.posMax=e.pos,e.pos=l+2,t||(e.push({type:"del_open",level:e.level++}),e.parser.tokenize(e),e.push({type:"del_close",level:--e.level})),e.pos=e.posMax+2,e.posMax=a,!0):(e.pos=l,!1)}],["ins",function(e,t){var n,r,i,o,s,a=e.posMax,l=e.pos;if(43!==e.src.charCodeAt(l))return!1;if(t)return!1;if(l+4>=a)return!1;if(43!==e.src.charCodeAt(l+1))return!1;if(e.level>=e.options.maxNesting)return!1;if(o=l>0?e.src.charCodeAt(l-1):-1,s=e.src.charCodeAt(l+2),43===o)return!1;if(43===s)return!1;if(32===s||10===s)return!1;for(r=l+2;r<a&&43===e.src.charCodeAt(r);)r++;if(r!==l+2)return e.pos+=r-l,t||(e.pending+=e.src.slice(l,r)),!0;for(e.pos=l+2,i=1;e.pos+1<a;){if(43===e.src.charCodeAt(e.pos)&&43===e.src.charCodeAt(e.pos+1)&&(o=e.src.charCodeAt(e.pos-1),43!==(s=e.pos+2<a?e.src.charCodeAt(e.pos+2):-1)&&43!==o&&(32!==o&&10!==o?i--:32!==s&&10!==s&&i++,i<=0))){n=!0;break}e.parser.skipToken(e)}return n?(e.posMax=e.pos,e.pos=l+2,t||(e.push({type:"ins_open",level:e.level++}),e.parser.tokenize(e),e.push({type:"ins_close",level:--e.level})),e.pos=e.posMax+2,e.posMax=a,!0):(e.pos=l,!1)}],["mark",function(e,t){var n,r,i,o,s,a=e.posMax,l=e.pos;if(61!==e.src.charCodeAt(l))return!1;if(t)return!1;if(l+4>=a)return!1;if(61!==e.src.charCodeAt(l+1))return!1;if(e.level>=e.options.maxNesting)return!1;if(o=l>0?e.src.charCodeAt(l-1):-1,s=e.src.charCodeAt(l+2),61===o)return!1;if(61===s)return!1;if(32===s||10===s)return!1;for(r=l+2;r<a&&61===e.src.charCodeAt(r);)r++;if(r!==l+2)return e.pos+=r-l,t||(e.pending+=e.src.slice(l,r)),!0;for(e.pos=l+2,i=1;e.pos+1<a;){if(61===e.src.charCodeAt(e.pos)&&61===e.src.charCodeAt(e.pos+1)&&(o=e.src.charCodeAt(e.pos-1),61!==(s=e.pos+2<a?e.src.charCodeAt(e.pos+2):-1)&&61!==o&&(32!==o&&10!==o?i--:32!==s&&10!==s&&i++,i<=0))){n=!0;break}e.parser.skipToken(e)}return n?(e.posMax=e.pos,e.pos=l+2,t||(e.push({type:"mark_open",level:e.level++}),e.parser.tokenize(e),e.push({type:"mark_close",level:--e.level})),e.pos=e.posMax+2,e.posMax=a,!0):(e.pos=l,!1)}],["emphasis",function(e,t){var n,r,i,o,s,a,l,p=e.posMax,u=e.pos,c=e.src.charCodeAt(u);if(95!==c&&42!==c)return!1;if(t)return!1;if(n=(l=ce(e,u)).delims,!l.can_open)return e.pos+=n,t||(e.pending+=e.src.slice(u,e.pos)),!0;if(e.level>=e.options.maxNesting)return!1;for(e.pos=u+n,a=[n];e.pos<p;)if(e.src.charCodeAt(e.pos)!==c)e.parser.skipToken(e);else{if(r=(l=ce(e,e.pos)).delims,l.can_close){for(o=a.pop(),s=r;o!==s;){if(s<o){a.push(o-s);break}if(s-=o,0===a.length)break;e.pos+=o,o=a.pop()}if(0===a.length){n=o,i=!0;break}e.pos+=r;continue}l.can_open&&a.push(r),e.pos+=r}return i?(e.posMax=e.pos,e.pos=u+n,t||(2!==n&&3!==n||e.push({type:"strong_open",level:e.level++}),1!==n&&3!==n||e.push({type:"em_open",level:e.level++}),e.parser.tokenize(e),1!==n&&3!==n||e.push({type:"em_close",level:--e.level}),2!==n&&3!==n||e.push({type:"strong_close",level:--e.level})),e.pos=e.posMax+n,e.posMax=p,!0):(e.pos=u,!1)}],["sub",function(e,t){var n,r,i=e.posMax,o=e.pos;if(126!==e.src.charCodeAt(o))return!1;if(t)return!1;if(o+2>=i)return!1;if(e.level>=e.options.maxNesting)return!1;for(e.pos=o+1;e.pos<i;){if(126===e.src.charCodeAt(e.pos)){n=!0;break}e.parser.skipToken(e)}return n&&o+1!==e.pos?(r=e.src.slice(o+1,e.pos)).match(/(^|[^\\])(\\\\)*\s/)?(e.pos=o,!1):(e.posMax=e.pos,e.pos=o+1,t||e.push({type:"sub",level:e.level,content:r.replace(he,"$1")}),e.pos=e.posMax+1,e.posMax=i,!0):(e.pos=o,!1)}],["sup",function(e,t){var n,r,i=e.posMax,o=e.pos;if(94!==e.src.charCodeAt(o))return!1;if(t)return!1;if(o+2>=i)return!1;if(e.level>=e.options.maxNesting)return!1;for(e.pos=o+1;e.pos<i;){if(94===e.src.charCodeAt(e.pos)){n=!0;break}e.parser.skipToken(e)}return n&&o+1!==e.pos?(r=e.src.slice(o+1,e.pos)).match(/(^|[^\\])(\\\\)*\s/)?(e.pos=o,!1):(e.posMax=e.pos,e.pos=o+1,t||e.push({type:"sup",level:e.level,content:r.replace(de,"$1")}),e.pos=e.posMax+1,e.posMax=i,!0):(e.pos=o,!1)}],["links",function(e,t){var n,r,i,o,s,a,l,p,u=!1,c=e.pos,h=e.posMax,d=e.pos,f=e.src.charCodeAt(d);if(33===f&&(u=!0,f=e.src.charCodeAt(++d)),91!==f)return!1;if(e.level>=e.options.maxNesting)return!1;if(n=d+1,(r=I(e,d))<0)return!1;if((a=r+1)<h&&40===e.src.charCodeAt(a)){for(a++;a<h&&(32===(p=e.src.charCodeAt(a))||10===p);a++);if(a>=h)return!1;for(d=a,V(e,a)?(o=e.linkContent,a=e.pos):o="",d=a;a<h&&(32===(p=e.src.charCodeAt(a))||10===p);a++);if(a<h&&d!==a&&M(e,a))for(s=e.linkContent,a=e.pos;a<h&&(32===(p=e.src.charCodeAt(a))||10===p);a++);else s="";if(a>=h||41!==e.src.charCodeAt(a))return e.pos=c,!1;a++}else{if(e.linkLevel>0)return!1;for(;a<h&&(32===(p=e.src.charCodeAt(a))||10===p);a++);if(a<h&&91===e.src.charCodeAt(a)&&(d=a+1,(a=I(e,a))>=0?i=e.src.slice(d,a++):a=d-1),i||(void 0===i&&(a=r+1),i=e.src.slice(n,r)),!(l=e.env.references[N(i)]))return e.pos=c,!1;o=l.href,s=l.title}return t||(e.pos=n,e.posMax=r,u?e.push({type:"image",src:o,title:s,alt:e.src.substr(n,r-n),level:e.level}):(e.push({type:"link_open",href:o,title:s,level:e.level++}),e.linkLevel++,e.parser.tokenize(e),e.linkLevel--,e.push({type:"link_close",level:--e.level}))),e.pos=a,e.posMax=h,!0}],["footnote_inline",function(e,t){var n,r,i,o,s=e.posMax,a=e.pos;return!(a+2>=s)&&(94===e.src.charCodeAt(a)&&(91===e.src.charCodeAt(a+1)&&(!(e.level>=e.options.maxNesting)&&(n=a+2,!((r=I(e,a+1))<0)&&(t||(e.env.footnotes||(e.env.footnotes={}),e.env.footnotes.list||(e.env.footnotes.list=[]),i=e.env.footnotes.list.length,e.pos=n,e.posMax=r,e.push({type:"footnote_ref",id:i,level:e.level}),e.linkLevel++,o=e.tokens.length,e.parser.tokenize(e),e.env.footnotes.list[i]={tokens:e.tokens.splice(o)},e.linkLevel--),e.pos=r+1,e.posMax=s,!0)))))}],["footnote_ref",function(e,t){var n,r,i,o,s=e.posMax,a=e.pos;if(a+3>s)return!1;if(!e.env.footnotes||!e.env.footnotes.refs)return!1;if(91!==e.src.charCodeAt(a))return!1;if(94!==e.src.charCodeAt(a+1))return!1;if(e.level>=e.options.maxNesting)return!1;for(r=a+2;r<s;r++){if(32===e.src.charCodeAt(r))return!1;if(10===e.src.charCodeAt(r))return!1;if(93===e.src.charCodeAt(r))break}return r!==a+2&&(!(r>=s)&&(r++,n=e.src.slice(a+2,r-1),void 0!==e.env.footnotes.refs[":"+n]&&(t||(e.env.footnotes.list||(e.env.footnotes.list=[]),e.env.footnotes.refs[":"+n]<0?(i=e.env.footnotes.list.length,e.env.footnotes.list[i]={label:n,count:0},e.env.footnotes.refs[":"+n]=i):i=e.env.footnotes.refs[":"+n],o=e.env.footnotes.list[i].count,e.env.footnotes.list[i].count++,e.push({type:"footnote_ref",id:i,subId:o,level:e.level})),e.pos=r,e.posMax=s,!0)))}],["autolink",function(e,t){var n,r,i,o,s,a=e.pos;return 60===e.src.charCodeAt(a)&&(!((n=e.src.slice(a)).indexOf(">")<0)&&((r=n.match(ge))?!(fe.indexOf(r[1].toLowerCase())<0)&&(s=O(o=r[0].slice(1,-1)),!!e.parser.validateLink(o)&&(t||(e.push({type:"link_open",href:s,level:e.level}),e.push({type:"text",content:o,level:e.level+1}),e.push({type:"link_close",level:e.level})),e.pos+=r[0].length,!0)):!!(i=n.match(ye))&&(s=O("mailto:"+(o=i[0].slice(1,-1))),!!e.parser.validateLink(s)&&(t||(e.push({type:"link_open",href:s,level:e.level}),e.push({type:"text",content:o,level:e.level+1}),e.push({type:"link_close",level:e.level})),e.pos+=i[0].length,!0))))}],["htmltag",function(e,t){var n,r,i,o=e.pos;return!!e.options.html&&(i=e.posMax,!(60!==e.src.charCodeAt(o)||o+2>=i)&&(!(33!==(n=e.src.charCodeAt(o+1))&&63!==n&&47!==n&&!function(e){var t=32|e;return t>=97&&t<=122}(n))&&(!!(r=e.src.slice(o).match(Ce))&&(t||e.push({type:"htmltag",content:e.src.slice(o,o+r[0].length),level:e.level}),e.pos+=r[0].length,!0))))}],["entity",function(e,t){var n,r,i=e.pos,o=e.posMax;if(38!==e.src.charCodeAt(i))return!1;if(i+1<o)if(35===e.src.charCodeAt(i+1)){if(r=e.src.slice(i).match(Se))return t||(n="x"===r[1][0].toLowerCase()?parseInt(r[1].slice(1),16):parseInt(r[1],10),e.pending+=h(n)?d(n):d(65533)),e.pos+=r[0].length,!0}else if(r=e.src.slice(i).match(Ae)){var a=s(r[1]);if(r[1]!==a)return t||(e.pending+=a),e.pos+=r[0].length,!0}return t||(e.pending+="&"),e.pos++,!0}]];function Ee(){this.ruler=new x;for(var e=0;e<we.length;e++)this.ruler.push(we[e][0],we[e][1]);this.validateLink=Pe}function Pe(e){var t=e.trim().toLowerCase();return-1===(t=m(t)).indexOf(":")||-1===["vbscript","javascript","file","data"].indexOf(t.split(":")[0])}Ee.prototype.skipToken=function(e){var t,n,r=this.ruler.getRules(""),i=r.length,o=e.pos;if((n=e.cacheGet(o))>0)e.pos=n;else{for(t=0;t<i;t++)if(r[t](e,!0))return void e.cacheSet(o,e.pos);e.pos++,e.cacheSet(o,e.pos)}},Ee.prototype.tokenize=function(e){for(var t,n,r=this.ruler.getRules(""),i=r.length,o=e.posMax;e.pos<o;){for(n=0;n<i&&!(t=r[n](e,!1));n++);if(t){if(e.pos>=o)break}else e.pending+=e.src[e.pos++]}e.pending&&e.pushPending()},Ee.prototype.parse=function(e,t,n,r){var i=new k(e,this,t,n,r);this.tokenize(i)};var xe={default:{options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkTarget:"",typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{rules:["block","inline","references","replacements","smartquotes","references","abbr2","footnote_tail"]},block:{rules:["blockquote","code","fences","footnote","heading","hr","htmlblock","lheading","list","paragraph","table"]},inline:{rules:["autolink","backticks","del","emphasis","entity","escape","footnote_ref","htmltag","links","newline","text"]}}},full:{options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkTarget:"",typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{},block:{},inline:{}}},commonmark:{options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkTarget:"",typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{rules:["block","inline","references","abbr2"]},block:{rules:["blockquote","code","fences","heading","hr","htmlblock","lheading","list","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","htmltag","links","newline","text"]}}}};function ke(e,t,n){this.src=t,this.env=n,this.options=e.options,this.tokens=[],this.inlineMode=!1,this.inline=e.inline,this.block=e.block,this.renderer=e.renderer,this.typographer=e.typographer}function Ie(e,t){"string"!=typeof e&&(t=e,e="default"),t&&null!=t.linkify&&console.warn("linkify option is removed. Use linkify plugin instead:\n\nimport Remarkable from 'remarkable';\nimport linkify from 'remarkable/linkify';\nnew Remarkable().use(linkify)\n"),this.inline=new Ee,this.block=new re,this.core=new J,this.renderer=new P,this.ruler=new x,this.options={},this.configure(xe[e]),this.set(t||{})}Ie.prototype.set=function(e){p(this.options,e)},Ie.prototype.configure=function(e){var t=this;if(!e)throw new Error("Wrong `remarkable` preset, check name/content");e.options&&t.set(e.options),e.components&&Object.keys(e.components).forEach((function(n){e.components[n].rules&&t[n].ruler.enable(e.components[n].rules,!0)}))},Ie.prototype.use=function(e,t){return e(this,t),this},Ie.prototype.parse=function(e,t){var n=new ke(this,e,t);return this.core.process(n),n.tokens},Ie.prototype.render=function(e,t){return t=t||{},this.renderer.render(this.parse(e,t),this.options,t)},Ie.prototype.parseInline=function(e,t){var n=new ke(this,e,t);return n.inlineMode=!0,this.core.process(n),n.tokens},Ie.prototype.renderInline=function(e,t){return t=t||{},this.renderer.render(this.parseInline(e,t),this.options,t)};var Te=n(989),Oe={ALLOWED_TAGS:["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","big","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","meta","meter","nav","noframes","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","small","source","span","strike","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr"],ALLOWED_ATTR:["accept","accept-charset","accesskey","action","align","alt","autocomplete","autofocus","autoplay","bgcolor","border","charset","checked","cite","class","color","cols","colspan","content","contenteditable","controls","coords","data","data-*","datetime","default","dir","dirname","disabled","download","draggable","dropzone","enctype","for","form","formaction","headers","height","hidden","high","href","hreflang","http-equiv","id","ismap","kind","label","lang","list","loop","low","max","maxlength","media","method","min","multiple","muted","name","novalidate","open","optimum","pattern","placeholder","poster","preload","readonly","rel","required","reversed","rows","rowspan","sandbox","scope","selected","shape","size","sizes","span","spellcheck","src","srcdoc","srclang","srcset","start","step","style","tabindex","target","title","translate","type","usemap","value","width","wrap"]},Ve=new Ie;i.AdaptiveCard.onProcessMarkdown=function(e,t){var n=function(e){return(0,Te.sanitize)(e,Oe).toString()}(Ve.render(e));t.outputHtml=n,t.didProcess=!0};var Me=function(e){var n=e.payload,o=e.hostConfig,s=e.onExecuteAction,a=e.setCardOffsetTop,l=(0,t.useRef)(null),p=(0,t.useRef)(new i.AdaptiveCard),u=(0,t.useCallback)((function(e){null==s||s(e)}),[s]);return(0,t.useEffect)((function(){p.current.onExecuteAction=u}),[u]),(0,t.useEffect)((function(){p.current.hostConfig=new i.HostConfig(o)}),[o]),(0,t.useEffect)((function(){if(l.current){var e=p.current;try{e.parse(n);var t=e.render();l.current.innerHTML="",l.current.appendChild(t),a&&a(l.current.offsetTop)}catch(e){console.error("Unable to render Card",e)}}}),[o,n]),r().createElement("div",{ref:l})},Ne=(0,t.memo)(Me);function Re(e){return function(e){if(Array.isArray(e))return Le(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ze(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ze(e,t){if(e){if("string"==typeof e)return Le(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Le(e,t):void 0}}function Le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var De=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function Be(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(r=e[n],i=t[n],!(r===i||De(r)&&De(i)))return!1;var r,i;return!0}var je=document.createElement("style");je.type="text/css",je.id="accss",(document.head||document.getElementsByTagName("head")[0]).appendChild(je);var Fe,He=function(e,t){void 0===t&&(t=Be);var n=null;function r(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(n&&n.lastThis===this&&t(r,n.lastArgs))return n.lastResult;var o=e.apply(this,r);return n={lastResult:o,lastArgs:r,lastThis:this},o}return r.clear=function(){n=null},r}((function(e){je.innerHTML=function(e){return"\n.ac-pushbutton,\n.ac-pushbutton.subdued {\n  background-color: transparent;\n  border: 1px solid ".concat(e.primaryColor,";  \n  color: ").concat(e.primaryColor,";\n\n  cursor: pointer;\n  height: 40px;\n\n  padding: ").concat(e.unitSize,"px ").concat(2*e.unitSize,"px;\n  border-radius: ").concat(2*e.unitSize,"px;\n}\n\n.ac-pushbutton.style-default.expandable.expanded {\n  background: ").concat(e.primaryGradient,";\n  color: ").concat(e.primaryContrastColor,";\n  border: 1px solid ").concat(e.primaryColor,";\n\n  cursor: pointer;\n  height: 40px;\n\n  padding: ").concat(e.unitSize,"px ").concat(2*e.unitSize,"px;\n  border-radius: ").concat(2*e.unitSize,"px;\n}\n\n/*.ac-input {\n  border: 1px solid ").concat(e.primaryColor,";\n  height: 40;\n  padding: ").concat(e.unitSize,"px ").concat(2*e.unitSize,"px;\n}*/\n\n.adaptivecard-wrapper {\n  width: 100%;\n  padding-left: ").concat(2*e.unitSize,"px;\n  padding-right: ").concat(2*e.unitSize,"px;\n  box-sizing: border-box;\n}\n\n.adaptivecard-wrapper > * {\n  background-color: white;\n  border-radius: ").concat(e.unitSize,"px;\n  box-shadow: ").concat(e.shadow,";\n}\n")}(e)})),Ue={match:function(e,t){var n,r,i,o,s,a,l,p,u,c,h,d=null===(n=e.data)||void 0===n||null===(r=n._cognigy)||void 0===r||null===(i=r._webchat)||void 0===i?void 0:i.adaptiveCard,f=null===(o=e.data)||void 0===o||null===(s=o._cognigy)||void 0===s||null===(a=s._defaultPreview)||void 0===a?void 0:a.adaptiveCard,y="adaptivecards"===(null===(l=e.data)||void 0===l||null===(p=l._plugin)||void 0===p?void 0:p.type),g=t.settings.enableDefaultPreview;return(null===(u=e.data)||void 0===u||null===(c=u._cognigy)||void 0===c||null===(h=c._defaultPreview)||void 0===h||!h.message||!g)&&!!(f&&g||d&&f&&!g||d||y)},component:function(e){var n=e.theme,i=e.onSendMessage,o=e.message,s=e.config,a=e.setCardOffsetTop;(0,t.useEffect)((function(){He(n)}),[]);var l=function(e){var t,n,r,i,o,a,l,p,u=null===(t=e.data)||void 0===t||null===(n=t._cognigy)||void 0===n||null===(r=n._webchat)||void 0===r?void 0:r.adaptiveCard,c=null===(i=e.data)||void 0===i||null===(o=i._cognigy)||void 0===o||null===(a=o._defaultPreview)||void 0===a?void 0:a.adaptiveCard,h=null===(l=e.data)||void 0===l||null===(p=l._plugin)||void 0===p?void 0:p.payload,d=s.settings.enableDefaultPreview;return u&&c&&!d?u:c&&d?c:h||u}(o),p=(0,t.useCallback)((function(e){var t;switch(null===(t=e._propertyBag)||void 0===t?void 0:t.type){case"Action.Submit":return void i("",{adaptivecards:e._processedData,request:{value:e._processedData}});case"Action.OpenUrl":var n,r=null===(n=e._propertyBag)||void 0===n?void 0:n.url;return void window.open(r,"_blank")}}),[i]),u=(0,t.useMemo)((function(){var e={fontFamily:n.fontFamily};return r().createElement(Ne,{payload:l,onExecuteAction:p,hostConfig:e,setCardOffsetTop:a})}),[l]);return r().createElement("div",{className:"adaptivecard-wrapper internal"},u)},options:{fullwidth:!0}};Fe=Ue,window&&(window.cognigyWebchatMessagePlugins=[].concat(Re(window.cognigyWebchatMessagePlugins||[]),[Fe]),console.log("added cognigy message plugin"))}()}();